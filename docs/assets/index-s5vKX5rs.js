(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function bC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var C0={exports:{}},Fu={},N0={exports:{}},V={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hl=Symbol.for("react.element"),RC=Symbol.for("react.portal"),AC=Symbol.for("react.fragment"),$C=Symbol.for("react.strict_mode"),IC=Symbol.for("react.profiler"),zC=Symbol.for("react.provider"),PC=Symbol.for("react.context"),FC=Symbol.for("react.forward_ref"),LC=Symbol.for("react.suspense"),VC=Symbol.for("react.memo"),BC=Symbol.for("react.lazy"),em=Symbol.iterator;function JC(n){return n===null||typeof n!="object"?null:(n=em&&n[em]||n["@@iterator"],typeof n=="function"?n:null)}var v0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E0=Object.assign,M0={};function uo(n,e,t){this.props=n,this.context=e,this.refs=M0,this.updater=t||v0}uo.prototype.isReactComponent={};uo.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};uo.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function O0(){}O0.prototype=uo.prototype;function uh(n,e,t){this.props=n,this.context=e,this.refs=M0,this.updater=t||v0}var ch=uh.prototype=new O0;ch.constructor=uh;E0(ch,uo.prototype);ch.isPureReactComponent=!0;var tm=Array.isArray,D0=Object.prototype.hasOwnProperty,fh={current:null},T0={key:!0,ref:!0,__self:!0,__source:!0};function b0(n,e,t){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)D0.call(e,r)&&!T0.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:hl,type:n,key:o,ref:s,props:i,_owner:fh.current}}function WC(n,e){return{$$typeof:hl,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function dh(n){return typeof n=="object"&&n!==null&&n.$$typeof===hl}function KC(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var nm=/\/+/g;function ac(n,e){return typeof n=="object"&&n!==null&&n.key!=null?KC(""+n.key):e.toString(36)}function la(n,e,t,r,i){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case hl:case RC:s=!0}}if(s)return s=n,i=i(s),n=r===""?"."+ac(s,0):r,tm(i)?(t="",n!=null&&(t=n.replace(nm,"$&/")+"/"),la(i,e,t,"",function(u){return u})):i!=null&&(dh(i)&&(i=WC(i,t+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(nm,"$&/")+"/")+n)),e.push(i)),1;if(s=0,r=r===""?".":r+":",tm(n))for(var l=0;l<n.length;l++){o=n[l];var a=r+ac(o,l);s+=la(o,e,t,a,i)}else if(a=JC(n),typeof a=="function")for(n=a.call(n),l=0;!(o=n.next()).done;)o=o.value,a=r+ac(o,l++),s+=la(o,e,t,a,i);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Il(n,e,t){if(n==null)return n;var r=[],i=0;return la(n,r,"","",function(o){return e.call(t,o,i++)}),r}function _C(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Pe={current:null},aa={transition:null},HC={ReactCurrentDispatcher:Pe,ReactCurrentBatchConfig:aa,ReactCurrentOwner:fh};V.Children={map:Il,forEach:function(n,e,t){Il(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Il(n,function(){e++}),e},toArray:function(n){return Il(n,function(e){return e})||[]},only:function(n){if(!dh(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};V.Component=uo;V.Fragment=AC;V.Profiler=IC;V.PureComponent=uh;V.StrictMode=$C;V.Suspense=LC;V.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HC;V.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=E0({},n.props),i=n.key,o=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=fh.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(a in e)D0.call(e,a)&&!T0.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:hl,type:n.type,key:i,ref:o,props:r,_owner:s}};V.createContext=function(n){return n={$$typeof:PC,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:zC,_context:n},n.Consumer=n};V.createElement=b0;V.createFactory=function(n){var e=b0.bind(null,n);return e.type=n,e};V.createRef=function(){return{current:null}};V.forwardRef=function(n){return{$$typeof:FC,render:n}};V.isValidElement=dh;V.lazy=function(n){return{$$typeof:BC,_payload:{_status:-1,_result:n},_init:_C}};V.memo=function(n,e){return{$$typeof:VC,type:n,compare:e===void 0?null:e}};V.startTransition=function(n){var e=aa.transition;aa.transition={};try{n()}finally{aa.transition=e}};V.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};V.useCallback=function(n,e){return Pe.current.useCallback(n,e)};V.useContext=function(n){return Pe.current.useContext(n)};V.useDebugValue=function(){};V.useDeferredValue=function(n){return Pe.current.useDeferredValue(n)};V.useEffect=function(n,e){return Pe.current.useEffect(n,e)};V.useId=function(){return Pe.current.useId()};V.useImperativeHandle=function(n,e,t){return Pe.current.useImperativeHandle(n,e,t)};V.useInsertionEffect=function(n,e){return Pe.current.useInsertionEffect(n,e)};V.useLayoutEffect=function(n,e){return Pe.current.useLayoutEffect(n,e)};V.useMemo=function(n,e){return Pe.current.useMemo(n,e)};V.useReducer=function(n,e,t){return Pe.current.useReducer(n,e,t)};V.useRef=function(n){return Pe.current.useRef(n)};V.useState=function(n){return Pe.current.useState(n)};V.useSyncExternalStore=function(n,e,t){return Pe.current.useSyncExternalStore(n,e,t)};V.useTransition=function(){return Pe.current.useTransition()};V.version="18.2.0";N0.exports=V;var C=N0.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UC=C,qC=Symbol.for("react.element"),jC=Symbol.for("react.fragment"),QC=Object.prototype.hasOwnProperty,GC=UC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YC={key:!0,ref:!0,__self:!0,__source:!0};function R0(n,e,t){var r,i={},o=null,s=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)QC.call(e,r)&&!YC.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:qC,type:n,key:o,ref:s,props:i,_owner:GC.current}}Fu.Fragment=jC;Fu.jsx=R0;Fu.jsxs=R0;C0.exports=Fu;var b=C0.exports;function he(n){this.content=n}he.prototype={constructor:he,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new he(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new he(t)},addToStart:function(n,e){return new he([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new he(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new he(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=he.from(n),n.size?new he(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=he.from(n),n.size?new he(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=he.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};he.from=function(n){if(n instanceof he)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new he(e)};function A0(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=A0(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function $0(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),l=e.child(--o),a=s.nodeSize;if(s==l){t-=a,r-=a;continue}if(!s.sameMarkup(l))return{a:t,b:r};if(s.isText&&s.text!=l.text){let u=0,c=Math.min(s.text.length,l.text.length);for(;u<c&&s.text[s.text.length-u-1]==l.text[l.text.length-u-1];)u++,t--,r--;return{a:t,b:r}}if(s.content.size||l.content.size){let u=$0(s.content,l.content,t-1,r-1);if(u)return u}t-=a,r-=a}}class x{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,l=0;l<t;s++){let a=this.content[s],u=l+a.nodeSize;if(u>e&&r(a,i+l,o||null,s)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,t-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(s?s=!1:o+=r),o+=u},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new x(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let l=this.content[o],a=s+l.nodeSize;a>e&&((s<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-s),Math.min(l.text.length,t-s)):l=l.cut(Math.max(0,e-s-1),Math.min(l.content.size,t-s-1))),r.push(l),i+=l.nodeSize),s=a}return new x(r,i)}cutByIndex(e,t){return e==t?x.empty:e==0&&t==this.content.length?this:new x(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new x(i,o)}addToStart(e){return new x([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new x(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return A0(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return $0(this,e,t,r)}findIndex(e,t=-1){if(e==0)return zl(0,e);if(e==this.size)return zl(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||t>0?zl(r+1,s):zl(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return x.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new x(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return x.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new x(t||e,r)}static from(e){if(!e)return x.empty;if(e instanceof x)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new x([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}x.empty=new x([],0);const uc={index:0,offset:0};function zl(n,e){return uc.index=n,uc.offset=e,uc}function Ka(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Ka(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Ka(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class W{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ka(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return W.none;if(e instanceof W)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}}W.none=[];class Kt extends Error{}class w{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=z0(this.content,e+this.openStart,t);return r&&new w(r,this.openStart,this.openEnd)}removeBetween(e,t){return new w(I0(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return w.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new w(x.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new w(e,r,i)}}w.empty=new w(x.empty,0,0);function I0(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:l}=n.findIndex(t);if(i==e||o.isText){if(l!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(I0(o.content,e-i-1,t-i-1)))}function z0(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let l=z0(s.content,e-o-1,t);return l&&n.replaceChild(i,s.copy(l))}function XC(n,e,t){if(t.openStart>n.depth)throw new Kt("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Kt("Inconsistent open depths");return P0(n,e,t,0)}function P0(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=P0(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,l=s.content;return Tr(s,l.cut(0,n.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:s,end:l}=ZC(t,n);return Tr(o,L0(n,s,l,e,r))}else return Tr(o,_a(n,e,r))}function F0(n,e){if(!e.type.compatibleContent(n.type))throw new Kt("Cannot join "+e.type.name+" onto "+n.type.name)}function kf(n,e,t){let r=n.node(t);return F0(r,e.node(t)),r}function Dr(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function us(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(Dr(n.nodeAfter,r),o++));for(let l=o;l<s;l++)Dr(i.child(l),r);e&&e.depth==t&&e.textOffset&&Dr(e.nodeBefore,r)}function Tr(n,e){return n.type.checkContent(e),n.copy(e)}function L0(n,e,t,r,i){let o=n.depth>i&&kf(n,e,i+1),s=r.depth>i&&kf(t,r,i+1),l=[];return us(null,n,i,l),o&&s&&e.index(i)==t.index(i)?(F0(o,s),Dr(Tr(o,L0(n,e,t,r,i+1)),l)):(o&&Dr(Tr(o,_a(n,e,i+1)),l),us(e,t,i,l),s&&Dr(Tr(s,_a(t,r,i+1)),l)),us(r,null,i,l),new x(l)}function _a(n,e,t){let r=[];if(us(null,n,t,r),n.depth>t){let i=kf(n,e,t+1);Dr(Tr(i,_a(n,e,t+1)),r)}return us(e,null,t,r),new x(r)}function ZC(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(x.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class Ts{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return W.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let l=r;r=i,i=l}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new nN(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:l,offset:a}=s.content.findIndex(o),u=o-a;if(r.push(s,l,i+a),!u||(s=s.child(l),s.isText))break;o=u-1,i+=a+1}return new Ts(t,r,o)}static resolveCached(e,t){let r=rm.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==t)return s}else rm.set(e,r=new eN);let i=r.elts[r.i]=Ts.resolve(e,t);return r.i=(r.i+1)%tN,i}}class eN{constructor(){this.elts=[],this.i=0}}const tN=12,rm=new WeakMap;class nN{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const rN=Object.create(null);class Vt{constructor(e,t,r,i=W.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||x.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Ka(this.attrs,t||e.defaultAttrs||rN)&&W.sameSet(this.marks,r||W.none)}copy(e=null){return e==this.content?this:new Vt(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Vt(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return w.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),l=i.start(s),u=i.node(s).content.cut(i.pos-l,o.pos-l);return new w(u,i.depth-s,o.depth-s)}replace(e,t,r){return XC(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return Ts.resolveCached(this,e)}resolveNoCache(e){return Ts.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),V0(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=x.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),l=s&&s.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let a=i;a<o;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=W.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!W.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=x.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}}Vt.prototype.text=void 0;class Ha extends Vt{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):V0(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Ha(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Ha(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function V0(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Lr{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new iN(e,t);if(r.next==null)return Lr.empty;let i=B0(r);r.next&&r.err("Unexpected trailing text");let o=fN(cN(i));return dN(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,l){let a=s.matchFragment(e,r);if(a&&(!t||a.validEnd))return x.from(l.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:f}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let d=o(f,l.concat(c));if(d)return d}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let l=i;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:l,next:a}=o.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}Lr.empty=new Lr(!0);class iN{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function B0(n){let e=[];do e.push(oN(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function oN(n){let e=[];do e.push(sN(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function sN(n){let e=uN(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=lN(n,e);else break;return e}function im(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function lN(n,e){let t=im(n),r=t;return n.eat(",")&&(n.next!="}"?r=im(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function aN(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.groups.indexOf(e)>-1&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function uN(n){if(n.eat("(")){let e=B0(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=aN(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function cN(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,l,a){let u={term:a,to:l};return e[s].push(u),u}function i(s,l){s.forEach(a=>a.to=l)}function o(s,l){if(s.type=="choice")return s.exprs.reduce((a,u)=>a.concat(o(u,l)),[]);if(s.type=="seq")for(let a=0;;a++){let u=o(s.exprs[a],l);if(a==s.exprs.length-1)return u;i(u,l=t())}else if(s.type=="star"){let a=t();return r(l,a),i(o(s.expr,a),a),[r(a)]}else if(s.type=="plus"){let a=t();return i(o(s.expr,l),a),i(o(s.expr,a),a),[r(a)]}else{if(s.type=="opt")return[r(l)].concat(o(s.expr,l));if(s.type=="range"){let a=l;for(let u=0;u<s.min;u++){let c=t();i(o(s.expr,a),c),a=c}if(s.max==-1)i(o(s.expr,a),a);else for(let u=s.min;u<s.max;u++){let c=t();r(a,c),i(o(s.expr,a),c),a=c}return[r(a)]}else{if(s.type=="name")return[r(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function J0(n,e){return e-n}function om(n,e){let t=[];return r(e),t.sort(J0);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:l,to:a}=o[s];!l&&t.indexOf(a)==-1&&r(a)}}}function fN(n){let e=Object.create(null);return t(om(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);om(n,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let o=e[r.join(",")]=new Lr(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let l=i[s][1].sort(J0);o.next.push({type:i[s][0],next:e[l.join(",")]||t(l)})}return o}}function dN(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];s.push(a.name),o&&!(a.isText||a.hasRequiredAttrs())&&(o=!1),r.indexOf(u)==-1&&r.push(u)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function W0(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function K0(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function _0(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function H0(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new pN(n,r,e[r]);return t}let sm=class U0{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=H0(e,r.attrs),this.defaultAttrs=W0(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Lr.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:K0(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Vt(this,this.computeAttrs(e),x.from(t),W.setFrom(r))}createChecked(e=null,t,r){return t=x.from(t),this.checkContent(t),new Vt(this,this.computeAttrs(e),t,W.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=x.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(x.empty,!0);return o?new Vt(this,e,t.append(o),W.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){_0(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:W.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new U0(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function hN(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class pN{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?hN(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class pl{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=H0(e,i.attrs),this.excluded=null;let o=W0(this.attrs);this.instance=o?new W(this,o):null}create(e=null){return!e&&this.instance?this.instance:new W(this,K0(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new pl(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){_0(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class q0{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=he.from(e.nodes),t.marks=he.from(e.marks||{}),this.nodes=sm.compile(this.spec.nodes,this),this.marks=pl.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",l=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=Lr.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=l=="_"?null:l?lm(this,l.split(" ")):l==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:lm(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof sm){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new Ha(r,r.defaultAttrs,e,W.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Vt.fromJSON(this,e)}markFromJSON(e){return W.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function lm(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let l in n.marks){let a=n.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function mN(n){return n.tag!=null}function gN(n){return n.style!=null}class Vr{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(mN(i))this.tags.push(i);else if(gN(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new um(this,t,!1);return r.addAll(e,W.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new um(this,t,!0);return r.addAll(e,W.none,t.from,t.to),w.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(kN(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],l=s.style;if(!(l.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(s.getAttrs){let a=s.getAttrs(t);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let l=t[s];if((l.priority==null?50:l.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=cm(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=cm(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Vr(e,Vr.schemaRules(e)))}}const j0={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},yN={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Q0={ol:!0,ul:!0},Ua=1,qa=2,cs=4;function am(n,e,t){return e!=null?(e?Ua:0)|(e==="full"?qa:0):n&&n.whitespace=="pre"?Ua|qa:t&~cs}class Pl{constructor(e,t,r,i,o,s){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=W.none,this.match=o||(s&cs?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(x.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ua)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=x.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(x.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!j0.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class um{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,o,s=am(null,t.preserveWhitespace,0)|(r?cs:0);i?o=new Pl(i.type,i.attrs,W.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new Pl(null,null,W.none,!0,null,s):o=new Pl(e.schema.topNodeType,null,W.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top;if(i.options&qa||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i.options&Ua)i.options&qa?r=r.replace(/\r\n?/g,`
`):r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],s=e.previousSibling;(!o||s&&s.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=e.nodeName.toLowerCase(),o;Q0.hasOwnProperty(i)&&this.parser.normalizeLists&&SN(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,r));if(s?s.ignore:yN.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e,t);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let l,a=this.top,u=this.needsBlock;if(j0.hasOwnProperty(i))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),l=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);return}let c=s&&s.skip?t:this.readStyles(e,t);c&&this.addAll(e,c),l&&this.sync(a),this.needsBlock=u}else{let l=this.readStyles(e,t);l&&this.addElementByRule(e,s,l,s.consuming===!1?o:void 0)}}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let l=void 0;;){let a=this.parser.matchStyle(o,s,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?t=t.filter(u=>!a.clearMark(u)):t=t.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return t}addElementByRule(e,t,r,i){let o,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r)||this.leafFallback(e,r);else{let a=this.enter(s,t.attrs||null,r,t.preserveWhitespace);a&&(o=!0,r=a)}else{let a=this.parser.schema.marks[t.mark];r=r.concat(a.create(t.attrs))}let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a,r)}o&&this.sync(l)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];s!=l;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,t);this.findAtPoint(e,o)}findPlace(e,t){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],l=s.findWrapping(e);if(l&&(!r||r.length>l.length)&&(r=l,i=s,!l.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)t=this.enterInner(r[o],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let r=this.findPlace(e,t);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=W.none;for(let s of r.concat(e.marks))(i.type?i.type.allowsMarkType(s.type):fm(s.type,e.type))&&(o=s.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let l=am(e,o,s.options);s.options&cs&&s.content.length==0&&(l|=cs);let a=W.none;return r=r.filter(u=>(s.type?s.type.allowsMarkType(u.type):fm(u.type,e))?(a=u.addToSet(a),!1):!0),this.nodes.push(new Pl(e,t,a,i,null,l)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(l,a)=>{for(;l>=0;l--){let u=t[l];if(u==""){if(l==t.length-1||l==0)continue;for(;a>=o;a--)if(s(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=o?r.node(a-o).type:null;if(!c||c.name!=u&&c.groups.indexOf(u)==-1)return!1;a--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function SN(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Q0.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function kN(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function cm(n){let e={};for(let t in n)e[t]=n[t];return e}function fm(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=l=>{o.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||o.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class Yt{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=cc(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let l=0,a=0;for(;l<o.length&&a<s.marks.length;){let u=s.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(o[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<o.length;)i=o.pop()[1];for(;a<s.marks.length;){let u=s.marks[a++],c=this.serializeMark(u,s.isInline,t);c&&(o.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=ua(cc(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&ua(cc(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return ua(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Yt(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=dm(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return dm(e.marks)}}function dm(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function cc(n){return n.document||window.document}const hm=new WeakMap;function wN(n){let e=hm.get(n);return e===void 0&&hm.set(n,e=xN(n)),e}function xN(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function ua(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=wN(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(t=i.slice(0,s),i=i.slice(s+1));let l,a=t?n.createElementNS(t,i):n.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let f in u)if(u[f]!=null){let d=f.indexOf(" ");d>0?a.setAttributeNS(f.slice(0,d),f.slice(d+1),u[f]):a.setAttribute(f,u[f])}}for(let f=c;f<e.length;f++){let d=e[f];if(d===0){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:h,contentDOM:p}=ua(n,d,t,r);if(a.appendChild(h),p){if(l)throw new RangeError("Multiple content holes");l=p}}}return{dom:a,contentDOM:l}}const G0=65535,Y0=Math.pow(2,16);function CN(n,e){return n+e*Y0}function pm(n){return n&G0}function NN(n){return(n-(n&G0))/Y0}const X0=1,Z0=2,ca=4,e1=8;let mm=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&e1)>0}get deletedBefore(){return(this.delInfo&(X0|ca))>0}get deletedAfter(){return(this.delInfo&(Z0|ca))>0}get deletedAcross(){return(this.delInfo&ca)>0}},_i=class ai{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&ai.empty)return ai.empty}recover(e){let t=0,r=pm(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+NN(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:c);if(r)return h;let p=e==(t<0?a:f)?null:CN(l/3,e-a),m=e==a?Z0:e==f?X0:ca;return(t<0?e!=a:e!=f)&&(m|=e1),new mm(h,m,p)}i+=c-u}return r?e+i:new mm(e+i,0,null)}touches(e,t){let r=0,i=pm(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new ai(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?ai.empty:new ai(e<0?[0,-e,0]:[0,0,e])}};_i.empty=new _i([]);const fc=Object.create(null);let Ge=class{getMap(){return _i.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=fc[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in fc)throw new RangeError("Duplicate use of step JSON ID "+e);return fc[e]=t,t.prototype.jsonID=e,t}},Ve=class Eo{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Eo(e,null)}static fail(e){return new Eo(null,e)}static fromReplace(e,t,r,i){try{return Eo.ok(e.replace(t,r,i))}catch(o){if(o instanceof Kt)return Eo.fail(o.message);throw o}}};function hh(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(hh(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}let t1=class Mo extends Ge{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(hh(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Ve.fromReplace(e,this.from,this.to,o)}invert(){return new n1(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Mo(t.pos,r.pos,this.mark)}merge(e){return e instanceof Mo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Mo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Mo(t.from,t.to,e.markFromJSON(t.mark))}};Ge.jsonID("addMark",t1);let n1=class Oo extends Ge{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(hh(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Ve.fromReplace(e,this.from,this.to,r)}invert(){return new t1(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Oo(t.pos,r.pos,this.mark)}merge(e){return e instanceof Oo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Oo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Oo(t.from,t.to,e.markFromJSON(t.mark))}};Ge.jsonID("removeMark",n1);let r1=class Do extends Ge{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ve.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Ve.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Do(this.pos,t.marks[i]);return new Do(this.pos,this.mark)}}return new i1(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Do(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Do(t.pos,e.markFromJSON(t.mark))}};Ge.jsonID("addNodeMark",r1);let i1=class wf extends Ge{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ve.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Ve.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new r1(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new wf(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new wf(t.pos,e.markFromJSON(t.mark))}};Ge.jsonID("removeNodeMark",i1);let ph=class fr extends Ge{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&xf(e,this.from,this.to)?Ve.fail("Structure replace would overwrite content"):Ve.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new _i([this.from,this.to-this.from,this.slice.size])}invert(e){return new fr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new fr(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof fr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new fr(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new fr(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new fr(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};Ge.jsonID("replace",ph);let ja=class fa extends Ge{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(xf(e,this.from,this.gapFrom)||xf(e,this.gapTo,this.to)))return Ve.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Ve.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Ve.fromReplace(e,this.from,this.to,r):Ve.fail("Content does not fit in gap")}getMap(){return new _i([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new fa(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new fa(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new fa(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};Ge.jsonID("replaceAround",ja);function xf(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function vN(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function mh(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!vN(i,o,s))break}return null}function da(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=t-2;u>o;u--,c--){let f=i.node(u),d=i.index(u);if(f.type.spec.isolating)return!1;let h=f.content.cutByIndex(d,f.childCount),p=r&&r[c]||f;if(p!=f&&(h=h.replaceChild(0,p.type.create(p.attrs))),!f.canReplace(d+1,f.childCount)||!p.type.validContent(h))return!1}let l=i.indexAfter(o),a=r&&r[0];return i.node(o).canReplaceWith(l,l,a?a.type:i.node(o+1).type)}function o1(n,e){let t=n.resolve(e),r=t.index();return EN(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function EN(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function s1(n,e,t=e,r=w.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return MN(i,o,r)?new ph(e,t,r):new ON(i,o,r).fit()}function MN(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let ON=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=x.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=x.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new w(o,s,l);return e>-1?new ja(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new ph(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=dc(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(x.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=dc(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=dc(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new w(To(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new w(To(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let h=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),S=f.matchType(m.type);if(!S)break;u++,(u>1||a==0||m.content.size)&&(f=S,c.push(l1(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?h:-1)))}let p=u==l.childCount;p||(h=-1),this.placed=bo(this.placed,t,x.from(c)),this.frontier[t].match=f,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,S=l;m<h;m++){let g=S.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),S=g.content}this.unplaced=p?e==0?w.empty:new w(To(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new w(To(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!hc(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=hc(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=hc(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=bo(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=bo(this.placed,this.depth,x.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(x.empty,!0);t.childCount&&(this.placed=bo(this.placed,this.frontier.length,t))}};function To(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(To(n.firstChild.content,e-1,t)))}function bo(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(bo(n.lastChild.content,e-1,t)))}function dc(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function l1(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,l1(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(x.empty,!0)))),n.copy(r)}function hc(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!DN(t,o.content,s)?l:null}function DN(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}let TN=class ha extends Ge{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ve.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Ve.fromReplace(e,this.pos,this.pos+1,new w(x.from(i),0,t.isLeaf?0:1))}getMap(){return _i.empty}invert(e){return new ha(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ha(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ha(t.pos,t.attr,t.value)}};Ge.jsonID("attr",TN);let bs=class extends Error{};bs=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};bs.prototype=Object.create(Error.prototype);bs.prototype.constructor=bs;bs.prototype.name="TransformError";const a1=65535,u1=Math.pow(2,16);function bN(n,e){return n+e*u1}function gm(n){return n&a1}function RN(n){return(n-(n&a1))/u1}const c1=1,f1=2,pa=4,d1=8;let Cf=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&d1)>0}get deletedBefore(){return(this.delInfo&(c1|pa))>0}get deletedAfter(){return(this.delInfo&(f1|pa))>0}get deletedAcross(){return(this.delInfo&pa)>0}},Hi=class ui{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&ui.empty)return ui.empty}recover(e){let t=0,r=gm(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+RN(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:c);if(r)return h;let p=e==(t<0?a:f)?null:bN(l/3,e-a),m=e==a?f1:e==f?c1:pa;return(t<0?e!=a:e!=f)&&(m|=d1),new Cf(h,m,p)}i+=c-u}return r?e+i:new Cf(e+i,0,null)}touches(e,t){let r=0,i=gm(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new ui(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?ui.empty:new ui(e<0?[0,-e,0]:[0,0,e])}};Hi.empty=new Hi([]);let AN=class ma{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new ma(this.maps,this.mirror,e,t)}copy(){return new ma(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new ma;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],l=s.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new Cf(e,i,null)}};const pc=Object.create(null);let Ye=class{getMap(){return Hi.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=pc[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in pc)throw new RangeError("Duplicate use of step JSON ID "+e);return pc[e]=t,t.prototype.jsonID=e,t}},Be=class Ro{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ro(e,null)}static fail(e){return new Ro(null,e)}static fromReplace(e,t,r,i){try{return Ro.ok(e.replace(t,r,i))}catch(o){if(o instanceof Kt)return Ro.fail(o.message);throw o}}};function gh(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(gh(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}let yh=class Ao extends Ye{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(gh(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Be.fromReplace(e,this.from,this.to,o)}invert(){return new ml(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ao(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ao&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ao(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ao(t.from,t.to,e.markFromJSON(t.mark))}};Ye.jsonID("addMark",yh);let ml=class $o extends Ye{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(gh(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Be.fromReplace(e,this.from,this.to,r)}invert(){return new yh(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new $o(t.pos,r.pos,this.mark)}merge(e){return e instanceof $o&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $o(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new $o(t.from,t.to,e.markFromJSON(t.mark))}};Ye.jsonID("removeMark",ml);let Sh=class Io extends Ye{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Be.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Io(this.pos,t.marks[i]);return new Io(this.pos,this.mark)}}return new kh(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Io(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Io(t.pos,e.markFromJSON(t.mark))}};Ye.jsonID("addNodeMark",Sh);let kh=class Nf extends Ye{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Be.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Sh(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Nf(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Nf(t.pos,e.markFromJSON(t.mark))}};Ye.jsonID("removeNodeMark",kh);let Yn=class dr extends Ye{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&vf(e,this.from,this.to)?Be.fail("Structure replace would overwrite content"):Be.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Hi([this.from,this.to-this.from,this.slice.size])}invert(e){return new dr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new dr(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof dr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new dr(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new dr(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new dr(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};Ye.jsonID("replace",Yn);let qr=class ga extends Ye{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(vf(e,this.from,this.gapFrom)||vf(e,this.gapTo,this.to)))return Be.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Be.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Be.fromReplace(e,this.from,this.to,r):Be.fail("Content does not fit in gap")}getMap(){return new Hi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ga(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new ga(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ga(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};Ye.jsonID("replaceAround",qr);function vf(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function $N(n,e,t,r){let i=[],o=[],s,l;n.doc.nodesBetween(e,t,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(u,e),h=Math.min(u+a.nodeSize,t),p=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(p)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=h:i.push(s=new ml(d,h,f[m])));l&&l.to==d?l.to=h:o.push(l=new yh(d,h,r))}}),i.forEach(a=>n.step(a)),o.forEach(a=>n.step(a))}function IN(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof pl){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,t);for(let c=0;c<a.length;c++){let f=a[c],d;for(let h=0;h<i.length;h++){let p=i[h];p.step==o-1&&f.eq(i[h].style)&&(d=p)}d?(d.to=u,d.step=o):i.push({style:f,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>n.step(new ml(s.from,s.to,s.style)))}function zN(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),o=[],s=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),u=s+a.nodeSize,c=r.matchType(a.type);if(!c)o.push(new Yn(s,u,w.empty));else{r=c;for(let f=0;f<a.marks.length;f++)t.allowsMarkType(a.marks[f].type)||n.step(new ml(s,u,a.marks[f]))}s=u}if(!r.validEnd){let l=r.fillBefore(x.empty,!0);n.replace(s,s,new w(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function PN(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=x.empty,f=0;for(let p=o,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,c=x.from(r.node(p).copy(c)),f++):a--;let d=x.empty,h=0;for(let p=o,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,d=x.from(i.node(p).copy(d)),h++):u++;n.step(new qr(a,u,s,l,new w(c.append(d),f,h),c.size-f,!0))}function FN(n,e,t){let r=x.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let l=t[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=x.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new qr(i,o,i,o,new w(r,0,0),t.length,!0))}function LN(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,l)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&VN(n.doc,n.mapping.slice(o).map(l),r)){n.clearIncompatible(n.mapping.slice(o).map(l,1),r);let a=n.mapping.slice(o),u=a.map(l,1),c=a.map(l+s.nodeSize,1);return n.step(new qr(u,c,u+1,c-1,new w(x.from(r.create(i,null,s.marks)),0,0),1,!0)),!1}})}function VN(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function BN(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new qr(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new w(x.from(s),0,0),1,!0))}function JN(n,e,t=1,r){let i=n.doc.resolve(e),o=x.empty,s=x.empty;for(let l=i.depth,a=i.depth-t,u=t-1;l>a;l--,u--){o=x.from(i.node(l).copy(o));let c=r&&r[u];s=x.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}n.step(new Yn(e,e,new w(o.append(s),t,t),!0))}function WN(n,e,t){let r=new Yn(e-t,e+t,w.empty,!0);n.step(r)}function KN(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function _N(n,e,t=e,r=w.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return h1(i,o,r)?new Yn(e,t,r):new HN(i,o,r).fit()}function h1(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let HN=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=x.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=x.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new w(o,s,l);return e>-1?new qr(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new Yn(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=mc(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(x.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=mc(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=mc(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new w(zo(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new w(zo(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let h=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),S=f.matchType(m.type);if(!S)break;u++,(u>1||a==0||m.content.size)&&(f=S,c.push(p1(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?h:-1)))}let p=u==l.childCount;p||(h=-1),this.placed=Po(this.placed,t,x.from(c)),this.frontier[t].match=f,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,S=l;m<h;m++){let g=S.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),S=g.content}this.unplaced=p?e==0?w.empty:new w(zo(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new w(zo(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!gc(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=gc(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=gc(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Po(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Po(this.placed,this.depth,x.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(x.empty,!0);t.childCount&&(this.placed=Po(this.placed,this.frontier.length,t))}};function zo(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(zo(n.firstChild.content,e-1,t)))}function Po(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Po(n.lastChild.content,e-1,t)))}function mc(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function p1(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,p1(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(x.empty,!0)))),n.copy(r)}function gc(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!UN(t,o.content,s)?l:null}function UN(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function qN(n){return n.spec.defining||n.spec.definingForContent}function jN(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(h1(i,o,r))return n.step(new Yn(e,t,r));let s=g1(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let d=i.depth,h=i.pos-1;d>0;d--,h--){let p=i.node(d).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;s.indexOf(d)>-1?l=d:i.before(d)==h&&s.splice(1,0,-d)}let a=s.indexOf(l),u=[],c=r.openStart;for(let d=r.content,h=0;;h++){let p=d.firstChild;if(u.push(p),h==r.openStart)break;d=p.content}for(let d=c-1;d>=0;d--){let h=u[d].type,p=qN(h);if(p&&i.node(a).type!=h)c=d;else if(p||!h.isTextblock)break}for(let d=r.openStart;d>=0;d--){let h=(d+c+1)%(r.openStart+1),p=u[h];if(p)for(let m=0;m<s.length;m++){let S=s[(m+a)%s.length],g=!0;S<0&&(g=!1,S=-S);let y=i.node(S-1),k=i.index(S-1);if(y.canReplaceWith(k,k,p.type,p.marks))return n.replace(i.before(S),g?o.after(S):t,new w(m1(r.content,0,r.openStart,h),h,r.openEnd))}}let f=n.steps.length;for(let d=s.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let h=s[d];h<0||(e=i.before(h),t=o.after(h))}}function m1(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(m1(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(x.empty,!0))}return n}function QN(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=KN(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new w(x.from(r),0,0))}function GN(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=g1(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function g1(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}let y1=class ya extends Ye{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Be.fromReplace(e,this.pos,this.pos+1,new w(x.from(i),0,t.isLeaf?0:1))}getMap(){return Hi.empty}invert(e){return new ya(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ya(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ya(t.pos,t.attr,t.value)}};Ye.jsonID("attr",y1);let Ui=class extends Error{};Ui=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Ui.prototype=Object.create(Error.prototype);Ui.prototype.constructor=Ui;Ui.prototype.name="TransformError";let YN=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new AN}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Ui(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=w.empty){let i=_N(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new w(x.from(r),0,0))}delete(e,t){return this.replace(e,t,w.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return jN(this,e,t,r),this}replaceRangeWith(e,t,r){return QN(this,e,t,r),this}deleteRange(e,t){return GN(this,e,t),this}lift(e,t){return PN(this,e,t),this}join(e,t=1){return WN(this,e,t),this}wrap(e,t){return FN(this,e,t),this}setBlockType(e,t=e,r,i=null){return LN(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return BN(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new y1(e,t,r)),this}addNodeMark(e,t){return this.step(new Sh(e,t)),this}removeNodeMark(e,t){if(!(t instanceof W)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new kh(e,t)),this}split(e,t=1,r){return JN(this,e,t,r),this}addMark(e,t,r){return $N(this,e,t,r),this}removeMark(e,t,r){return IN(this,e,t,r),this}clearIncompatible(e,t,r){return zN(this,e,t,r),this}};const yc=Object.create(null);class z{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new S1(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=w.empty){let r=t.content.lastChild,i=null;for(let l=0;l<t.openEnd;l++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:u}=s[l],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(u.pos),l?w.empty:t),l==0&&km(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:l}=i[o],a=e.mapping.slice(r),u=a.map(s.pos),c=a.map(l.pos);o?e.deleteRange(u,c):(e.replaceRangeWith(u,c,t),km(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new $(e):ci(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?ci(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):ci(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Re(e.node(0))}static atStart(e){return ci(e,e,0,0,1)||new Re(e)}static atEnd(e){return ci(e,e,e.content.size,e.childCount,-1)||new Re(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=yc[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in yc)throw new RangeError("Duplicate use of selection JSON ID "+e);return yc[e]=t,t.prototype.jsonID=e,t}getBookmark(){return $.between(this.$anchor,this.$head).getBookmark()}}z.prototype.visible=!0;class S1{constructor(e,t){this.$from=e,this.$to=t}}let ym=!1;function Sm(n){!ym&&!n.parent.inlineContent&&(ym=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class $ extends z{constructor(e,t=e){Sm(e),Sm(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return z.near(r);let i=e.resolve(t.map(this.anchor));return new $(i.parent.inlineContent?i:r,r)}replace(e,t=w.empty){if(super.replace(e,t),t==w.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof $&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Lu(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new $(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=z.findFrom(t,r,!0)||z.findFrom(t,-r,!0);if(o)t=o.$head;else return z.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(z.findFrom(e,-r,!0)||z.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new $(e,t)}}z.jsonID("text",$);class Lu{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Lu(e.map(this.anchor),e.map(this.head))}resolve(e){return $.between(e.resolve(this.anchor),e.resolve(this.head))}}class O extends z{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?z.near(o):new O(o)}content(){return new w(x.from(this.node),0,0)}eq(e){return e instanceof O&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new wh(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new O(e.resolve(t.anchor))}static create(e,t){return new O(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}O.prototype.visible=!1;z.jsonID("node",O);class wh{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Lu(r,r):new wh(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&O.isSelectable(r)?new O(t):z.near(t)}}class Re extends z{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=w.empty){if(t==w.empty){e.delete(0,e.doc.content.size);let r=z.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Re(e)}map(e){return new Re(e)}eq(e){return e instanceof Re}getBookmark(){return XN}}z.jsonID("all",Re);const XN={map(){return this},resolve(n){return new Re(n)}};function ci(n,e,t,r,i,o=!1){if(e.inlineContent)return $.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let l=e.child(s);if(l.isAtom){if(!o&&O.isSelectable(l))return O.create(n,t-(i<0?l.nodeSize:0))}else{let a=ci(n,l,t+i,i<0?l.childCount:0,i,o);if(a)return a}t+=l.nodeSize*i}return null}function km(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof Yn||i instanceof qr))return;let o=n.mapping.maps[r],s;o.forEach((l,a,u,c)=>{s==null&&(s=c)}),n.setSelection(z.near(n.doc.resolve(s),t))}const wm=1,Fl=2,xm=4;class ZN extends YN{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|wm)&~Fl,this.storedMarks=null,this}get selectionSet(){return(this.updated&wm)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Fl,this}ensureMarks(e){return W.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Fl)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Fl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||W.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),this.selection.empty||this.setSelection(z.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=xm,this}get scrolledIntoView(){return(this.updated&xm)>0}}function Cm(n,e){return!e||!n?n:n.bind(e)}class Fo{constructor(e,t,r){this.name=e,this.init=Cm(t.init,r),this.apply=Cm(t.apply,r)}}const ev=[new Fo("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Fo("selection",{init(n,e){return n.selection||z.atStart(e.doc)},apply(n){return n.selection}}),new Fo("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Fo("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Sc{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ev.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Fo(r.key,r.spec.state,r))})}}class An{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let a=i?i[s].n:0,u=i?i[s].state:this,c=a<t.length&&l.spec.appendTransaction.call(l,a?t.slice(a):t,u,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:r,n:t.length}:{state:this,n:0})}t.push(c),r=r.applyInner(c),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new An(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new ZN(this)}static create(e){let t=new Sc(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new An(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new Sc(this.schema,e.plugins),r=t.fields,i=new An(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Sc(e.schema,e.plugins),o=new An(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Vt.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=z.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){o[s.name]=u.fromJSON.call(a,e,t[l],o);return}}o[s.name]=s.init(e,o)}}),o}}function k1(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=k1(i,e,{})),t[r]=i}return t}class Xt{constructor(e){this.spec=e,this.props={},e.props&&k1(e.props,this,this.props),this.key=e.key?e.key.key:w1("plugin")}getState(e){return e[this.key]}}const kc=Object.create(null);function w1(n){return n in kc?n+"$"+ ++kc[n]:(kc[n]=0,n+"$")}class gl{constructor(e="key"){this.key=w1(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const x1=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function tv(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const nv=(n,e,t)=>{let r=tv(n,t);if(!r)return!1;let i=C1(r);if(!i){let s=r.blockRange(),l=s&&mh(s);return l==null?!1:(e&&e(n.tr.lift(s,l).scrollIntoView()),!0)}let o=i.nodeBefore;if(!o.type.spec.isolating&&v1(n,i,e))return!0;if(r.parent.content.size==0&&(qi(o,"end")||O.isSelectable(o))){let s=s1(n.doc,r.before(),r.after(),w.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=n.tr.step(s);l.setSelection(qi(o,"end")?z.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):O.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1};function qi(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const rv=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=C1(r)}let s=o&&o.nodeBefore;return!s||!O.isSelectable(s)?!1:(e&&e(n.tr.setSelection(O.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function C1(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function iv(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const ov=(n,e,t)=>{let r=iv(n,t);if(!r)return!1;let i=N1(r);if(!i)return!1;let o=i.nodeAfter;if(v1(n,i,e))return!0;if(r.parent.content.size==0&&(qi(o,"start")||O.isSelectable(o))){let s=s1(n.doc,r.before(),r.after(),w.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=n.tr.step(s);l.setSelection(qi(o,"start")?z.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):O.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},sv=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=N1(r)}let s=o&&o.nodeAfter;return!s||!O.isSelectable(s)?!1:(e&&e(n.tr.setSelection(O.create(n.doc,o.pos)).scrollIntoView()),!0)};function N1(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const lv=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function xh(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const av=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=xh(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let l=t.after(),a=n.tr.replaceWith(l,l,s.createAndFill());a.setSelection(z.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},uv=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof Re||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=xh(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=n.tr.insert(s,o.createAndFill());l.setSelection($.create(l.doc,s+1)),e(l.scrollIntoView())}return!0},cv=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(da(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&mh(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function fv(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof O&&e.selection.node.isBlock)return!r.parentOffset||!da(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){let o=i.parentOffset==i.parent.content.size,s=e.tr;(e.selection instanceof $||e.selection instanceof Re)&&s.deleteSelection();let l=r.depth==0?null:xh(r.node(-1).contentMatchAt(r.indexAfter(-1))),a=o&&l?[{type:l}]:void 0,u=da(s.doc,s.mapping.map(r.pos),1,a);if(!a&&!u&&da(s.doc,s.mapping.map(r.pos),1,l?[{type:l}]:void 0)&&(l&&(a=[{type:l}]),u=!0),u&&(s.split(s.mapping.map(r.pos),1,a),!o&&!r.parentOffset&&r.parent.type!=l)){let c=s.mapping.map(r.before()),f=s.doc.resolve(c);l&&r.node(-1).canReplaceWith(f.index(),f.index()+1,l)&&s.setNodeMarkup(s.mapping.map(r.before()),l)}t(s.scrollIntoView())}return!0}}const dv=fv(),hv=(n,e)=>(e&&e(n.tr.setSelection(new Re(n.doc))),!0);function pv(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||o1(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function v1(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o,s;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(pv(n,e,t))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(o=(s=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&s.matchType(o[0]||i.type).validEnd){if(t){let f=e.pos+i.nodeSize,d=x.empty;for(let m=o.length-1;m>=0;m--)d=x.from(o[m].create(null,d));d=x.from(r.copy(d));let h=n.tr.step(new ja(e.pos-1,f,e.pos,f,new w(d,1,0),o.length,!0)),p=f+2*o.length;o1(h.doc,p)&&h.join(p),t(h.scrollIntoView())}return!0}let a=z.findFrom(e,1),u=a&&a.$from.blockRange(a.$to),c=u&&mh(u);if(c!=null&&c>=e.depth)return t&&t(n.tr.lift(u,c).scrollIntoView()),!0;if(l&&qi(i,"start",!0)&&qi(r,"end")){let f=r,d=[];for(;d.push(f),!f.isTextblock;)f=f.lastChild;let h=i,p=1;for(;!h.isTextblock;h=h.firstChild)p++;if(f.canReplace(f.childCount,f.childCount,h.content)){if(t){let m=x.empty;for(let g=d.length-1;g>=0;g--)m=x.from(d[g].copy(m));let S=n.tr.step(new ja(e.pos-d.length,e.pos+i.nodeSize,e.pos+p,e.pos+i.nodeSize-p,new w(m,d.length,0),0,!0));t(S.scrollIntoView())}return!0}}return!1}function E1(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection($.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const mv=E1(-1),gv=E1(1);function yv(n,e,t){for(let r=0;r<e.length;r++){let{$from:i,$to:o}=e[r],s=i.depth==0?n.inlineContent&&n.type.allowsMarkType(t):!1;if(n.nodesBetween(i.pos,o.pos,l=>{if(s)return!1;s=l.inlineContent&&l.type.allowsMarkType(t)}),s)return!0}return!1}function Nm(n,e=null){return function(t,r){let{empty:i,$cursor:o,ranges:s}=t.selection;if(i&&!o||!yv(t.doc,s,n))return!1;if(r)if(o)n.isInSet(t.storedMarks||o.marks())?r(t.tr.removeStoredMark(n)):r(t.tr.addStoredMark(n.create(e)));else{let l=!1,a=t.tr;for(let u=0;!l&&u<s.length;u++){let{$from:c,$to:f}=s[u];l=t.doc.rangeHasMark(c.pos,f.pos,n)}for(let u=0;u<s.length;u++){let{$from:c,$to:f}=s[u];if(l)a.removeMark(c.pos,f.pos,n);else{let d=c.pos,h=f.pos,p=c.nodeAfter,m=f.nodeBefore,S=p&&p.isText?/^\s*/.exec(p.text)[0].length:0,g=m&&m.isText?/\s*$/.exec(m.text)[0].length:0;d+S<h&&(d+=S,h-=g),a.addMark(d,h,n.create(e))}}r(a.scrollIntoView())}return!0}}function Ch(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}let wc=Ch(x1,nv,rv),vm=Ch(x1,ov,sv);const on={Enter:Ch(lv,uv,cv,dv),"Mod-Enter":av,Backspace:wc,"Mod-Backspace":wc,"Shift-Backspace":wc,Delete:vm,"Mod-Delete":vm,"Mod-a":hv},M1={"Ctrl-h":on.Backspace,"Alt-Backspace":on["Mod-Backspace"],"Ctrl-d":on.Delete,"Ctrl-Alt-Backspace":on["Mod-Delete"],"Alt-Delete":on["Mod-Delete"],"Alt-d":on["Mod-Delete"],"Ctrl-a":mv,"Ctrl-e":gv};for(let n in on)M1[n]=on[n];const Sv=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,kv=Sv?M1:on;var _t={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Qa={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Em=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),wv=typeof navigator<"u"&&/Mac/.test(navigator.platform),xv=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Cv=wv||Em&&+Em[1]<57;for(var me=0;me<10;me++)_t[48+me]=_t[96+me]=String(me);for(var me=1;me<=24;me++)_t[me+111]="F"+me;for(var me=65;me<=90;me++)_t[me]=String.fromCharCode(me+32),Qa[me]=String.fromCharCode(me);for(var xc in _t)Qa.hasOwnProperty(xc)||(Qa[xc]=_t[xc]);function Nh(n){var e=Cv&&(n.ctrlKey||n.altKey||n.metaKey)||xv&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Qa:_t)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Nv=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function vv(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))Nv?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function Ev(n){let e=Object.create(null);for(let t in n)e[vv(t)]=n[t];return e}function Cc(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function Mv(n){let e=Ev(n);return function(t,r){let i=Nh(r),o,s=e[Cc(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Cc(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=_t[r.keyCode])&&o!=i){let l=e[Cc(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const O1=65535,D1=Math.pow(2,16);function Ov(n,e){return n+e*D1}function Mm(n){return n&O1}function Dv(n){return(n-(n&O1))/D1}const T1=1,b1=2,Sa=4,R1=8;let Om=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&R1)>0}get deletedBefore(){return(this.delInfo&(T1|Sa))>0}get deletedAfter(){return(this.delInfo&(b1|Sa))>0}get deletedAcross(){return(this.delInfo&Sa)>0}},ji=class fi{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&fi.empty)return fi.empty}recover(e){let t=0,r=Mm(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Dv(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:c);if(r)return h;let p=e==(t<0?a:f)?null:Ov(l/3,e-a),m=e==a?b1:e==f?T1:Sa;return(t<0?e!=a:e!=f)&&(m|=R1),new Om(h,m,p)}i+=c-u}return r?e+i:new Om(e+i,0,null)}touches(e,t){let r=0,i=Mm(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new fi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?fi.empty:new fi(e<0?[0,-e,0]:[0,0,e])}};ji.empty=new ji([]);const Nc=Object.create(null);let Xe=class{getMap(){return ji.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Nc[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Nc)throw new RangeError("Duplicate use of step JSON ID "+e);return Nc[e]=t,t.prototype.jsonID=e,t}},Je=class Lo{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Lo(e,null)}static fail(e){return new Lo(null,e)}static fromReplace(e,t,r,i){try{return Lo.ok(e.replace(t,r,i))}catch(o){if(o instanceof Kt)return Lo.fail(o.message);throw o}}};function vh(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(vh(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}let A1=class Vo extends Xe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(vh(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Je.fromReplace(e,this.from,this.to,o)}invert(){return new $1(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Vo(t.pos,r.pos,this.mark)}merge(e){return e instanceof Vo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Vo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Vo(t.from,t.to,e.markFromJSON(t.mark))}};Xe.jsonID("addMark",A1);let $1=class Bo extends Xe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(vh(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Je.fromReplace(e,this.from,this.to,r)}invert(){return new A1(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Bo(t.pos,r.pos,this.mark)}merge(e){return e instanceof Bo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Bo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Bo(t.from,t.to,e.markFromJSON(t.mark))}};Xe.jsonID("removeMark",$1);let I1=class Jo extends Xe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Je.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Je.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Jo(this.pos,t.marks[i]);return new Jo(this.pos,this.mark)}}return new z1(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Jo(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Jo(t.pos,e.markFromJSON(t.mark))}};Xe.jsonID("addNodeMark",I1);let z1=class Ef extends Xe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Je.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Je.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new I1(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ef(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ef(t.pos,e.markFromJSON(t.mark))}};Xe.jsonID("removeNodeMark",z1);let Tv=class hr extends Xe{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Mf(e,this.from,this.to)?Je.fail("Structure replace would overwrite content"):Je.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new ji([this.from,this.to-this.from,this.slice.size])}invert(e){return new hr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new hr(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof hr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new hr(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new hr(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new hr(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};Xe.jsonID("replace",Tv);let bv=class ka extends Xe{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Mf(e,this.from,this.gapFrom)||Mf(e,this.gapTo,this.to)))return Je.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Je.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Je.fromReplace(e,this.from,this.to,r):Je.fail("Content does not fit in gap")}getMap(){return new ji([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ka(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new ka(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ka(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};Xe.jsonID("replaceAround",bv);function Mf(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function Rv(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(a,a,i);else{let f=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(a,a,f[0])}if(c)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}let Av=class wa extends Xe{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Je.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Je.fromReplace(e,this.pos,this.pos+1,new w(x.from(i),0,t.isLeaf?0:1))}getMap(){return ji.empty}invert(e){return new wa(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new wa(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new wa(t.pos,t.attr,t.value)}};Xe.jsonID("attr",Av);let Rs=class extends Error{};Rs=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Rs.prototype=Object.create(Error.prototype);Rs.prototype.constructor=Rs;Rs.prototype.name="TransformError";const jr=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},P1=function(n,e,t,r){return t&&(Dm(n,e,t,r,-1)||Dm(n,e,t,r,1))},$v=/^(img|br|input|textarea|hr)$/i;function Dm(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Ga(n))){let o=n.parentNode;if(!o||o.nodeType!=1||Eh(n)||$v.test(n.nodeName)||n.contentEditable=="false")return!1;e=jr(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Ga(n):0}else return!1}}function Ga(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Iv(n,e,t){for(let r=e==0,i=e==Ga(n);r||i;){if(n==t)return!0;let o=jr(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==Ga(n)}}function Eh(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const F1=function(n){return n.focusNode&&P1(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function L1(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}const Ht=typeof navigator<"u"?navigator:null,Tm=typeof document<"u"?document:null,Xn=Ht&&Ht.userAgent||"",Of=/Edge\/(\d+)/.exec(Xn),V1=/MSIE \d/.exec(Xn),Df=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Xn),yl=!!(V1||Df||Of),B1=V1?document.documentMode:Df?+Df[1]:Of?+Of[1]:0,Vu=!yl&&/gecko\/(\d+)/i.test(Xn);Vu&&+(/Firefox\/(\d+)/.exec(Xn)||[0,0])[1];const Tf=!yl&&/Chrome\/(\d+)/.exec(Xn),Zn=!!Tf,J1=Tf?+Tf[1]:0,Qr=!yl&&!!Ht&&/Apple Computer/.test(Ht.vendor),Mh=Qr&&(/Mobile\/\w+/.test(Xn)||!!Ht&&Ht.maxTouchPoints>2),ft=Mh||(Ht?/Mac/.test(Ht.platform):!1),zv=Ht?/Win/.test(Ht.platform):!1,Sl=/Android \d/.test(Xn),Oh=!!Tm&&"webkitFontSmoothing"in Tm.documentElement.style,Pv=Oh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Fv(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(F1(t)){for(a=l;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&O.isSelectable(c)&&i.parent&&!(c.isInline&&Iv(t.focusNode,t.focusOffset,i.dom))){let f=i.posBefore;u=new O(s==f?l:r.resolve(f))}}else{let c=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;a=r.resolve(c)}if(!u){let c=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=K1(n,a,l,c)}return u}function W1(n){return n.editable?n.hasFocus():Jv(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Dh(n,e=!1){let t=n.state.selection;if(Bv(n,t),!!W1(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Zn){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&P1(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Vv(n);else{let{anchor:r,head:i}=t,o,s;bm&&!(t instanceof $)&&(t.$from.parent.inlineContent||(o=Rm(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=Rm(n,t.to))),n.docView.setSelection(r,i,n.root,e),bm&&(o&&Am(o),s&&Am(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Lv(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const bm=Qr||Zn&&J1<63;function Rm(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(Qr&&i&&i.contentEditable=="false")return vc(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return vc(i);if(o)return vc(o)}}function vc(n){return n.contentEditable="true",Qr&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Am(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Lv(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!W1(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Vv(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setStart(r.parentNode,jr(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&yl&&B1<=11&&(r.disabled=!0,r.disabled=!1)}function Bv(n,e){if(e instanceof O){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&($m(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else $m(n)}function $m(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function K1(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function Jv(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function bf(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&z.findFrom(o,e)}function xn(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Im(n,e,t){let r=n.state.selection;if(r instanceof $)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return xn(n,new $(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=bf(n.state,e);return i&&i instanceof O?xn(n,i):!1}else if(!(ft&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(l))&&!s.contentDOM?O.isSelectable(o)?xn(n,new O(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):Oh?xn(n,new $(n.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof O&&r.node.isInline)return xn(n,new $(e>0?r.$to:r.$from));{let i=bf(n.state,e);return i?xn(n,i):!1}}}function Ya(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function fs(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function ri(n,e){return e<0?Wv(n):Kv(n)}function Wv(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(Vu&&t.nodeType==1&&r<Ya(t)&&fs(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(fs(l,-1))i=t,o=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(_1(t))break;{let l=t.previousSibling;for(;l&&fs(l,-1);)i=t.parentNode,o=jr(l),l=l.previousSibling;if(l)t=l,r=Ya(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Rf(n,t,r):i&&Rf(n,i,o)}function Kv(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=Ya(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let l=t.childNodes[r];if(fs(l,1))o=t,s=++r;else break}else{if(_1(t))break;{let l=t.nextSibling;for(;l&&fs(l,1);)o=l.parentNode,s=jr(l)+1,l=l.nextSibling;if(l)t=l,r=0,i=Ya(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Rf(n,o,s)}function _1(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function _v(n,e){for(;n&&e==n.childNodes.length&&!Eh(n);)e=jr(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function Hv(n,e){for(;n&&!e&&!Eh(n);)e=jr(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Rf(n,e,t){if(e.nodeType!=3){let o,s;(s=_v(e,t))?(e=s,t=0):(o=Hv(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(F1(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Dh(n)},50)}function zm(n,e){let t=n.state.doc.resolve(e);if(!(Zn||zv)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Pm(n,e,t){let r=n.state.selection;if(r instanceof $&&!r.empty||t.indexOf("s")>-1||ft&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=bf(n.state,e);if(s&&s instanceof O)return xn(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof Re?z.near(s,e):z.findFrom(s,e);return l?xn(n,l):!1}return!1}function Fm(n,e){if(!(n.state.selection instanceof $))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function Lm(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Uv(n){if(!Qr||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Lm(n,r,"true"),setTimeout(()=>Lm(n,r,"false"),20)}return!1}function qv(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function jv(n,e){let t=e.keyCode,r=qv(e);if(t==8||ft&&t==72&&r=="c")return Fm(n,-1)||ri(n,-1);if(t==46&&!e.shiftKey||ft&&t==68&&r=="c")return Fm(n,1)||ri(n,1);if(t==13||t==27)return!0;if(t==37||ft&&t==66&&r=="c"){let i=t==37?zm(n,n.state.selection.from)=="ltr"?-1:1:-1;return Im(n,i,r)||ri(n,i)}else if(t==39||ft&&t==70&&r=="c"){let i=t==39?zm(n,n.state.selection.from)=="ltr"?1:-1:1;return Im(n,i,r)||ri(n,i)}else{if(t==38||ft&&t==80&&r=="c")return Pm(n,-1,r)||ri(n,-1);if(t==40||ft&&t==78&&r=="c")return Uv(n)||Pm(n,1,r)||ri(n,1);if(r==(ft?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function H1(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=n.someProp("clipboardSerializer")||Yt.fromSchema(n.state.schema),l=Y1(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let u=a.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=G1[u.nodeName.toLowerCase()]);){for(let h=c.length-1;h>=0;h--){let p=l.createElement(c[h]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),f++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:d,slice:e}}function U1(n,e,t,r,i){let o=i.parent.type.spec.code,s,l;if(!t&&!e)return null;let a=e&&(r||o||!t);if(a){if(n.someProp("transformPastedText",d=>{e=d(e,o||r,n)}),o)return e?new w(x.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):w.empty;let f=n.someProp("clipboardTextParser",d=>d(e,i,r,n));if(f)l=f;else{let d=i.marks(),{schema:h}=n.state,p=Yt.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let S=s.appendChild(document.createElement("p"));m&&S.appendChild(p.serializeNode(h.text(m,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),s=Xv(t),Oh&&Zv(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let d=s.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;s=d}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||Vr.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!Qv.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)l=eE(Vm(l,+c[1],+c[2]),c[4]);else if(l=w.maxOpen(Gv(l.content,i),!0),l.openStart||l.openEnd){let f=0,d=0;for(let h=l.content.firstChild;f<l.openStart&&!h.type.spec.isolating;f++,h=h.firstChild);for(let h=l.content.lastChild;d<l.openEnd&&!h.type.spec.isolating;d++,h=h.lastChild);l=Vm(l,f,d)}return n.someProp("transformPasted",f=>{l=f(l,n)}),l}const Qv=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Gv(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),u;if(!a)return s=null;if(u=s.length&&o.length&&j1(a,o,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=Q1(s[s.length-1],o.length));let c=q1(l,a);s.push(c),i=i.matchType(c.type),o=a}}),s)return x.from(s)}return n}function q1(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,x.from(n));return n}function j1(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=j1(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(x.from(q1(t,n,i+1))))}}function Q1(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Q1(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(x.empty,!0);return n.copy(t.append(r))}function Af(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,l=s.content;return n.childCount>1&&(o=0),i<r-1&&(l=Af(l,e,t,r,i+1,o)),i>=t&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(x.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(l))}function Vm(n,e,t){return e<n.openStart&&(n=new w(Af(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new w(Af(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const G1={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Bm=null;function Y1(){return Bm||(Bm=document.implementation.createHTMLDocument("title"))}function Yv(n){let e=window.trustedTypes;return e?e.createPolicy("detachedDocument",{createHTML:t=>t}).createHTML(n):n}function Xv(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Y1().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&G1[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=Yv(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function Zv(n){let e=n.querySelectorAll(Zn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function eE(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=x.from(a.create(r[l+1],i)),o++,s++}return new w(i,o,s)}const It={},st={};function $n(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}st.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Z1(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Sl&&Zn&&t.keyCode==13)))if(n.domObserver.selectionChanged(n.domSelectionRange())?n.domObserver.flush():t.keyCode!=229&&n.domObserver.forceFlush(),Mh&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,L1(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||jv(n,t)?t.preventDefault():$n(n,"key")};st.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};st.keypress=(n,e)=>{let t=e;if(Z1(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||ft&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof $)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function Bu(n){return{left:n.clientX,top:n.clientY}}function tE(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Th(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,l=>s>o.depth?l(n,t,o.nodeAfter,o.before(s),i,!0):l(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function $i(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function nE(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&O.isSelectable(r)?($i(n,new O(t)),!0):!1}function rE(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof O&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(O.isSelectable(l)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?($i(n,O.create(n.state.doc,i)),!0):!1}function iE(n,e,t,r,i){return Th(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?rE(n,t):nE(n,t))}function oE(n,e,t,r){return Th(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function sE(n,e,t,r){return Th(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||lE(n,t,r)}function lE(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?($i(n,$.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)$i(n,$.create(r,l+1,l+1+s.content.size));else if(O.isSelectable(s))$i(n,O.create(r,l));else continue;return!0}}function bh(n){return Xa(n)}const X1=ft?"metaKey":"ctrlKey";It.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=bh(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&tE(t,n.input.lastClick)&&!t[X1]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o};let s=n.posAtCoords(Bu(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new aE(n,s,t,!!r)):(o=="doubleClick"?oE:sE)(n,s.pos,s.inside,t)?t.preventDefault():$n(n,"pointer"))};let aE=class{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[X1],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let c=e.state.doc.resolve(t.pos);o=c.parent,s=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof O&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Vu&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),$n(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Dh(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Bu(e))),this.updateAllowDefault(e),this.allowDefault||!t?$n(this.view,"pointer"):iE(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Qr&&this.mightDrag&&!this.mightDrag.node.isAtom||Zn&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?($i(this.view,z.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):$n(this.view,"pointer")}move(e){this.updateAllowDefault(e),$n(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}};It.touchstart=n=>{n.input.lastTouch=Date.now(),bh(n),$n(n,"pointer")};It.touchmove=n=>{n.input.lastTouch=Date.now(),$n(n,"pointer")};It.contextmenu=n=>bh(n);function Z1(n,e){return n.composing?!0:Qr&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const uE=Sl?5e3:-1;st.compositionstart=st.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof $&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Xa(n,!0),n.markCursor=null;else if(Xa(n,!e.selection.empty),Vu&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let l=n.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}eS(n,uE)};st.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,eS(n,20))};function eS(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Xa(n),e))}function cE(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=fE());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function fE(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Xa(n,e=!1){if(!(Sl&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),cE(n),e||n.docView&&n.docView.dirty){let t=Fv(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function dE(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const As=yl&&B1<15||Mh&&Pv<604;It.copy=st.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=As?null:t.clipboardData,s=r.content(),{dom:l,text:a}=H1(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):dE(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function hE(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function pE(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?$f(n,r.value,null,i,e):$f(n,r.textContent,r.innerHTML,i,e)},50)}function $f(n,e,t,r,i){let o=U1(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,i,o||w.empty)))return!0;if(!o)return!1;let s=hE(o),l=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function tS(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}st.paste=(n,e)=>{let t=e;if(n.composing&&!Sl)return;let r=As?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&$f(n,tS(r),r.getData("text/html"),i,t)?t.preventDefault():pE(n,t)};let mE=class{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}};const nS=ft?"altKey":"ctrlKey";It.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(Bu(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof O?i.to-1:i.to))){if(r&&r.mightDrag)s=O.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(s=O.create(n.state.doc,f.posBefore))}}let l=(s||n.state.selection).content(),{dom:a,text:u,slice:c}=H1(n,l);(!t.dataTransfer.files.length||!Zn||J1>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(As?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",As||t.dataTransfer.setData("text/plain",u),n.dragging=new mE(c,!t[nS],s)};It.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};st.dragover=st.dragenter=(n,e)=>e.preventDefault();st.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Bu(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",p=>{s=p(s,n)}):s=U1(n,tS(t.dataTransfer),As?null:t.dataTransfer.getData("text/html"),!1,o);let l=!!(r&&!t[nS]);if(n.someProp("handleDrop",p=>p(n,t,s||w.empty,l))){t.preventDefault();return}if(!s)return;t.preventDefault();let a=s?Rv(n.state.doc,o.pos,s):o.pos;a==null&&(a=o.pos);let u=n.state.tr;if(l){let{node:p}=r;p?p.replace(u):u.deleteSelection()}let c=u.mapping.map(a),f=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,d=u.doc;if(f?u.replaceRangeWith(c,c,s.content.firstChild):u.replaceRange(c,c,s),u.doc.eq(d))return;let h=u.doc.resolve(c);if(f&&O.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new O(h));else{let p=u.mapping.map(a);u.mapping.maps[u.mapping.maps.length-1].forEach((m,S,g,y)=>p=y),u.setSelection(K1(n,h,u.doc.resolve(p)))}n.focus(),n.dispatch(u.setMeta("uiEvent","drop"))};It.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Dh(n)},20))};It.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};It.beforeinput=(n,e)=>{if(Zn&&Sl&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,L1(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in st)It[n]=st[n];function $s(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}let Jm=class rS{constructor(e,t){this.toDOM=e,this.spec=t||br,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new kl(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof rS&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&$s(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}},ds=class If{constructor(e,t){this.attrs=e,this.spec=t||br}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new kl(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof If&&$s(this.attrs,e.attrs)&&$s(this.spec,e.spec)}static is(e){return e.type instanceof If}destroy(){}},gE=class iS{constructor(e,t){this.attrs=e,this.spec=t||br}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new kl(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof iS&&$s(this.attrs,e.attrs)&&$s(this.spec,e.spec)}destroy(){}},kl=class Wo{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Wo(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Wo(e,e,new Jm(t,r))}static inline(e,t,r,i){return new Wo(e,t,new ds(r,i))}static node(e,t,r,i){return new Wo(e,t,new gE(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof ds}get widget(){return this.type instanceof Jm}};const di=[],br={};let Bt=class Sn{constructor(e,t){this.local=e.length?e:di,this.children=t.length?t:di}static create(e,t){return t.length?Za(t,e,0,br):Oe}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=t&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,t-l,r,i+l,o)}}map(e,t,r){return this==Oe||e.maps.length==0?this:this.mapInner(e,t,0,0,r||br)}mapInner(e,t,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(t,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?SE(this.children,s||[],e,t,r,i,o):s?new Sn(s.sort(Rr),di):Oe}add(e,t){return t.length?this==Oe?Sn.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((l,a)=>{let u=a+r,c;if(c=sS(t,l,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,c,u+1):i.splice(o,0,a,a+l.nodeSize,Za(c,l,u+1,br)),o+=3}});let s=oS(o?lS(t):t,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new Sn(s.length?this.local.concat(s).sort(Rr):this.local,i||this.children)}remove(e){return e.length==0||this==Oe?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+t,a=r[o+1]+t;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,l+1);u!=Oe?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Sn(i,r):Oe}forChild(e,t){if(this==Oe)return this;if(t.isLeaf)return Sn.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof ds){let u=Math.max(o,a.from)-o,c=Math.min(s,a.to)-o;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new Sn(i.sort(Rr),di);return r?new yE([l,r]):l}return r||Oe}eq(e){if(this==e)return!0;if(!(e instanceof Sn)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Rh(this.localsInner(e))}localsInner(e){if(this==Oe)return di;if(e.inlineContent||!this.local.some(ds.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ds||t.push(this.local[r]);return t}forEachSet(e){e(this)}};Bt.empty=new Bt([],[]);Bt.removeOverlap=Rh;const Oe=Bt.empty;let yE=class hi{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,br));return hi.from(r)}forChild(e,t){if(t.isLeaf)return Bt.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Oe&&(o instanceof hi?r=r.concat(o.members):r.push(o))}return hi.from(r)}eq(e){if(!(e instanceof hi)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?Rh(r?t:t.sort(Rr)):di}static from(e){switch(e.length){case 0:return Oe;case 1:return e[0];default:return new hi(e.every(t=>t instanceof Bt)?e:e.reduce((t,r)=>t.concat(r instanceof Bt?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}};function SE(n,e,t,r,i,o,s){let l=n.slice();for(let u=0,c=o;u<t.maps.length;u++){let f=0;t.maps[u].forEach((d,h,p,m)=>{let S=m-p-(h-d);for(let g=0;g<l.length;g+=3){let y=l[g+1];if(y<0||d>y+c-f)continue;let k=l[g]+c-f;h>=k?l[g+1]=d<=k?-2:-1:d>=c&&S&&(l[g]+=S,l[g+1]+=S)}f+=S}),c=t.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=t.map(n[u]+o),f=c-i;if(f<0||f>=r.content.size){a=!0;continue}let d=t.map(n[u+1]+o,-1),h=d-i,{index:p,offset:m}=r.content.findIndex(f),S=r.maybeChild(p);if(S&&m==f&&m+S.nodeSize==h){let g=l[u+2].mapInner(t,S,c+1,n[u]+o+1,s);g!=Oe?(l[u]=f,l[u+1]=h,l[u+2]=g):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=kE(l,n,e,t,i,o,s),c=Za(u,r,0,s);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,d=0;f<c.children.length;f+=3){let h=c.children[f];for(;d<l.length&&l[d]<h;)d+=3;l.splice(d,0,c.children[f],c.children[f+1],c.children[f+2])}}return new Bt(e.sort(Rr),l)}function oS(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new kl(i.from+e,i.to+e,i.type))}return t}function kE(n,e,t,r,i,o,s){function l(a,u){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(r,i,u);f?t.push(f):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+o+1);return t}function sS(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function lS(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Za(n,e,t,r){let i=[],o=!1;e.forEach((l,a)=>{let u=sS(n,l,a+t);if(u){o=!0;let c=Za(u,l,t+a+1,r);c!=Oe&&i.push(a,a+l.nodeSize,c)}});let s=oS(o?lS(n):n,-t).sort(Rr);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new Bt(s,i):Oe}function Rr(n,e){return n.from-e.from||n.to-e.to}function Rh(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),Wm(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),Wm(e,i,r.copy(o.from,r.to)));break}}}return e}function Wm(n,e,t){for(;e<n.length&&Rr(t,n[e])>0;)e++;n.splice(e,0,t)}class Z extends z{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Z.valid(r)?new Z(r):z.near(r)}content(){return w.empty}eq(e){return e instanceof Z&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Z(e.resolve(t.pos))}getBookmark(){return new Ah(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!wE(e)||!xE(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Z.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let l=e.node(s);if(t>0?e.indexAfter(s)<l.childCount:e.index(s)>0){o=l.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let a=e.doc.resolve(i);if(Z.valid(a))return a}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!O.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let l=e.doc.resolve(i);if(Z.valid(l))return l}return null}}}Z.prototype.visible=!1;Z.findFrom=Z.findGapCursorFrom;z.jsonID("gapcursor",Z);class Ah{constructor(e){this.pos=e}map(e){return new Ah(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Z.valid(t)?new Z(t):z.near(t)}}function wE(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function xE(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function CE(){return new Xt({props:{decorations:ME,createSelectionBetween(n,e,t){return e.pos==t.pos&&Z.valid(t)?new Z(t):null},handleClick:vE,handleKeyDown:NE,handleDOMEvents:{beforeinput:EE}}})}const NE=Mv({ArrowLeft:Ll("horiz",-1),ArrowRight:Ll("horiz",1),ArrowUp:Ll("vert",-1),ArrowDown:Ll("vert",1)});function Ll(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,l=e>0?s.$to:s.$from,a=s.empty;if(s instanceof $){if(!o.endOfTextblock(t)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=Z.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new Z(u))),!0):!1}}function vE(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Z.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&O.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Z(r))),!0)}function EE(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Z))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=x.empty;for(let s=r.length-1;s>=0;s--)i=x.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new w(i,0,0));return o.setSelection($.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function ME(n){if(!(n.selection instanceof Z))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Bt.create(n.doc,[kl.widget(n.selection.head,e,{key:"gapcursor"})])}const aS=65535,uS=Math.pow(2,16);function OE(n,e){return n+e*uS}function Km(n){return n&aS}function DE(n){return(n-(n&aS))/uS}const cS=1,fS=2,xa=4,dS=8;let _m=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&dS)>0}get deletedBefore(){return(this.delInfo&(cS|xa))>0}get deletedAfter(){return(this.delInfo&(fS|xa))>0}get deletedAcross(){return(this.delInfo&xa)>0}},Qi=class pi{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&pi.empty)return pi.empty}recover(e){let t=0,r=Km(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+DE(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:c);if(r)return h;let p=e==(t<0?a:f)?null:OE(l/3,e-a),m=e==a?fS:e==f?cS:xa;return(t<0?e!=a:e!=f)&&(m|=dS),new _m(h,m,p)}i+=c-u}return r?e+i:new _m(e+i,0,null)}touches(e,t){let r=0,i=Km(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new pi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?pi.empty:new pi(e<0?[0,-e,0]:[0,0,e])}};Qi.empty=new Qi([]);const Ec=Object.create(null);let Ze=class{getMap(){return Qi.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ec[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ec)throw new RangeError("Duplicate use of step JSON ID "+e);return Ec[e]=t,t.prototype.jsonID=e,t}},We=class Ko{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ko(e,null)}static fail(e){return new Ko(null,e)}static fromReplace(e,t,r,i){try{return Ko.ok(e.replace(t,r,i))}catch(o){if(o instanceof Kt)return Ko.fail(o.message);throw o}}};function $h(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy($h(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}let hS=class _o extends Ze{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w($h(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return We.fromReplace(e,this.from,this.to,o)}invert(){return new pS(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new _o(t.pos,r.pos,this.mark)}merge(e){return e instanceof _o&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new _o(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new _o(t.from,t.to,e.markFromJSON(t.mark))}};Ze.jsonID("addMark",hS);let pS=class Ho extends Ze{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w($h(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return We.fromReplace(e,this.from,this.to,r)}invert(){return new hS(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ho(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ho&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ho(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ho(t.from,t.to,e.markFromJSON(t.mark))}};Ze.jsonID("removeMark",pS);let mS=class Uo extends Ze{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return We.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return We.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Uo(this.pos,t.marks[i]);return new Uo(this.pos,this.mark)}}return new gS(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Uo(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Uo(t.pos,e.markFromJSON(t.mark))}};Ze.jsonID("addNodeMark",mS);let gS=class zf extends Ze{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return We.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return We.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new mS(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new zf(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new zf(t.pos,e.markFromJSON(t.mark))}};Ze.jsonID("removeNodeMark",gS);let TE=class pr extends Ze{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Pf(e,this.from,this.to)?We.fail("Structure replace would overwrite content"):We.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Qi([this.from,this.to-this.from,this.slice.size])}invert(e){return new pr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new pr(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof pr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new pr(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new pr(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new pr(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};Ze.jsonID("replace",TE);let bE=class Ca extends Ze{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Pf(e,this.from,this.gapFrom)||Pf(e,this.gapTo,this.to)))return We.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return We.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?We.fromReplace(e,this.from,this.to,r):We.fail("Content does not fit in gap")}getMap(){return new Qi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ca(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Ca(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ca(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};Ze.jsonID("replaceAround",bE);function Pf(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function RE(n,e,t=null,r=n){let i=AE(n,e),o=i&&$E(r,e);return o?i.map(Hm).concat({type:e,attrs:t}).concat(o.map(Hm)):null}function Hm(n){return{type:n,attrs:null}}function AE(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function $E(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(t.child(u).type);return!a||!a.validEnd?null:s}function IE(n,e){let t=n.resolve(e),r=t.index();return zE(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function zE(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}let PE=class Na extends Ze{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return We.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return We.fromReplace(e,this.pos,this.pos+1,new w(x.from(i),0,t.isLeaf?0:1))}getMap(){return Qi.empty}invert(e){return new Na(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Na(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Na(t.pos,t.attr,t.value)}};Ze.jsonID("attr",PE);let Is=class extends Error{};Is=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Is.prototype=Object.create(Error.prototype);Is.prototype.constructor=Is;Is.prototype.name="TransformError";class Gr{constructor(e,t,r={}){this.match=e,this.match=e,this.handler=typeof t=="string"?FE(t):t,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1}}function FE(n){return function(e,t,r,i){let o=n;if(t[1]){let s=t[0].lastIndexOf(t[1]);o+=t[0].slice(s+t[1].length),r+=s;let l=r-i;l>0&&(o=t[0].slice(s-l,s)+o,r=i)}return e.tr.insertText(o,r,i)}}const LE=500;function VE({rules:n}){let e=new Xt({state:{init(){return null},apply(t,r){let i=t.getMeta(this);return i||(t.selectionSet||t.docChanged?null:r)}},props:{handleTextInput(t,r,i,o){return Um(t,r,i,o,n,e)},handleDOMEvents:{compositionend:t=>{setTimeout(()=>{let{$cursor:r}=t.state.selection;r&&Um(t,r.pos,r.pos,"",n,e)})}}},isInputRules:!0});return e}function Um(n,e,t,r,i,o){if(n.composing)return!1;let s=n.state,l=s.doc.resolve(e),a=l.parent.textBetween(Math.max(0,l.parentOffset-LE),l.parentOffset,null,"￼")+r;for(let u=0;u<i.length;u++){let c=i[u];if(l.parent.type.spec.code){if(!c.inCode)continue}else if(c.inCode==="only")continue;let f=c.match.exec(a),d=f&&c.handler(s,f,e-(f[0].length-r.length),t);if(d)return c.undoable&&d.setMeta(o,{transform:d,from:e,to:t,text:r}),n.dispatch(d),!0}return!1}new Gr(/--$/,"—");new Gr(/\.\.\.$/,"…");new Gr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new Gr(/"$/,"”");new Gr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new Gr(/'$/,"’");function BE(n,e,t=null,r){return new Gr(n,(i,o,s,l)=>{let a=t instanceof Function?t(o):t,u=i.tr.delete(s,l),c=u.doc.resolve(s),f=c.blockRange(),d=f&&RE(f,e,a);if(!d)return null;u.wrap(f,d);let h=u.doc.resolve(s-1).nodeBefore;return h&&h.type==e&&IE(u.doc,s-1)&&!r&&u.join(s-1),u})}const JE=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function WE(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))JE?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function KE(n){let e=Object.create(null);for(let t in n)e[WE(t)]=n[t];return e}function Mc(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function _E(n){return new Xt({props:{handleKeyDown:HE(n)}})}function HE(n){let e=KE(n);return function(t,r){let i=Nh(r),o,s=e[Mc(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Mc(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=_t[r.keyCode])&&o!=i){let l=e[Mc(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const yS=65535,SS=Math.pow(2,16);function UE(n,e){return n+e*SS}function qm(n){return n&yS}function qE(n){return(n-(n&yS))/SS}const kS=1,wS=2,va=4,xS=8;let jm=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&xS)>0}get deletedBefore(){return(this.delInfo&(kS|va))>0}get deletedAfter(){return(this.delInfo&(wS|va))>0}get deletedAcross(){return(this.delInfo&va)>0}},Gi=class mi{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&mi.empty)return mi.empty}recover(e){let t=0,r=qm(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+qE(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:c);if(r)return h;let p=e==(t<0?a:f)?null:UE(l/3,e-a),m=e==a?wS:e==f?kS:va;return(t<0?e!=a:e!=f)&&(m|=xS),new jm(h,m,p)}i+=c-u}return r?e+i:new jm(e+i,0,null)}touches(e,t){let r=0,i=qm(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new mi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?mi.empty:new mi(e<0?[0,-e,0]:[0,0,e])}};Gi.empty=new Gi([]);const Oc=Object.create(null);let et=class{getMap(){return Gi.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Oc[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Oc)throw new RangeError("Duplicate use of step JSON ID "+e);return Oc[e]=t,t.prototype.jsonID=e,t}},Ke=class qo{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new qo(e,null)}static fail(e){return new qo(null,e)}static fromReplace(e,t,r,i){try{return qo.ok(e.replace(t,r,i))}catch(o){if(o instanceof Kt)return qo.fail(o.message);throw o}}};function Ih(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Ih(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}let CS=class jo extends et{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(Ih(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Ke.fromReplace(e,this.from,this.to,o)}invert(){return new NS(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new jo(t.pos,r.pos,this.mark)}merge(e){return e instanceof jo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new jo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new jo(t.from,t.to,e.markFromJSON(t.mark))}};et.jsonID("addMark",CS);let NS=class Qo extends et{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(Ih(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Ke.fromReplace(e,this.from,this.to,r)}invert(){return new CS(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Qo(t.pos,r.pos,this.mark)}merge(e){return e instanceof Qo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Qo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Qo(t.from,t.to,e.markFromJSON(t.mark))}};et.jsonID("removeMark",NS);let vS=class Go extends et{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ke.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Ke.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Go(this.pos,t.marks[i]);return new Go(this.pos,this.mark)}}return new ES(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Go(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Go(t.pos,e.markFromJSON(t.mark))}};et.jsonID("addNodeMark",vS);let ES=class Ff extends et{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ke.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Ke.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new vS(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ff(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ff(t.pos,e.markFromJSON(t.mark))}};et.jsonID("removeNodeMark",ES);let jE=class mr extends et{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Lf(e,this.from,this.to)?Ke.fail("Structure replace would overwrite content"):Ke.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Gi([this.from,this.to-this.from,this.slice.size])}invert(e){return new mr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new mr(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof mr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new mr(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new mr(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new mr(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};et.jsonID("replace",jE);let QE=class Ea extends et{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Lf(e,this.from,this.gapFrom)||Lf(e,this.gapTo,this.to)))return Ke.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Ke.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Ke.fromReplace(e,this.from,this.to,r):Ke.fail("Content does not fit in gap")}getMap(){return new Gi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ea(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Ea(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ea(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};et.jsonID("replaceAround",QE);function Lf(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function GE(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(a,a,i);else{let f=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(a,a,f[0])}if(c)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}let YE=class Ma extends et{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ke.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Ke.fromReplace(e,this.pos,this.pos+1,new w(x.from(i),0,t.isLeaf?0:1))}getMap(){return Gi.empty}invert(e){return new Ma(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ma(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ma(t.pos,t.attr,t.value)}};et.jsonID("attr",YE);let zs=class extends Error{};zs=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};zs.prototype=Object.create(Error.prototype);zs.prototype.constructor=zs;zs.prototype.name="TransformError";const Yr=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},MS=function(n,e,t,r){return t&&(Qm(n,e,t,r,-1)||Qm(n,e,t,r,1))},XE=/^(img|br|input|textarea|hr)$/i;function Qm(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:eu(n))){let o=n.parentNode;if(!o||o.nodeType!=1||zh(n)||XE.test(n.nodeName)||n.contentEditable=="false")return!1;e=Yr(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?eu(n):0}else return!1}}function eu(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ZE(n,e,t){for(let r=e==0,i=e==eu(n);r||i;){if(n==t)return!0;let o=Yr(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==eu(n)}}function zh(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const OS=function(n){return n.focusNode&&MS(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function DS(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}const Ut=typeof navigator<"u"?navigator:null,Gm=typeof document<"u"?document:null,er=Ut&&Ut.userAgent||"",Vf=/Edge\/(\d+)/.exec(er),TS=/MSIE \d/.exec(er),Bf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(er),wl=!!(TS||Bf||Vf),bS=TS?document.documentMode:Bf?+Bf[1]:Vf?+Vf[1]:0,Ju=!wl&&/gecko\/(\d+)/i.test(er);Ju&&+(/Firefox\/(\d+)/.exec(er)||[0,0])[1];const Jf=!wl&&/Chrome\/(\d+)/.exec(er),tr=!!Jf,RS=Jf?+Jf[1]:0,Xr=!wl&&!!Ut&&/Apple Computer/.test(Ut.vendor),Ph=Xr&&(/Mobile\/\w+/.test(er)||!!Ut&&Ut.maxTouchPoints>2),dt=Ph||(Ut?/Mac/.test(Ut.platform):!1),eM=Ut?/Win/.test(Ut.platform):!1,xl=/Android \d/.test(er),Fh=!!Gm&&"webkitFontSmoothing"in Gm.documentElement.style,tM=Fh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function nM(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(OS(t)){for(a=l;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&O.isSelectable(c)&&i.parent&&!(c.isInline&&ZE(t.focusNode,t.focusOffset,i.dom))){let f=i.posBefore;u=new O(s==f?l:r.resolve(f))}}else{let c=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;a=r.resolve(c)}if(!u){let c=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=$S(n,a,l,c)}return u}function AS(n){return n.editable?n.hasFocus():sM(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Lh(n,e=!1){let t=n.state.selection;if(oM(n,t),!!AS(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&tr){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&MS(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)iM(n);else{let{anchor:r,head:i}=t,o,s;Ym&&!(t instanceof $)&&(t.$from.parent.inlineContent||(o=Xm(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=Xm(n,t.to))),n.docView.setSelection(r,i,n.root,e),Ym&&(o&&Zm(o),s&&Zm(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&rM(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Ym=Xr||tr&&RS<63;function Xm(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(Xr&&i&&i.contentEditable=="false")return Dc(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Dc(i);if(o)return Dc(o)}}function Dc(n){return n.contentEditable="true",Xr&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Zm(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function rM(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!AS(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function iM(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setStart(r.parentNode,Yr(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&wl&&bS<=11&&(r.disabled=!0,r.disabled=!1)}function oM(n,e){if(e instanceof O){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(eg(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else eg(n)}function eg(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function $S(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function sM(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Wf(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&z.findFrom(o,e)}function Cn(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function tg(n,e,t){let r=n.state.selection;if(r instanceof $)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Cn(n,new $(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Wf(n.state,e);return i&&i instanceof O?Cn(n,i):!1}else if(!(dt&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(l))&&!s.contentDOM?O.isSelectable(o)?Cn(n,new O(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):Fh?Cn(n,new $(n.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof O&&r.node.isInline)return Cn(n,new $(e>0?r.$to:r.$from));{let i=Wf(n.state,e);return i?Cn(n,i):!1}}}function tu(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function hs(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function ii(n,e){return e<0?lM(n):aM(n)}function lM(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(Ju&&t.nodeType==1&&r<tu(t)&&hs(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(hs(l,-1))i=t,o=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(IS(t))break;{let l=t.previousSibling;for(;l&&hs(l,-1);)i=t.parentNode,o=Yr(l),l=l.previousSibling;if(l)t=l,r=tu(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Kf(n,t,r):i&&Kf(n,i,o)}function aM(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=tu(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let l=t.childNodes[r];if(hs(l,1))o=t,s=++r;else break}else{if(IS(t))break;{let l=t.nextSibling;for(;l&&hs(l,1);)o=l.parentNode,s=Yr(l)+1,l=l.nextSibling;if(l)t=l,r=0,i=tu(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Kf(n,o,s)}function IS(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function uM(n,e){for(;n&&e==n.childNodes.length&&!zh(n);)e=Yr(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function cM(n,e){for(;n&&!e&&!zh(n);)e=Yr(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Kf(n,e,t){if(e.nodeType!=3){let o,s;(s=uM(e,t))?(e=s,t=0):(o=cM(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(OS(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Lh(n)},50)}function ng(n,e){let t=n.state.doc.resolve(e);if(!(tr||eM)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function rg(n,e,t){let r=n.state.selection;if(r instanceof $&&!r.empty||t.indexOf("s")>-1||dt&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Wf(n.state,e);if(s&&s instanceof O)return Cn(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof Re?z.near(s,e):z.findFrom(s,e);return l?Cn(n,l):!1}return!1}function ig(n,e){if(!(n.state.selection instanceof $))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function og(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function fM(n){if(!Xr||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;og(n,r,"true"),setTimeout(()=>og(n,r,"false"),20)}return!1}function dM(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function hM(n,e){let t=e.keyCode,r=dM(e);if(t==8||dt&&t==72&&r=="c")return ig(n,-1)||ii(n,-1);if(t==46&&!e.shiftKey||dt&&t==68&&r=="c")return ig(n,1)||ii(n,1);if(t==13||t==27)return!0;if(t==37||dt&&t==66&&r=="c"){let i=t==37?ng(n,n.state.selection.from)=="ltr"?-1:1:-1;return tg(n,i,r)||ii(n,i)}else if(t==39||dt&&t==70&&r=="c"){let i=t==39?ng(n,n.state.selection.from)=="ltr"?1:-1:1;return tg(n,i,r)||ii(n,i)}else{if(t==38||dt&&t==80&&r=="c")return rg(n,-1,r)||ii(n,-1);if(t==40||dt&&t==78&&r=="c")return fM(n)||rg(n,1,r)||ii(n,1);if(r==(dt?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function zS(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=n.someProp("clipboardSerializer")||Yt.fromSchema(n.state.schema),l=JS(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let u=a.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=BS[u.nodeName.toLowerCase()]);){for(let h=c.length-1;h>=0;h--){let p=l.createElement(c[h]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),f++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:d,slice:e}}function PS(n,e,t,r,i){let o=i.parent.type.spec.code,s,l;if(!t&&!e)return null;let a=e&&(r||o||!t);if(a){if(n.someProp("transformPastedText",d=>{e=d(e,o||r,n)}),o)return e?new w(x.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):w.empty;let f=n.someProp("clipboardTextParser",d=>d(e,i,r,n));if(f)l=f;else{let d=i.marks(),{schema:h}=n.state,p=Yt.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let S=s.appendChild(document.createElement("p"));m&&S.appendChild(p.serializeNode(h.text(m,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),s=yM(t),Fh&&SM(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let d=s.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;s=d}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||Vr.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!pM.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)l=kM(sg(l,+c[1],+c[2]),c[4]);else if(l=w.maxOpen(mM(l.content,i),!0),l.openStart||l.openEnd){let f=0,d=0;for(let h=l.content.firstChild;f<l.openStart&&!h.type.spec.isolating;f++,h=h.firstChild);for(let h=l.content.lastChild;d<l.openEnd&&!h.type.spec.isolating;d++,h=h.lastChild);l=sg(l,f,d)}return n.someProp("transformPasted",f=>{l=f(l,n)}),l}const pM=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function mM(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),u;if(!a)return s=null;if(u=s.length&&o.length&&LS(a,o,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=VS(s[s.length-1],o.length));let c=FS(l,a);s.push(c),i=i.matchType(c.type),o=a}}),s)return x.from(s)}return n}function FS(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,x.from(n));return n}function LS(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=LS(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(x.from(FS(t,n,i+1))))}}function VS(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,VS(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(x.empty,!0);return n.copy(t.append(r))}function _f(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,l=s.content;return n.childCount>1&&(o=0),i<r-1&&(l=_f(l,e,t,r,i+1,o)),i>=t&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(x.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(l))}function sg(n,e,t){return e<n.openStart&&(n=new w(_f(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new w(_f(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const BS={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let lg=null;function JS(){return lg||(lg=document.implementation.createHTMLDocument("title"))}function gM(n){let e=window.trustedTypes;return e?e.createPolicy("detachedDocument",{createHTML:t=>t}).createHTML(n):n}function yM(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=JS().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&BS[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=gM(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function SM(n){let e=n.querySelectorAll(tr?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function kM(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=x.from(a.create(r[l+1],i)),o++,s++}return new w(i,o,s)}const zt={},lt={};function In(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}lt.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!KS(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(xl&&tr&&t.keyCode==13)))if(n.domObserver.selectionChanged(n.domSelectionRange())?n.domObserver.flush():t.keyCode!=229&&n.domObserver.forceFlush(),Ph&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,DS(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||hM(n,t)?t.preventDefault():In(n,"key")};lt.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};lt.keypress=(n,e)=>{let t=e;if(KS(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||dt&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof $)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function Wu(n){return{left:n.clientX,top:n.clientY}}function wM(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Vh(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,l=>s>o.depth?l(n,t,o.nodeAfter,o.before(s),i,!0):l(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function Ii(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function xM(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&O.isSelectable(r)?(Ii(n,new O(t)),!0):!1}function CM(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof O&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(O.isSelectable(l)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(Ii(n,O.create(n.state.doc,i)),!0):!1}function NM(n,e,t,r,i){return Vh(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?CM(n,t):xM(n,t))}function vM(n,e,t,r){return Vh(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function EM(n,e,t,r){return Vh(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||MM(n,t,r)}function MM(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Ii(n,$.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)Ii(n,$.create(r,l+1,l+1+s.content.size));else if(O.isSelectable(s))Ii(n,O.create(r,l));else continue;return!0}}function Bh(n){return nu(n)}const WS=dt?"metaKey":"ctrlKey";zt.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Bh(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&wM(t,n.input.lastClick)&&!t[WS]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o};let s=n.posAtCoords(Wu(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new OM(n,s,t,!!r)):(o=="doubleClick"?vM:EM)(n,s.pos,s.inside,t)?t.preventDefault():In(n,"pointer"))};let OM=class{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[WS],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let c=e.state.doc.resolve(t.pos);o=c.parent,s=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof O&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ju&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),In(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Lh(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Wu(e))),this.updateAllowDefault(e),this.allowDefault||!t?In(this.view,"pointer"):NM(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Xr&&this.mightDrag&&!this.mightDrag.node.isAtom||tr&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ii(this.view,z.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):In(this.view,"pointer")}move(e){this.updateAllowDefault(e),In(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}};zt.touchstart=n=>{n.input.lastTouch=Date.now(),Bh(n),In(n,"pointer")};zt.touchmove=n=>{n.input.lastTouch=Date.now(),In(n,"pointer")};zt.contextmenu=n=>Bh(n);function KS(n,e){return n.composing?!0:Xr&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const DM=xl?5e3:-1;lt.compositionstart=lt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof $&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),nu(n,!0),n.markCursor=null;else if(nu(n,!e.selection.empty),Ju&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let l=n.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}_S(n,DM)};lt.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,_S(n,20))};function _S(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>nu(n),e))}function TM(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=bM());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function bM(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function nu(n,e=!1){if(!(xl&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),TM(n),e||n.docView&&n.docView.dirty){let t=nM(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function RM(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ps=wl&&bS<15||Ph&&tM<604;zt.copy=lt.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=Ps?null:t.clipboardData,s=r.content(),{dom:l,text:a}=zS(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):RM(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function AM(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function $M(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Hf(n,r.value,null,i,e):Hf(n,r.textContent,r.innerHTML,i,e)},50)}function Hf(n,e,t,r,i){let o=PS(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,i,o||w.empty)))return!0;if(!o)return!1;let s=AM(o),l=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function HS(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}lt.paste=(n,e)=>{let t=e;if(n.composing&&!xl)return;let r=Ps?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Hf(n,HS(r),r.getData("text/html"),i,t)?t.preventDefault():$M(n,t)};let IM=class{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}};const US=dt?"altKey":"ctrlKey";zt.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(Wu(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof O?i.to-1:i.to))){if(r&&r.mightDrag)s=O.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(s=O.create(n.state.doc,f.posBefore))}}let l=(s||n.state.selection).content(),{dom:a,text:u,slice:c}=zS(n,l);(!t.dataTransfer.files.length||!tr||RS>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Ps?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ps||t.dataTransfer.setData("text/plain",u),n.dragging=new IM(c,!t[US],s)};zt.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};lt.dragover=lt.dragenter=(n,e)=>e.preventDefault();lt.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Wu(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",p=>{s=p(s,n)}):s=PS(n,HS(t.dataTransfer),Ps?null:t.dataTransfer.getData("text/html"),!1,o);let l=!!(r&&!t[US]);if(n.someProp("handleDrop",p=>p(n,t,s||w.empty,l))){t.preventDefault();return}if(!s)return;t.preventDefault();let a=s?GE(n.state.doc,o.pos,s):o.pos;a==null&&(a=o.pos);let u=n.state.tr;if(l){let{node:p}=r;p?p.replace(u):u.deleteSelection()}let c=u.mapping.map(a),f=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,d=u.doc;if(f?u.replaceRangeWith(c,c,s.content.firstChild):u.replaceRange(c,c,s),u.doc.eq(d))return;let h=u.doc.resolve(c);if(f&&O.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new O(h));else{let p=u.mapping.map(a);u.mapping.maps[u.mapping.maps.length-1].forEach((m,S,g,y)=>p=y),u.setSelection($S(n,h,u.doc.resolve(p)))}n.focus(),n.dispatch(u.setMeta("uiEvent","drop"))};zt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Lh(n)},20))};zt.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};zt.beforeinput=(n,e)=>{if(tr&&xl&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,DS(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in lt)zt[n]=lt[n];function Fs(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}let ag=class qS{constructor(e,t){this.toDOM=e,this.spec=t||Ar,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new co(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof qS&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Fs(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}},ps=class Uf{constructor(e,t){this.attrs=e,this.spec=t||Ar}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new co(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Uf&&Fs(this.attrs,e.attrs)&&Fs(this.spec,e.spec)}static is(e){return e.type instanceof Uf}destroy(){}},zM=class jS{constructor(e,t){this.attrs=e,this.spec=t||Ar}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new co(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof jS&&Fs(this.attrs,e.attrs)&&Fs(this.spec,e.spec)}destroy(){}},co=class Yo{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Yo(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Yo(e,e,new ag(t,r))}static inline(e,t,r,i){return new Yo(e,t,new ps(r,i))}static node(e,t,r,i){return new Yo(e,t,new zM(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof ps}get widget(){return this.type instanceof ag}};const gi=[],Ar={};let wt=class kn{constructor(e,t){this.local=e.length?e:gi,this.children=t.length?t:gi}static create(e,t){return t.length?ru(t,e,0,Ar):De}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=t&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,t-l,r,i+l,o)}}map(e,t,r){return this==De||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Ar)}mapInner(e,t,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(t,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?FM(this.children,s||[],e,t,r,i,o):s?new kn(s.sort($r),gi):De}add(e,t){return t.length?this==De?kn.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((l,a)=>{let u=a+r,c;if(c=GS(t,l,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,c,u+1):i.splice(o,0,a,a+l.nodeSize,ru(c,l,u+1,Ar)),o+=3}});let s=QS(o?YS(t):t,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new kn(s.length?this.local.concat(s).sort($r):this.local,i||this.children)}remove(e){return e.length==0||this==De?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+t,a=r[o+1]+t;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,l+1);u!=De?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new kn(i,r):De}forChild(e,t){if(this==De)return this;if(t.isLeaf)return kn.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof ps){let u=Math.max(o,a.from)-o,c=Math.min(s,a.to)-o;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new kn(i.sort($r),gi);return r?new PM([l,r]):l}return r||De}eq(e){if(this==e)return!0;if(!(e instanceof kn)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Jh(this.localsInner(e))}localsInner(e){if(this==De)return gi;if(e.inlineContent||!this.local.some(ps.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ps||t.push(this.local[r]);return t}forEachSet(e){e(this)}};wt.empty=new wt([],[]);wt.removeOverlap=Jh;const De=wt.empty;let PM=class yi{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Ar));return yi.from(r)}forChild(e,t){if(t.isLeaf)return wt.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=De&&(o instanceof yi?r=r.concat(o.members):r.push(o))}return yi.from(r)}eq(e){if(!(e instanceof yi)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?Jh(r?t:t.sort($r)):gi}static from(e){switch(e.length){case 0:return De;case 1:return e[0];default:return new yi(e.every(t=>t instanceof wt)?e:e.reduce((t,r)=>t.concat(r instanceof wt?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}};function FM(n,e,t,r,i,o,s){let l=n.slice();for(let u=0,c=o;u<t.maps.length;u++){let f=0;t.maps[u].forEach((d,h,p,m)=>{let S=m-p-(h-d);for(let g=0;g<l.length;g+=3){let y=l[g+1];if(y<0||d>y+c-f)continue;let k=l[g]+c-f;h>=k?l[g+1]=d<=k?-2:-1:d>=c&&S&&(l[g]+=S,l[g+1]+=S)}f+=S}),c=t.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=t.map(n[u]+o),f=c-i;if(f<0||f>=r.content.size){a=!0;continue}let d=t.map(n[u+1]+o,-1),h=d-i,{index:p,offset:m}=r.content.findIndex(f),S=r.maybeChild(p);if(S&&m==f&&m+S.nodeSize==h){let g=l[u+2].mapInner(t,S,c+1,n[u]+o+1,s);g!=De?(l[u]=f,l[u+1]=h,l[u+2]=g):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=LM(l,n,e,t,i,o,s),c=ru(u,r,0,s);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,d=0;f<c.children.length;f+=3){let h=c.children[f];for(;d<l.length&&l[d]<h;)d+=3;l.splice(d,0,c.children[f],c.children[f+1],c.children[f+2])}}return new wt(e.sort($r),l)}function QS(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new co(i.from+e,i.to+e,i.type))}return t}function LM(n,e,t,r,i,o,s){function l(a,u){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(r,i,u);f?t.push(f):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+o+1);return t}function GS(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function YS(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function ru(n,e,t,r){let i=[],o=!1;e.forEach((l,a)=>{let u=GS(n,l,a+t);if(u){o=!0;let c=ru(u,l,t+a+1,r);c!=De&&i.push(a,a+l.nodeSize,c)}});let s=QS(o?YS(n):n,-t).sort($r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new wt(s,i):De}function $r(n,e){return n.from-e.from||n.to-e.to}function Jh(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),ug(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),ug(e,i,r.copy(o.from,r.to)));break}}}return e}function ug(n,e,t){for(;e<n.length&&$r(t,n[e])>0;)e++;n.splice(e,0,t)}const VM=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function BM(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))VM?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function JM(n){let e=Object.create(null);for(let t in n)e[BM(t)]=n[t];return e}function Tc(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function WM(n){let e=JM(n);return function(t,r){let i=Nh(r),o,s=e[Tc(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Tc(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=_t[r.keyCode])&&o!=i){let l=e[Tc(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const XS=65535,ZS=Math.pow(2,16);function KM(n,e){return n+e*ZS}function cg(n){return n&XS}function _M(n){return(n-(n&XS))/ZS}const ek=1,tk=2,Oa=4,nk=8;let qf=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&nk)>0}get deletedBefore(){return(this.delInfo&(ek|Oa))>0}get deletedAfter(){return(this.delInfo&(tk|Oa))>0}get deletedAcross(){return(this.delInfo&Oa)>0}},Br=class Si{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Si.empty)return Si.empty}recover(e){let t=0,r=cg(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+_M(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:c);if(r)return h;let p=e==(t<0?a:f)?null:KM(l/3,e-a),m=e==a?tk:e==f?ek:Oa;return(t<0?e!=a:e!=f)&&(m|=nk),new qf(h,m,p)}i+=c-u}return r?e+i:new qf(e+i,0,null)}touches(e,t){let r=0,i=cg(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new Si(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Si.empty:new Si(e<0?[0,-e,0]:[0,0,e])}};Br.empty=new Br([]);class ms{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new ms(this.maps,this.mirror,e,t)}copy(){return new ms(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new ms;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],l=s.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new qf(e,i,null)}}const bc=Object.create(null);let Me=class{getMap(){return Br.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=bc[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in bc)throw new RangeError("Duplicate use of step JSON ID "+e);return bc[e]=t,t.prototype.jsonID=e,t}},be=class Xo{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Xo(e,null)}static fail(e){return new Xo(null,e)}static fromReplace(e,t,r,i){try{return Xo.ok(e.replace(t,r,i))}catch(o){if(o instanceof Kt)return Xo.fail(o.message);throw o}}};function Wh(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Wh(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}let Kh=class Zo extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(Wh(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return be.fromReplace(e,this.from,this.to,o)}invert(){return new Cl(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Zo(t.pos,r.pos,this.mark)}merge(e){return e instanceof Zo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Zo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Zo(t.from,t.to,e.markFromJSON(t.mark))}};Me.jsonID("addMark",Kh);let Cl=class es extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(Wh(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return be.fromReplace(e,this.from,this.to,r)}invert(){return new Kh(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new es(t.pos,r.pos,this.mark)}merge(e){return e instanceof es&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new es(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new es(t.from,t.to,e.markFromJSON(t.mark))}};Me.jsonID("removeMark",Cl);let _h=class ts extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return be.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new ts(this.pos,t.marks[i]);return new ts(this.pos,this.mark)}}return new Hh(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ts(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ts(t.pos,e.markFromJSON(t.mark))}};Me.jsonID("addNodeMark",_h);let Hh=class jf extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return be.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new _h(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new jf(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new jf(t.pos,e.markFromJSON(t.mark))}};Me.jsonID("removeNodeMark",Hh);let jn=class gr extends Me{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Qf(e,this.from,this.to)?be.fail("Structure replace would overwrite content"):be.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Br([this.from,this.to-this.from,this.slice.size])}invert(e){return new gr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new gr(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof gr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new gr(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new gr(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new gr(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}};Me.jsonID("replace",jn);let fo=class Da extends Me{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Qf(e,this.from,this.gapFrom)||Qf(e,this.gapTo,this.to)))return be.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return be.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?be.fromReplace(e,this.from,this.to,r):be.fail("Content does not fit in gap")}getMap(){return new Br([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Da(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Da(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Da(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}};Me.jsonID("replaceAround",fo);function Qf(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function HM(n,e,t,r){let i=[],o=[],s,l;n.doc.nodesBetween(e,t,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(u,e),h=Math.min(u+a.nodeSize,t),p=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(p)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=h:i.push(s=new Cl(d,h,f[m])));l&&l.to==d?l.to=h:o.push(l=new Kh(d,h,r))}}),i.forEach(a=>n.step(a)),o.forEach(a=>n.step(a))}function UM(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof pl){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,t);for(let c=0;c<a.length;c++){let f=a[c],d;for(let h=0;h<i.length;h++){let p=i[h];p.step==o-1&&f.eq(i[h].style)&&(d=p)}d?(d.to=u,d.step=o):i.push({style:f,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>n.step(new Cl(s.from,s.to,s.style)))}function qM(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),o=[],s=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),u=s+a.nodeSize,c=r.matchType(a.type);if(!c)o.push(new jn(s,u,w.empty));else{r=c;for(let f=0;f<a.marks.length;f++)t.allowsMarkType(a.marks[f].type)||n.step(new Cl(s,u,a.marks[f]));if(a.isText&&!t.spec.code){let f,d=/\r?\n|\r/g,h;for(;f=d.exec(a.text);)h||(h=new w(x.from(t.schema.text(" ",t.allowedMarks(a.marks))),0,0)),o.push(new jn(s+f.index,s+f.index+f[0].length,h))}}s=u}if(!r.validEnd){let l=r.fillBefore(x.empty,!0);n.replace(s,s,new w(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function jM(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=x.empty,f=0;for(let p=o,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,c=x.from(r.node(p).copy(c)),f++):a--;let d=x.empty,h=0;for(let p=o,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,d=x.from(i.node(p).copy(d)),h++):u++;n.step(new fo(a,u,s,l,new w(c.append(d),f,h),c.size-f,!0))}function QM(n,e,t){let r=x.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let l=t[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=x.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new fo(i,o,i,o,new w(r,0,0),t.length,!0))}function GM(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,l)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&YM(n.doc,n.mapping.slice(o).map(l),r)){n.clearIncompatible(n.mapping.slice(o).map(l,1),r);let a=n.mapping.slice(o),u=a.map(l,1),c=a.map(l+s.nodeSize,1);return n.step(new fo(u,c,u+1,c-1,new w(x.from(r.create(i,null,s.marks)),0,0),1,!0)),!1}})}function YM(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function XM(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new fo(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new w(x.from(s),0,0),1,!0))}function ZM(n,e,t=1,r){let i=n.doc.resolve(e),o=x.empty,s=x.empty;for(let l=i.depth,a=i.depth-t,u=t-1;l>a;l--,u--){o=x.from(i.node(l).copy(o));let c=r&&r[u];s=x.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}n.step(new jn(e,e,new w(o.append(s),t,t),!0))}function eO(n,e,t){let r=new jn(e-t,e+t,w.empty,!0);n.step(r)}function tO(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function nO(n,e,t=e,r=w.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return rk(i,o,r)?new jn(e,t,r):new rO(i,o,r).fit()}function rk(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class rO{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=x.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=x.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new w(o,s,l);return e>-1?new fo(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new jn(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Rc(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(x.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Rc(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Rc(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new w(ns(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new w(ns(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let h=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),S=f.matchType(m.type);if(!S)break;u++,(u>1||a==0||m.content.size)&&(f=S,c.push(ik(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?h:-1)))}let p=u==l.childCount;p||(h=-1),this.placed=rs(this.placed,t,x.from(c)),this.frontier[t].match=f,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,S=l;m<h;m++){let g=S.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),S=g.content}this.unplaced=p?e==0?w.empty:new w(ns(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new w(ns(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Ac(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Ac(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Ac(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=rs(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=rs(this.placed,this.depth,x.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(x.empty,!0);t.childCount&&(this.placed=rs(this.placed,this.frontier.length,t))}}function ns(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(ns(n.firstChild.content,e-1,t)))}function rs(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(rs(n.lastChild.content,e-1,t)))}function Rc(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function ik(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,ik(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(x.empty,!0)))),n.copy(r)}function Ac(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!iO(t,o.content,s)?l:null}function iO(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function oO(n){return n.spec.defining||n.spec.definingForContent}function sO(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(rk(i,o,r))return n.step(new jn(e,t,r));let s=sk(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let d=i.depth,h=i.pos-1;d>0;d--,h--){let p=i.node(d).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;s.indexOf(d)>-1?l=d:i.before(d)==h&&s.splice(1,0,-d)}let a=s.indexOf(l),u=[],c=r.openStart;for(let d=r.content,h=0;;h++){let p=d.firstChild;if(u.push(p),h==r.openStart)break;d=p.content}for(let d=c-1;d>=0;d--){let h=u[d],p=oO(h.type);if(p&&!h.sameMarkup(i.node(Math.abs(l)-1)))c=d;else if(p||!h.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let h=(d+c+1)%(r.openStart+1),p=u[h];if(p)for(let m=0;m<s.length;m++){let S=s[(m+a)%s.length],g=!0;S<0&&(g=!1,S=-S);let y=i.node(S-1),k=i.index(S-1);if(y.canReplaceWith(k,k,p.type,p.marks))return n.replace(i.before(S),g?o.after(S):t,new w(ok(r.content,0,r.openStart,h),h,r.openEnd))}}let f=n.steps.length;for(let d=s.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let h=s[d];h<0||(e=i.before(h),t=o.after(h))}}function ok(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(ok(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(x.empty,!0))}return n}function lO(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=tO(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new w(x.from(r),0,0))}function aO(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=sk(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function sk(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}let lk=class Ta extends Me{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return be.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return be.fromReplace(e,this.pos,this.pos+1,new w(x.from(i),0,t.isLeaf?0:1))}getMap(){return Br.empty}invert(e){return new Ta(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ta(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ta(t.pos,t.attr,t.value)}};Me.jsonID("attr",lk);class Ls extends Me{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return be.ok(r)}getMap(){return Br.empty}invert(e){return new Ls(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ls(t.attr,t.value)}}Me.jsonID("docAttr",Ls);let Yi=class extends Error{};Yi=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Yi.prototype=Object.create(Error.prototype);Yi.prototype.constructor=Yi;Yi.prototype.name="TransformError";class uO{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ms}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Yi(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=w.empty){let i=nO(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new w(x.from(r),0,0))}delete(e,t){return this.replace(e,t,w.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return sO(this,e,t,r),this}replaceRangeWith(e,t,r){return lO(this,e,t,r),this}deleteRange(e,t){return aO(this,e,t),this}lift(e,t){return jM(this,e,t),this}join(e,t=1){return eO(this,e,t),this}wrap(e,t){return QM(this,e,t),this}setBlockType(e,t=e,r,i=null){return GM(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return XM(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new lk(e,t,r)),this}setDocAttribute(e,t){return this.step(new Ls(e,t)),this}addNodeMark(e,t){return this.step(new _h(e,t)),this}removeNodeMark(e,t){if(!(t instanceof W)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Hh(e,t)),this}split(e,t=1,r){return ZM(this,e,t,r),this}addMark(e,t,r){return HM(this,e,t,r),this}removeMark(e,t,r){return UM(this,e,t,r),this}clearIncompatible(e,t,r){return qM(this,e,t,r),this}}var Gf,Yf;if(typeof WeakMap<"u"){let n=new WeakMap;Gf=e=>n.get(e),Yf=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;Gf=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},Yf=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var ne=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let o=r+1,s=i+1;for(let l=1;o<this.width&&this.map[e+l]==t;l++)o++;for(let l=1;s<this.height&&this.map[e+this.width*l]==t;l++)s++;return{left:r,top:i,right:o,bottom:s}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:i,top:o,bottom:s}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[o*this.width+(t<0?r-1:i)]:(t<0?o==0:s==this.height)?null:this.map[r+this.width*(t<0?o-1:s)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:o}=this.findCell(n),{left:s,right:l,top:a,bottom:u}=this.findCell(e);return{left:Math.min(t,s),top:Math.min(i,a),right:Math.max(r,l),bottom:Math.max(o,u)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const o=r*this.width+i,s=this.map[o];t[s]||(t[s]=!0,!(i==n.left&&i&&this.map[o-1]==s||r==n.top&&r&&this.map[o-this.width]==s)&&e.push(s))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const o=i+t.child(r).nodeSize;if(r==n){let s=e+n*this.width;const l=(n+1)*this.width;for(;s<l&&this.map[s]<i;)s++;return s==l?o-1:this.map[s]}i=o}}static get(n){return Gf(n)||Yf(n,cO(n))}};function cO(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=fO(n),t=n.childCount,r=[];let i=0,o=null;const s=[];for(let u=0,c=e*t;u<c;u++)r[u]=0;for(let u=0,c=0;u<t;u++){const f=n.child(u);c++;for(let p=0;;p++){for(;i<r.length&&r[i]!=0;)i++;if(p==f.childCount)break;const m=f.child(p),{colspan:S,rowspan:g,colwidth:y}=m.attrs;for(let k=0;k<g;k++){if(k+u>=t){(o||(o=[])).push({type:"overlong_rowspan",pos:c,n:g-k});break}const N=i+k*e;for(let E=0;E<S;E++){r[N+E]==0?r[N+E]=c:(o||(o=[])).push({type:"collision",row:u,pos:c,n:S-E});const v=y&&y[E];if(v){const D=(N+E)%e*2,T=s[D];T==null||T!=v&&s[D+1]==1?(s[D]=v,s[D+1]=1):T==v&&s[D+1]++}}}i+=S,c+=m.nodeSize}const d=(u+1)*e;let h=0;for(;i<d;)r[i++]==0&&h++;h&&(o||(o=[])).push({type:"missing",row:u,n:h}),c++}const l=new ne(e,t,r,o);let a=!1;for(let u=0;!a&&u<s.length;u+=2)s[u]!=null&&s[u+1]<t&&(a=!0);return a&&dO(l,s,n),l}function fO(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let o=0;if(t)for(let s=0;s<r;s++){const l=n.child(s);for(let a=0;a<l.childCount;a++){const u=l.child(a);s+u.attrs.rowspan>r&&(o+=u.attrs.colspan)}}for(let s=0;s<i.childCount;s++){const l=i.child(s);o+=l.attrs.colspan,l.attrs.rowspan>1&&(t=!0)}e==-1?e=o:e!=o&&(e=Math.max(e,o))}return e}function dO(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const o=n.map[i];if(r[o])continue;r[o]=!0;const s=t.nodeAt(o);if(!s)throw new RangeError(`No cell with offset ${o} found`);let l=null;const a=s.attrs;for(let u=0;u<a.colspan;u++){const c=(i+u)%n.width,f=e[c*2];f!=null&&(!a.colwidth||a.colwidth[u]!=f)&&((l||(l=hO(a)))[u]=f)}l&&n.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:l})}}function hO(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function fg(n,e){if(typeof n=="string")return{};const t=n.getAttribute("data-colwidth"),r=t&&/^\d+(,\d+)*$/.test(t)?t.split(",").map(s=>Number(s)):null,i=Number(n.getAttribute("colspan")||1),o={colspan:i,rowspan:Number(n.getAttribute("rowspan")||1),colwidth:r&&r.length==i?r:null};for(const s in e){const l=e[s].getFromDOM,a=l&&l(n);a!=null&&(o[s]=a)}return o}function dg(n,e){const t={};n.attrs.colspan!=1&&(t.colspan=n.attrs.colspan),n.attrs.rowspan!=1&&(t.rowspan=n.attrs.rowspan),n.attrs.colwidth&&(t["data-colwidth"]=n.attrs.colwidth.join(","));for(const r in e){const i=e[r].setDOMAttr;i&&i(n.attrs[r],t)}return t}function pO(n){const e=n.cellAttributes||{},t={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(const r in e)t[r]={default:e[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:n.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:n.cellContent,attrs:t,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:r=>fg(r,e)}],toDOM(r){return["td",dg(r,e),0]}},table_header:{content:n.cellContent,attrs:t,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:r=>fg(r,e)}],toDOM(r){return["th",dg(r,e),0]}}}}function qt(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var Dn=new gl("selectingCells");function Nl(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function Uh(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function ak(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=Nl(e.$head)||mO(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function mO(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function Xf(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function qh(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function uk(n,e,t){const r=n.node(-1),i=ne.get(r),o=n.start(-1),s=i.nextCell(n.pos-o,e,t);return s==null?null:n.node(0).resolve(o+s)}function Xi(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}var ce=class tn extends z{constructor(e,t=e){const r=e.node(-1),i=ne.get(r),o=e.start(-1),s=i.rectBetween(e.pos-o,t.pos-o),l=e.node(0),a=i.cellsInRect(s).filter(c=>c!=t.pos-o);a.unshift(t.pos-o);const u=a.map(c=>{const f=r.nodeAt(c);if(!f)throw RangeError(`No cell with offset ${c} found`);const d=o+c+1;return new S1(l.resolve(d),l.resolve(d+f.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(Xf(r)&&Xf(i)&&qh(r,i)){const o=this.$anchorCell.node(-1)!=r.node(-1);return o&&this.isRowSelection()?tn.rowSelection(r,i):o&&this.isColSelection()?tn.colSelection(r,i):new tn(r,i)}return $.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=ne.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},s=[];for(let a=i.top;a<i.bottom;a++){const u=[];for(let c=a*t.width+i.left,f=i.left;f<i.right;f++,c++){const d=t.map[c];if(o[d])continue;o[d]=!0;const h=t.findCell(d);let p=e.nodeAt(d);if(!p)throw RangeError(`No cell with offset ${d} found`);const m=i.left-h.left,S=h.right-i.right;if(m>0||S>0){let g=p.attrs;if(m>0&&(g=Xi(g,0,m)),S>0&&(g=Xi(g,g.colspan-S,S)),h.left<i.left){if(p=p.type.createAndFill(g),!p)throw RangeError(`Could not create cell with attrs ${JSON.stringify(g)}`)}else p=p.type.create(g,p.content)}if(h.top<i.top||h.bottom>i.bottom){const g={...p.attrs,rowspan:Math.min(h.bottom,i.bottom)-Math.max(h.top,i.top)};h.top<i.top?p=p.type.createAndFill(g):p=p.type.create(g,p.content)}u.push(p)}s.push(e.child(a).copy(x.from(u)))}const l=this.isColSelection()&&this.isRowSelection()?e:s;return new w(x.from(l),1,1)}replace(e,t=w.empty){const r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){const{$from:l,$to:a}=i[s],u=e.mapping.slice(r);e.replace(u.map(l.pos),u.map(a.pos),s?w.empty:t)}const o=z.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new w(x.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=ne.get(t),i=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let s=0;s<o.length;s++)e(t.nodeAt(o[s]),i+o[s])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=ne.get(r),o=e.start(-1),s=i.findCell(e.pos-o),l=i.findCell(t.pos-o),a=e.node(0);return s.top<=l.top?(s.top>0&&(e=a.resolve(o+i.map[s.left])),l.bottom<i.height&&(t=a.resolve(o+i.map[i.width*(i.height-1)+l.right-1]))):(l.top>0&&(t=a.resolve(o+i.map[l.left])),s.bottom<i.height&&(e=a.resolve(o+i.map[i.width*(i.height-1)+s.right-1]))),new tn(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=ne.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),o=t.colCount(this.$headCell.pos-r);if(Math.min(i,o)>0)return!1;const s=i+this.$anchorCell.nodeAfter.attrs.colspan,l=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(s,l)==t.width}eq(e){return e instanceof tn&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=ne.get(r),o=e.start(-1),s=i.findCell(e.pos-o),l=i.findCell(t.pos-o),a=e.node(0);return s.left<=l.left?(s.left>0&&(e=a.resolve(o+i.map[s.top*i.width])),l.right<i.width&&(t=a.resolve(o+i.map[i.width*(l.top+1)-1]))):(l.left>0&&(t=a.resolve(o+i.map[l.top*i.width])),s.right<i.width&&(e=a.resolve(o+i.map[i.width*(s.top+1)-1]))),new tn(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new tn(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new tn(e.resolve(t),e.resolve(r))}getBookmark(){return new gO(this.$anchorCell.pos,this.$headCell.pos)}};ce.prototype.visible=!1;z.jsonID("cell",ce);var gO=class ck{constructor(e,t){this.anchor=e,this.head=t}map(e){return new ck(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&qh(t,r)?new ce(t,r):z.near(r,1)}};function yO(n){if(!(n.selection instanceof ce))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(co.node(r,r+t.nodeSize,{class:"selectedCell"}))}),wt.create(n.doc,e)}function SO({$from:n,$to:e}){if(n.pos==e.pos||n.pos<n.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let o=e.depth;o>=0&&!(e.before(o+1)>e.start(o));o--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function kO({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const o=n.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){t=o;break}}for(let i=e.depth;i>0;i--){const o=e.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}return t!==r&&e.parentOffset===0}function wO(n,e,t){const r=(e||n).selection,i=(e||n).doc;let o,s;if(r instanceof O&&(s=r.node.type.spec.tableRole)){if(s=="cell"||s=="header_cell")o=ce.create(i,r.from);else if(s=="row"){const l=i.resolve(r.from+1);o=ce.rowSelection(l,l)}else if(!t){const l=ne.get(r.node),a=r.from+1,u=a+l.map[l.width*l.height-1];o=ce.create(i,a+1,u)}}else r instanceof $&&SO(r)?o=$.create(i,r.from):r instanceof $&&kO(r)&&(o=$.create(i,r.$from.start(),r.$from.end()));return o&&(e||(e=n.tr)).setSelection(o),e}var xO=new gl("fix-tables");function fk(n,e,t,r){const i=n.childCount,o=e.childCount;e:for(let s=0,l=0;s<o;s++){const a=e.child(s);for(let u=l,c=Math.min(i,s+3);u<c;u++)if(n.child(u)==a){l=u+1,t+=a.nodeSize;continue e}r(a,t),l<i&&n.child(l).sameMarkup(a)?fk(n.child(l),a,t+1,r):a.nodesBetween(0,a.content.size,r,t+1),t+=a.nodeSize}}function CO(n,e){let t;const r=(i,o)=>{i.type.spec.tableRole=="table"&&(t=NO(n,i,o,t))};return e?e.doc!=n.doc&&fk(e.doc,n.doc,0,r):n.doc.descendants(r),t}function NO(n,e,t,r){const i=ne.get(e);if(!i.problems)return r;r||(r=n.tr);const o=[];for(let a=0;a<i.height;a++)o.push(0);for(let a=0;a<i.problems.length;a++){const u=i.problems[a];if(u.type=="collision"){const c=e.nodeAt(u.pos);if(!c)continue;const f=c.attrs;for(let d=0;d<f.rowspan;d++)o[u.row+d]+=u.n;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,Xi(f,f.colspan-u.n,u.n))}else if(u.type=="missing")o[u.row]+=u.n;else if(u.type=="overlong_rowspan"){const c=e.nodeAt(u.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,{...c.attrs,rowspan:c.attrs.rowspan-u.n})}else if(u.type=="colwidth mismatch"){const c=e.nodeAt(u.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,{...c.attrs,colwidth:u.colwidth})}}let s,l;for(let a=0;a<o.length;a++)o[a]&&(s==null&&(s=a),l=a);for(let a=0,u=t+1;a<i.height;a++){const c=e.child(a),f=u+c.nodeSize,d=o[a];if(d>0){let h="cell";c.firstChild&&(h=c.firstChild.type.spec.tableRole);const p=[];for(let S=0;S<d;S++){const g=qt(n.schema)[h].createAndFill();g&&p.push(g)}const m=(a==0||s==a-1)&&l==a?u+1:f-1;r.insert(r.mapping.map(m),p)}u=f}return r.setMeta(xO,{fixTables:!0})}function vO(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),o=i.type.spec.tableRole,s=i.type.schema,l=[];if(o=="row")for(let a=0;a<e.childCount;a++){let u=e.child(a).content;const c=a?0:Math.max(0,t-1),f=a<e.childCount-1?0:Math.max(0,r-1);(c||f)&&(u=Zf(qt(s).row,new w(u,c,f)).content),l.push(u)}else if(o=="cell"||o=="header_cell")l.push(t||r?Zf(qt(s).row,new w(e,t,r)).content:e);else return null;return EO(s,l)}function EO(n,e){const t=[];for(let i=0;i<e.length;i++){const o=e[i];for(let s=o.childCount-1;s>=0;s--){const{rowspan:l,colspan:a}=o.child(s).attrs;for(let u=i;u<i+l;u++)t[u]=(t[u]||0)+a}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(x.empty),t[i]<r){const o=qt(n).cell.createAndFill(),s=[];for(let l=t[i];l<r;l++)s.push(o);e[i]=e[i].append(x.from(s))}return{height:e.length,width:r,rows:e}}function Zf(n,e){const t=n.createAndFill();return new uO(t).replace(0,t.content.size,e).doc}function MO({width:n,height:e,rows:t},r,i){if(n!=r){const o=[],s=[];for(let l=0;l<t.length;l++){const a=t[l],u=[];for(let c=o[l]||0,f=0;c<r;f++){let d=a.child(f%a.childCount);c+d.attrs.colspan>r&&(d=d.type.createChecked(Xi(d.attrs,d.attrs.colspan,c+d.attrs.colspan-r),d.content)),u.push(d),c+=d.attrs.colspan;for(let h=1;h<d.attrs.rowspan;h++)o[l+h]=(o[l+h]||0)+d.attrs.colspan}s.push(x.from(u))}t=s,n=r}if(e!=i){const o=[];for(let s=0,l=0;s<i;s++,l++){const a=[],u=t[l%e];for(let c=0;c<u.childCount;c++){let f=u.child(c);s+f.attrs.rowspan>i&&(f=f.type.create({...f.attrs,rowspan:Math.max(1,i-f.attrs.rowspan)},f.content)),a.push(f)}o.push(x.from(a))}t=o,e=i}return{width:n,height:e,rows:t}}function OO(n,e,t,r,i,o,s){const l=n.doc.type.schema,a=qt(l);let u,c;if(i>e.width)for(let f=0,d=0;f<e.height;f++){const h=t.child(f);d+=h.nodeSize;const p=[];let m;h.lastChild==null||h.lastChild.type==a.cell?m=u||(u=a.cell.createAndFill()):m=c||(c=a.header_cell.createAndFill());for(let S=e.width;S<i;S++)p.push(m);n.insert(n.mapping.slice(s).map(d-1+r),p)}if(o>e.height){const f=[];for(let p=0,m=(e.height-1)*e.width;p<Math.max(e.width,i);p++){const S=p>=e.width?!1:t.nodeAt(e.map[m+p]).type==a.header_cell;f.push(S?c||(c=a.header_cell.createAndFill()):u||(u=a.cell.createAndFill()))}const d=a.row.create(null,x.from(f)),h=[];for(let p=e.height;p<o;p++)h.push(d);n.insert(n.mapping.slice(s).map(r+t.nodeSize-2),h)}return!!(u||c)}function hg(n,e,t,r,i,o,s,l){if(s==0||s==e.height)return!1;let a=!1;for(let u=i;u<o;u++){const c=s*e.width+u,f=e.map[c];if(e.map[c-e.width]==f){a=!0;const d=t.nodeAt(f),{top:h,left:p}=e.findCell(f);n.setNodeMarkup(n.mapping.slice(l).map(f+r),null,{...d.attrs,rowspan:s-h}),n.insert(n.mapping.slice(l).map(e.positionAt(s,p,t)),d.type.createAndFill({...d.attrs,rowspan:h+d.attrs.rowspan-s})),u+=d.attrs.colspan-1}}return a}function pg(n,e,t,r,i,o,s,l){if(s==0||s==e.width)return!1;let a=!1;for(let u=i;u<o;u++){const c=u*e.width+s,f=e.map[c];if(e.map[c-1]==f){a=!0;const d=t.nodeAt(f),h=e.colCount(f),p=n.mapping.slice(l).map(f+r);n.setNodeMarkup(p,null,Xi(d.attrs,s-h,d.attrs.colspan-(s-h))),n.insert(p+d.nodeSize,d.type.createAndFill(Xi(d.attrs,0,s-h))),u+=d.attrs.rowspan-1}}return a}function mg(n,e,t,r,i){let o=t?n.doc.nodeAt(t-1):n.doc;if(!o)throw new Error("No table found");let s=ne.get(o);const{top:l,left:a}=r,u=a+i.width,c=l+i.height,f=n.tr;let d=0;function h(){if(o=t?f.doc.nodeAt(t-1):f.doc,!o)throw new Error("No table found");s=ne.get(o),d=f.mapping.maps.length}OO(f,s,o,t,u,c,d)&&h(),hg(f,s,o,t,a,u,l,d)&&h(),hg(f,s,o,t,a,u,c,d)&&h(),pg(f,s,o,t,l,c,a,d)&&h(),pg(f,s,o,t,l,c,u,d)&&h();for(let p=l;p<c;p++){const m=s.positionAt(p,a,o),S=s.positionAt(p,u,o);f.replace(f.mapping.slice(d).map(m+t),f.mapping.slice(d).map(S+t),new w(i.rows[p-l],0,0))}h(),f.setSelection(new ce(f.doc.resolve(t+s.positionAt(l,a,o)),f.doc.resolve(t+s.positionAt(c-1,u-1,o)))),e(f)}var DO=WM({ArrowLeft:Vl("horiz",-1),ArrowRight:Vl("horiz",1),ArrowUp:Vl("vert",-1),ArrowDown:Vl("vert",1),"Shift-ArrowLeft":Bl("horiz",-1),"Shift-ArrowRight":Bl("horiz",1),"Shift-ArrowUp":Bl("vert",-1),"Shift-ArrowDown":Bl("vert",1),Backspace:Jl,"Mod-Backspace":Jl,Delete:Jl,"Mod-Delete":Jl});function ba(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function Vl(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;if(o instanceof ce)return ba(t,r,z.near(o.$headCell,e));if(n!="horiz"&&!o.empty)return!1;const s=dk(i,n,e);if(s==null)return!1;if(n=="horiz")return ba(t,r,z.near(t.doc.resolve(o.head+e),e));{const l=t.doc.resolve(s),a=uk(l,n,e);let u;return a?u=z.near(a,1):e<0?u=z.near(t.doc.resolve(l.before(-1)),-1):u=z.near(t.doc.resolve(l.after(-1)),1),ba(t,r,u)}}}function Bl(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;let s;if(o instanceof ce)s=o;else{const a=dk(i,n,e);if(a==null)return!1;s=new ce(t.doc.resolve(a))}const l=uk(s.$headCell,n,e);return l?ba(t,r,new ce(s.$anchorCell,l)):!1}}function Jl(n,e){const t=n.selection;if(!(t instanceof ce))return!1;if(e){const r=n.tr,i=qt(n.schema).cell.createAndFill().content;t.forEachCell((o,s)=>{o.content.eq(i)||r.replace(r.mapping.map(s+1),r.mapping.map(s+o.nodeSize-1),new w(i,0,0))}),r.docChanged&&e(r)}return!0}function TO(n,e){const t=n.state.doc,r=Nl(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new ce(r))),!0):!1}function bO(n,e,t){if(!Uh(n.state))return!1;let r=vO(t);const i=n.state.selection;if(i instanceof ce){r||(r={width:1,height:1,rows:[x.from(Zf(qt(n.state.schema).cell,t))]});const o=i.$anchorCell.node(-1),s=i.$anchorCell.start(-1),l=ne.get(o).rectBetween(i.$anchorCell.pos-s,i.$headCell.pos-s);return r=MO(r,l.right-l.left,l.bottom-l.top),mg(n.state,n.dispatch,s,l,r),!0}else if(r){const o=ak(n.state),s=o.start(-1);return mg(n.state,n.dispatch,s,ne.get(o.node(-1)).findCell(o.pos-s),r),!0}else return!1}function RO(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=gg(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof ce)o(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=Nl(n.state.selection.$anchor))!=null&&((t=$c(n,e))==null?void 0:t.pos)!=i.pos)o(i,e),e.preventDefault();else if(!r)return;function o(a,u){let c=$c(n,u);const f=Dn.getState(n.state)==null;if(!c||!qh(a,c))if(f)c=a;else return;const d=new ce(a,c);if(f||!n.state.selection.eq(d)){const h=n.state.tr.setSelection(d);f&&h.setMeta(Dn,a.pos),n.dispatch(h)}}function s(){n.root.removeEventListener("mouseup",s),n.root.removeEventListener("dragstart",s),n.root.removeEventListener("mousemove",l),Dn.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(Dn,-1))}function l(a){const u=a,c=Dn.getState(n.state);let f;if(c!=null)f=n.state.doc.resolve(c);else if(gg(n,u.target)!=r&&(f=$c(n,e),!f))return s();f&&o(f,u)}n.root.addEventListener("mouseup",s),n.root.addEventListener("dragstart",s),n.root.addEventListener("mousemove",l)}function dk(n,e,t){if(!(n.state.selection instanceof $))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const o=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){const l=r.before(i),a=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(a)?l:null}}return null}function gg(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function $c(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?Nl(n.state.doc.resolve(t.pos)):null}var AO=class{constructor(n,e){this.node=n,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ed(n,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type!=this.node.type?!1:(this.node=n,ed(n,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(n){return n.type=="attributes"&&(n.target==this.table||this.colgroup.contains(n.target))}};function ed(n,e,t,r,i,o){var s;let l=0,a=!0,u=e.firstChild;const c=n.firstChild;if(c){for(let f=0,d=0;f<c.childCount;f++){const{colspan:h,colwidth:p}=c.child(f).attrs;for(let m=0;m<h;m++,d++){const S=i==d?o:p&&p[m],g=S?S+"px":"";l+=S||r,S||(a=!1),u?(u.style.width!=g&&(u.style.width=g),u=u.nextSibling):e.appendChild(document.createElement("col")).style.width=g}}for(;u;){const f=u.nextSibling;(s=u.parentNode)==null||s.removeChild(u),u=f}a?(t.style.width=l+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=l+"px")}}var gt=new gl("tableColumnResizing");function $O({handleWidth:n=5,cellMinWidth:e=25,View:t=AO,lastColumnResizable:r=!0}={}){const i=new Xt({key:gt,state:{init(o,s){return i.spec.props.nodeViews[qt(s.schema).table.name]=(l,a)=>new t(l,e,a),new IO(-1,!1)},apply(o,s){return s.apply(o)}},props:{attributes:o=>{const s=gt.getState(o);return s&&s.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,s)=>{zO(o,s,n,e,r)},mouseleave:o=>{PO(o)},mousedown:(o,s)=>{FO(o,s,e)}},decorations:o=>{const s=gt.getState(o);if(s&&s.activeHandle>-1)return KO(o,s.activeHandle)},nodeViews:{}}});return i}var IO=class Ra{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(gt);if(r&&r.setHandle!=null)return new Ra(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new Ra(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return Xf(e.doc.resolve(i))||(i=-1),new Ra(i,t.dragging)}return t}};function zO(n,e,t,r,i){const o=gt.getState(n.state);if(o&&!o.dragging){const s=VO(e.target);let l=-1;if(s){const{left:a,right:u}=s.getBoundingClientRect();e.clientX-a<=t?l=yg(n,e,"left",t):u-e.clientX<=t&&(l=yg(n,e,"right",t))}if(l!=o.activeHandle){if(!i&&l!==-1){const a=n.state.doc.resolve(l),u=a.node(-1),c=ne.get(u),f=a.start(-1);if(c.colCount(a.pos-f)+a.nodeAfter.attrs.colspan-1==c.width-1)return}hk(n,l)}}}function PO(n){const e=gt.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&hk(n,-1)}function FO(n,e,t){var r;const i=(r=n.dom.ownerDocument.defaultView)!=null?r:window,o=gt.getState(n.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const s=n.state.doc.nodeAt(o.activeHandle),l=LO(n,o.activeHandle,s.attrs);n.dispatch(n.state.tr.setMeta(gt,{setDragging:{startX:e.clientX,startWidth:l}}));function a(c){i.removeEventListener("mouseup",a),i.removeEventListener("mousemove",u);const f=gt.getState(n.state);f!=null&&f.dragging&&(BO(n,f.activeHandle,Sg(f.dragging,c,t)),n.dispatch(n.state.tr.setMeta(gt,{setDragging:null})))}function u(c){if(!c.which)return a(c);const f=gt.getState(n.state);if(f&&f.dragging){const d=Sg(f.dragging,c,t);JO(n,f.activeHandle,d,t)}}return i.addEventListener("mouseup",a),i.addEventListener("mousemove",u),e.preventDefault(),!0}function LO(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const o=n.domAtPos(e);let l=o.node.childNodes[o.offset].offsetWidth,a=t;if(r)for(let u=0;u<t;u++)r[u]&&(l-=r[u],a--);return l/a}function VO(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function yg(n,e,t,r){const i=t=="right"?-r:r,o=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!o)return-1;const{pos:s}=o,l=Nl(n.state.doc.resolve(s));if(!l)return-1;if(t=="right")return l.pos;const a=ne.get(l.node(-1)),u=l.start(-1),c=a.map.indexOf(l.pos-u);return c%a.width==0?-1:u+a.map[c-1]}function Sg(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function hk(n,e){n.dispatch(n.state.tr.setMeta(gt,{setHandle:e}))}function BO(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),o=ne.get(i),s=r.start(-1),l=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,a=n.state.tr;for(let u=0;u<o.height;u++){const c=u*o.width+l;if(u&&o.map[c]==o.map[c-o.width])continue;const f=o.map[c],d=i.nodeAt(f).attrs,h=d.colspan==1?0:l-o.colCount(f);if(d.colwidth&&d.colwidth[h]==t)continue;const p=d.colwidth?d.colwidth.slice():WO(d.colspan);p[h]=t,a.setNodeMarkup(s+f,null,{...d,colwidth:p})}a.docChanged&&n.dispatch(a)}function JO(n,e,t,r){const i=n.state.doc.resolve(e),o=i.node(-1),s=i.start(-1),l=ne.get(o).colCount(i.pos-s)+i.nodeAfter.attrs.colspan-1;let a=n.domAtPos(i.start(-1)).node;for(;a&&a.nodeName!="TABLE";)a=a.parentNode;a&&ed(o,a.firstChild,a,r,l,t)}function WO(n){return Array(n).fill(0)}function KO(n,e){const t=[],r=n.doc.resolve(e),i=r.node(-1);if(!i)return wt.empty;const o=ne.get(i),s=r.start(-1),l=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan;for(let a=0;a<o.height;a++){const u=l+a*o.width-1;if((l==o.width||o.map[u]!=o.map[u+1])&&(a==0||o.map[u]!=o.map[u-o.width])){const c=o.map[u],f=s+c+i.nodeAt(c).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",t.push(co.widget(f,d))}}return wt.create(n.doc,t)}function pk(n){const e=n.selection,t=ak(n),r=t.node(-1),i=t.start(-1),o=ne.get(r);return{...e instanceof ce?o.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):o.findCell(t.pos-i),tableStart:i,map:o,table:r}}function _O(n){return function(e,t){if(!Uh(e))return!1;if(t){const r=qt(e.schema),i=pk(e),o=e.tr,s=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),l=s.map(a=>i.table.nodeAt(a));for(let a=0;a<s.length;a++)l[a].type==r.header_cell&&o.setNodeMarkup(i.tableStart+s[a],r.cell,l[a].attrs);if(o.steps.length==0)for(let a=0;a<s.length;a++)o.setNodeMarkup(i.tableStart+s[a],r.header_cell,l[a].attrs);t(o)}return!0}}function kg(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const o=e.table.nodeAt(r[i]);if(o&&o.type!==t.header_cell)return!1}return!0}function jh(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?_O(n):function(t,r){if(!Uh(t))return!1;if(r){const i=qt(t.schema),o=pk(t),s=t.tr,l=kg("row",o,i),a=kg("column",o,i),c=(n==="column"?l:n==="row"?a:!1)?1:0,f=n=="column"?{left:0,top:c,right:1,bottom:o.map.height}:n=="row"?{left:c,top:0,right:o.map.width,bottom:1}:o,d=n=="column"?a?i.cell:i.header_cell:n=="row"?l?i.cell:i.header_cell:i.cell;o.map.cellsInRect(f).forEach(h=>{const p=h+o.tableStart,m=s.doc.nodeAt(p);m&&s.setNodeMarkup(p,d,m.attrs)}),r(s)}return!0}}jh("row",{useDeprecatedLogic:!0});jh("column",{useDeprecatedLogic:!0});jh("cell",{useDeprecatedLogic:!0});function HO({allowTableNodeSelection:n=!1}={}){return new Xt({key:Dn,state:{init(){return null},apply(e,t){const r=e.getMeta(Dn);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:o}=e.mapping.mapResult(t);return i?null:o}},props:{decorations:yO,handleDOMEvents:{mousedown:RO},createSelectionBetween(e){return Dn.getState(e.state)!=null?e.state.selection:null},handleTripleClick:TO,handleKeyDown:DO,handlePaste:bO},appendTransaction(e,t,r){return wO(r,CO(r,t),n)}})}const mk=65535,gk=Math.pow(2,16);function UO(n,e){return n+e*gk}function wg(n){return n&mk}function qO(n){return(n-(n&mk))/gk}const yk=1,Sk=2,Aa=4,kk=8;class xg{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&kk)>0}get deletedBefore(){return(this.delInfo&(yk|Aa))>0}get deletedAfter(){return(this.delInfo&(Sk|Aa))>0}get deletedAcross(){return(this.delInfo&Aa)>0}}class yt{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&yt.empty)return yt.empty}recover(e){let t=0,r=wg(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+qO(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,h=a+i+(d<0?0:c);if(r)return h;let p=e==(t<0?a:f)?null:UO(l/3,e-a),m=e==a?Sk:e==f?yk:Aa;return(t<0?e!=a:e!=f)&&(m|=kk),new xg(h,m,p)}i+=c-u}return r?e+i:new xg(e+i,0,null)}touches(e,t){let r=0,i=wg(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new yt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?yt.empty:new yt(e<0?[0,-e,0]:[0,0,e])}}yt.empty=new yt([]);const Ic=Object.create(null);class tt{getMap(){return yt.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ic[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ic)throw new RangeError("Duplicate use of step JSON ID "+e);return Ic[e]=t,t.prototype.jsonID=e,t}}class oe{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new oe(e,null)}static fail(e){return new oe(null,e)}static fromReplace(e,t,r,i){try{return oe.ok(e.replace(t,r,i))}catch(o){if(o instanceof Kt)return oe.fail(o.message);throw o}}}function Qh(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Qh(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}class wr extends tt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new w(Qh(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return oe.fromReplace(e,this.from,this.to,o)}invert(){return new xr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new wr(t.pos,r.pos,this.mark)}merge(e){return e instanceof wr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new wr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new wr(t.from,t.to,e.markFromJSON(t.mark))}}tt.jsonID("addMark",wr);class xr extends tt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new w(Qh(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return oe.fromReplace(e,this.from,this.to,r)}invert(){return new wr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new xr(t.pos,r.pos,this.mark)}merge(e){return e instanceof xr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new xr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new xr(t.from,t.to,e.markFromJSON(t.mark))}}tt.jsonID("removeMark",xr);class Cr extends tt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return oe.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Cr(this.pos,t.marks[i]);return new Cr(this.pos,this.mark)}}return new Vs(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Cr(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Cr(t.pos,e.markFromJSON(t.mark))}}tt.jsonID("addNodeMark",Cr);class Vs extends tt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return oe.fromReplace(e,this.pos,this.pos+1,new w(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Cr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Vs(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Vs(t.pos,e.markFromJSON(t.mark))}}tt.jsonID("removeNodeMark",Vs);class Nn extends tt{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&td(e,this.from,this.to)?oe.fail("Structure replace would overwrite content"):oe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new yt([this.from,this.to-this.from,this.slice.size])}invert(e){return new Nn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Nn(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Nn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Nn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Nn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Nn(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}}tt.jsonID("replace",Nn);class gs extends tt{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(td(e,this.from,this.gapFrom)||td(e,this.gapTo,this.to)))return oe.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return oe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?oe.fromReplace(e,this.from,this.to,r):oe.fail("Content does not fit in gap")}getMap(){return new yt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new gs(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new gs(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new gs(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}}tt.jsonID("replaceAround",gs);function td(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function jO(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(a,a,i);else{let f=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(a,a,f[0])}if(c)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}class ys extends tt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return oe.fromReplace(e,this.pos,this.pos+1,new w(x.from(i),0,t.isLeaf?0:1))}getMap(){return yt.empty}invert(e){return new ys(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ys(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ys(t.pos,t.attr,t.value)}}tt.jsonID("attr",ys);let Bs=class extends Error{};Bs=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Bs.prototype=Object.create(Error.prototype);Bs.prototype.constructor=Bs;Bs.prototype.name="TransformError";const ge=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Js=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let nd=null;const nn=function(n,e,t){let r=nd||(nd=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},QO=function(){nd=null},Jr=function(n,e,t,r){return t&&(Cg(n,e,t,r,-1)||Cg(n,e,t,r,1))},GO=/^(img|br|input|textarea|hr)$/i;function Cg(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:St(n))){let o=n.parentNode;if(!o||o.nodeType!=1||vl(n)||GO.test(n.nodeName)||n.contentEditable=="false")return!1;e=ge(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?St(n):0}else return!1}}function St(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function YO(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=St(n)}else if(n.parentNode&&!vl(n))e=ge(n),n=n.parentNode;else return null}}function XO(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!vl(n))e=ge(n)+1,n=n.parentNode;else return null}}function ZO(n,e,t){for(let r=e==0,i=e==St(n);r||i;){if(n==t)return!0;let o=ge(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==St(n)}}function vl(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Ku=function(n){return n.focusNode&&Jr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function kr(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function eD(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function tD(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(St(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(St(r.startContainer),r.startOffset)}}}const jt=typeof navigator<"u"?navigator:null,Ng=typeof document<"u"?document:null,nr=jt&&jt.userAgent||"",rd=/Edge\/(\d+)/.exec(nr),wk=/MSIE \d/.exec(nr),id=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nr),Ue=!!(wk||id||rd),Ln=wk?document.documentMode:id?+id[1]:rd?+rd[1]:0,At=!Ue&&/gecko\/(\d+)/i.test(nr);At&&+(/Firefox\/(\d+)/.exec(nr)||[0,0])[1];const od=!Ue&&/Chrome\/(\d+)/.exec(nr),Ne=!!od,xk=od?+od[1]:0,$e=!Ue&&!!jt&&/Apple Computer/.test(jt.vendor),Zi=$e&&(/Mobile\/\w+/.test(nr)||!!jt&&jt.maxTouchPoints>2),ht=Zi||(jt?/Mac/.test(jt.platform):!1),nD=jt?/Win/.test(jt.platform):!1,ln=/Android \d/.test(nr),El=!!Ng&&"webkitFontSmoothing"in Ng.documentElement.style,rD=El?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function iD(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function en(n,e){return typeof n=="number"?n:n[e]}function oD(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function vg(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;s=Js(s)){if(s.nodeType!=1)continue;let l=s,a=l==o.body,u=a?iD(o):oD(l),c=0,f=0;if(e.top<u.top+en(r,"top")?f=-(u.top-e.top+en(i,"top")):e.bottom>u.bottom-en(r,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+en(i,"top")-u.top:e.bottom-u.bottom+en(i,"bottom")),e.left<u.left+en(r,"left")?c=-(u.left-e.left+en(i,"left")):e.right>u.right-en(r,"right")&&(c=e.right-u.right+en(i,"right")),c||f)if(a)o.defaultView.scrollBy(c,f);else{let d=l.scrollLeft,h=l.scrollTop;f&&(l.scrollTop+=f),c&&(l.scrollLeft+=c);let p=l.scrollLeft-d,m=l.scrollTop-h;e={left:e.left-p,top:e.top-m,right:e.right-p,bottom:e.bottom-m}}if(a||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function sD(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let l=n.root.elementFromPoint(o,s);if(!l||l==n.dom||!n.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=t-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:Ck(n.dom)}}function Ck(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Js(r));return e}function lD({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Nk(t,r==0?0:r-e)}function Nk(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let oi=null;function aD(n){if(n.setActive)return n.setActive();if(oi)return n.focus(oi);let e=Ck(n);n.focus(oi==null?{get preventScroll(){return oi={preventScroll:!0},!0}}:void 0),oi||(oi=!1,Nk(e,0))}function vk(n,e){let t,r=2e8,i,o=0,s=e.top,l=e.top,a,u;for(let c=n.firstChild,f=0;c;c=c.nextSibling,f++){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=nn(c).getClientRects();else continue;for(let h=0;h<d.length;h++){let p=d[h];if(p.top<=s&&p.bottom>=l){s=Math.max(p.bottom,s),l=Math.min(p.top,l);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=c,r=m,i=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,c.nodeType==1&&m&&(o=f+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!a&&p.left<=e.left&&p.right>=e.left&&(a=c,u={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(o=f+1)}}return!t&&a&&(t=a,i=u,r=0),t&&t.nodeType==3?uD(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:vk(t,i)}function uD(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=wn(r,1);if(o.top!=o.bottom&&Gh(e,o))return{node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function Gh(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function cD(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function fD(n,e,t){let{node:r,offset:i}=vk(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function dD(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let l=n.docView.nearestDesc(o,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&(!s&&a.left>r.left||a.top>r.top?i=l.posBefore:(!s&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),s=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;o=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function Ek(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let l=s.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(Gh(e,u))return Ek(s,e,u)}}if((o=(o+1)%r)==i)break}return n}function hD(n,e){let t=n.dom.ownerDocument,r,i=0,o=tD(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),l;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=n.dom.getBoundingClientRect();if(!Gh(e,u)||(s=Ek(n.dom,e,u),!s))return null}if($e)for(let u=s;r&&u;u=Js(u))u.draggable&&(r=void 0);if(s=cD(s,e),r){if(At&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let u;El&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=dD(n,r,i,e))}l==null&&(l=fD(n,s,e));let a=n.docView.nearestDesc(s,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function Eg(n){return n.top<n.bottom||n.left<n.right}function wn(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Eg(r))return r}return Array.prototype.find.call(t,Eg)||n.getBoundingClientRect()}const pD=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Mk(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=El||At;if(r.nodeType==3)if(s&&(pD.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let a=wn(nn(r,i,i),t);if(At&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=wn(nn(r,i-1,i-1),-1);if(u.top==a.top){let c=wn(nn(r,i,i+1),-1);if(c.top!=a.top)return go(c,c.left<u.left)}}return a}else{let a=i,u=i,c=t<0?1:-1;return t<0&&!i?(u++,c=-1):t>=0&&i==r.nodeValue.length?(a--,c=1):t<0?a--:u++,go(wn(nn(r,a,u),c),c<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==St(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return zc(a.getBoundingClientRect(),!1)}if(o==null&&i<St(r)){let a=r.childNodes[i];if(a.nodeType==1)return zc(a.getBoundingClientRect(),!0)}return zc(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==St(r))){let a=r.childNodes[i-1],u=a.nodeType==3?nn(a,St(a)-(s?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return go(wn(u,1),!1)}if(o==null&&i<St(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?nn(a,0,s?0:1):a.nodeType==1?a:null:null;if(u)return go(wn(u,-1),!0)}return go(wn(r.nodeType==3?nn(r):r,-t),t>=0)}function go(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function zc(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Ok(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function mD(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return Ok(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(o,!0);if(!l)break;if(l.node.isBlock){o=l.contentDOM||l.dom;break}o=l.dom.parentNode}let s=Mk(n,i.pos,1);for(let l=o.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=nn(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(t=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const gD=/[\u0590-\u08ac]/;function yD(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,l=n.domSelection();return l?!gD.test(r.parent.textContent)||!l.modify?t=="left"||t=="backward"?o:s:Ok(n,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:f}=n.domSelectionRange(),d=l.caretBidiLevel;l.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),S=p&&!h.contains(p.nodeType==1?p:p.parentNode)||a==p&&u==m;try{l.collapse(c,f),a&&(a!=c||u!=f)&&l.extend&&l.extend(a,u)}catch{}return d!=null&&(l.caretBidiLevel=d),S}):r.pos==r.start()||r.pos==r.end()}let Mg=null,Og=null,Dg=!1;function SD(n,e,t){return Mg==e&&Og==t?Dg:(Mg=e,Og=t,Dg=t=="up"||t=="down"?mD(n,e,t):yD(n,e,t))}const xt=0,Tg=1,Nr=2,Qt=3;let Ml=class{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=xt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>ge(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],l=o+s.size;if(l>e||s instanceof Ak){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof Dk&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?ge(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?ge(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){let a=this.children[l],u=s+a.size;if(i==-1&&e<=u){let c=s+a.border;if(e>=c&&t<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=s;for(let f=l;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=ge(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(u>t||l==this.children.length-1)){t=u;for(let c=l+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=ge(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],S=p+m.size;if(o>p&&s<S)return m.setSelection(e-p-m.border,t-p-m.border,r,i);p=S}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1),u=r.root.getSelection(),c=r.domSelectionRange(),f=!1;if((At||$e)&&e==t){let{node:h,offset:p}=l;if(h.nodeType==3){if(f=!!(p&&h.nodeValue[p-1]==`
`),f&&p==h.nodeValue.length)for(let m=h,S;m;m=m.parentNode){if(S=m.nextSibling){S.nodeName=="BR"&&(l=a={node:S.parentNode,offset:ge(S)+1});break}let g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let m=h.childNodes[p-1];f=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(At&&c.focusNode&&c.focusNode!=a.node&&c.focusNode.nodeType==1){let h=c.focusNode.childNodes[c.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||f&&$e)&&Jr(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Jr(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((u.extend||e==t)&&!f){u.collapse(l.node,l.offset);try{e!=t&&u.extend(a.node,a.offset),d=!0}catch{}}if(!d){if(e>t){let p=l;l=a,a=p}let h=document.createRange();h.setEnd(a.node,a.offset),h.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let l=r+o.border,a=s-o.border;if(e>=l&&t<=a){this.dirty=e==r||t==s?Nr:Tg,e==l&&t==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Qt:o.markDirty(e-l,t-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Nr:Qt}r=s}this.dirty=Nr}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Nr:Tg;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}},Dk=class extends Ml{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==xt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}},kD=class extends Ml{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}},iu=class sd extends Ml{constructor(e,t,r,i,o){super(e,[],r,i),this.mark=t,this.spec=o}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=Yt.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new sd(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Qt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Qt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=xt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=xt}}slice(e,t,r){let i=sd.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=ad(o,t,s,r)),e>0&&(o=ad(o,0,e,r));for(let l=0;l<o.length;l++)o[l].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}},zi=class Tk extends Ml{constructor(e,t,r,i,o,s,l,a,u){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,t,r,i,o,s){let l=o.nodeViews[t.type.name],a,u=l&&l(t,o,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,f=u&&u.contentDOM;if(t.isText){if(!c)c=document.createTextNode(t.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Yt.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!f&&!t.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let d=c;return c=zk(c,r,t),u?a=new wD(e,t,r,i,c,f||null,d,u,o,s+1):t.isText?new bk(e,t,r,i,c,d,o):new Tk(e,t,r,i,c,f||null,d,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>x.empty)}return e}matchesNode(e,t,r){return this.dirty==xt&&e.eq(this.node)&&ou(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,l=o&&o.pos<0,a=new CD(this,s&&s.node,e);ED(this.node,this.innerDeco,(u,c,f)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!f&&a.syncToMarks(c==this.node.childCount?W.none:this.node.child(c).marks,r,e),a.placeWidget(u,e,i)},(u,c,f,d)=>{a.syncToMarks(u.marks,r,e);let h;a.findNodeMatch(u,c,f,d)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(h=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(u,c,f,h,e)||a.updateNextNode(u,c,f,e,d,i)||a.addNode(u,c,f,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==Nr)&&(s&&this.protectLocalComposition(e,s),$k(this.contentDOM,this.children,e),Zi&&MD(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof $)||r<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,l=OD(this.node.content,s,r-t,i-t);return l<0?null:{node:o,pos:l,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new kD(this,o,t,i);e.input.compositionNodes.push(s),this.children=ad(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==Qt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=xt}updateOuterDeco(e){if(ou(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Ik(this.dom,this.nodeDOM,ld(this.outerDeco,this.node,t),ld(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}};function bg(n,e,t,r,i){zk(r,e,n);let o=new zi(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}let bk=class Rk extends zi{constructor(e,t,r,i,o,s,l){super(e,t,r,i,o,null,s,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Qt||this.dirty!=xt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=xt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=xt,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new Rk(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Qt)}get domAtom(){return!1}isText(e){return this.node.text==e}},Ak=class extends Ml{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==xt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}};class wD extends zi{constructor(e,t,r,i,o,s,l,a,u,c){super(e,t,r,i,o,s,l,u,c),this.spec=a}update(e,t,r,i){if(this.dirty==Qt)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function $k(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],l=s.dom;if(l.parentNode==n){for(;l!=r;)r=Rg(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(l,r);if(s instanceof iu){let a=r?r.previousSibling:n.lastChild;$k(s.contentDOM,s.children,t),r=a?a.nextSibling:n.firstChild}}for(;r;)r=Rg(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const Ss=function(n){n&&(this.nodeName=n)};Ss.prototype=Object.create(null);const vr=[new Ss];function ld(n,e,t){if(n.length==0)return vr;let r=t?vr[0]:new Ss,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new Ss(s.nodeName));for(let l in s){let a=s[l];a!=null&&(t&&i.length==1&&i.push(r=new Ss(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function Ik(n,e,t,r){if(t==vr&&r==vr)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],l=t[o];if(o){let a;l&&l.nodeName==s.nodeName&&i!=n&&(a=i.parentNode)&&a.nodeName.toLowerCase()==s.nodeName||(a=document.createElement(s.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=vr[0]),i=a}xD(i,l||vr[0],s)}return i}function xD(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function zk(n,e,t){return Ik(n,n,vr,ld(e,t,n.nodeType!=1))}function ou(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Rg(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class CD{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=ND(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=xt,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let u=this.top.children[a];if(u.matchesMark(e[o])&&!this.isLocked(u.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=iu.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,t,r)&&!this.preMatch.matched.has(u)){o=l;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==Qt&&s.dom==s.contentDOM&&(s.dirty=Nr),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof zi){let u=this.preMatch.matched.get(a);if(u!=null&&u!=o)return!1;let c=a.dom,f,d=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Qt&&ou(t,a.outerDeco));if(!d&&a.update(e,t,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(a,e,t,r,i,s)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Nr,f.updateChildren(i,s+1),f.dirty=xt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!ou(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=zi.create(this.top,t,r,i,o,s);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,t,r,i,o){let s=zi.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new Dk(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof iu;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof bk)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&(($e||Ne)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Ak(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function ND(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let l;for(;;)if(r){let u=t.children[r-1];if(u instanceof iu)t=u,r=u.children.length;else{l=u,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let a=l.node;if(a){if(a!=n.child(i-1))break;--i,o.set(l,i),s.push(l)}}return{index:i,matched:o,matches:s.reverse()}}function vD(n,e){return n.type.side-e.type.side}function ED(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let u=0;u<n.childCount;u++){let c=n.child(u);r(c,i,e.forChild(o,c),u),o+=c.nodeSize}return}let s=0,l=[],a=null;for(let u=0;;){let c,f;for(;s<i.length&&i[s].to==o;){let S=i[s++];S.widget&&(c?(f||(f=[c])).push(S):c=S)}if(c)if(f){f.sort(vD);for(let S=0;S<f.length;S++)t(f[S],u,!!a)}else t(c,u,!!a);let d,h;if(a)h=-1,d=a,a=null;else if(u<n.childCount)h=u,d=n.child(u++);else break;for(let S=0;S<l.length;S++)l[S].to<=o&&l.splice(S--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let p=o+d.nodeSize;if(d.isText){let S=p;s<i.length&&i[s].from<S&&(S=i[s].from);for(let g=0;g<l.length;g++)l[g].to<S&&(S=l[g].to);S<p&&(a=d.cut(S-o),d=d.cut(0,S-o),p=S,h=-1)}else for(;s<i.length&&i[s].to<p;)s++;let m=d.isInline&&!d.isLeaf?l.filter(S=>!S.inline):l.slice();r(d,m,e.forChild(o,d),h),o=p}}function MD(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function OD(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),l=o;if(o+=s.nodeSize,!s.isText)continue;let a=s.text;for(;i<n.childCount;){let u=n.child(i++);if(o+=u.nodeSize,!u.isText)break;a+=u.text}if(o>=t){if(o>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=t)return l+u;if(t==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function ad(n,e,t,r,i){let o=[];for(let s=0,l=0;s<n.length;s++){let a=n[s],u=l,c=l+=a.size;u>=t||c<=e?o.push(a):(u<e&&o.push(a.slice(0,e-u,r)),i&&(o.push(i),i=void 0),c>t&&o.push(a.slice(t-u,a.size,r)))}return o}function Yh(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(Ku(t)){for(a=s;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&O.isSelectable(f)&&i.parent&&!(f.isInline&&ZO(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;u=new O(s==d?l:r.resolve(d))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let f=s,d=s;for(let h=0;h<t.rangeCount;h++){let p=t.getRangeAt(h);f=Math.min(f,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),d=Math.max(d,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(f<0)return null;[a,s]=d==n.state.selection.anchor?[d,f]:[f,d],l=r.resolve(s)}else a=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(a<0)return null}let c=r.resolve(a);if(!u){let f=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=Xh(n,c,l,f)}return u}function Pk(n){return n.editable?n.hasFocus():Lk(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function cn(n,e=!1){let t=n.state.selection;if(Fk(n,t),!!Pk(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Ne){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Jr(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)TD(n);else{let{anchor:r,head:i}=t,o,s;Ag&&!(t instanceof $)&&(t.$from.parent.inlineContent||(o=$g(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=$g(n,t.to))),n.docView.setSelection(r,i,n,e),Ag&&(o&&Ig(o),s&&Ig(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&DD(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Ag=$e||Ne&&xk<63;function $g(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if($e&&i&&i.contentEditable=="false")return Pc(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Pc(i);if(o)return Pc(o)}}function Pc(n){return n.contentEditable="true",$e&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Ig(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function DD(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Pk(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function TD(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setStart(r.parentNode,ge(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&Ue&&Ln<=11&&(r.disabled=!0,r.disabled=!1)}function Fk(n,e){if(e instanceof O){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(zg(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else zg(n)}function zg(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Xh(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function Pg(n){return n.editable&&!n.hasFocus()?!1:Lk(n)}function Lk(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function bD(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Jr(e.node,e.offset,t.anchorNode,t.anchorOffset)}function ud(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&z.findFrom(o,e)}function vn(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Fg(n,e,t){let r=n.state.selection;if(r instanceof $)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return vn(n,new $(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=ud(n.state,e);return i&&i instanceof O?vn(n,i):!1}else if(!(ht&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(l))&&!s.contentDOM?O.isSelectable(o)?vn(n,new O(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):El?vn(n,new $(n.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof O&&r.node.isInline)return vn(n,new $(e>0?r.$to:r.$from));{let i=ud(n.state,e);return i?vn(n,i):!1}}}function su(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ks(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function si(n,e){return e<0?RD(n):AD(n)}function RD(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(At&&t.nodeType==1&&r<su(t)&&ks(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(ks(l,-1))i=t,o=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(Vk(t))break;{let l=t.previousSibling;for(;l&&ks(l,-1);)i=t.parentNode,o=ge(l),l=l.previousSibling;if(l)t=l,r=su(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?cd(n,t,r):i&&cd(n,i,o)}function AD(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=su(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let l=t.childNodes[r];if(ks(l,1))o=t,s=++r;else break}else{if(Vk(t))break;{let l=t.nextSibling;for(;l&&ks(l,1);)o=l.parentNode,s=ge(l)+1,l=l.nextSibling;if(l)t=l,r=0,i=su(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&cd(n,o,s)}function Vk(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function $D(n,e){for(;n&&e==n.childNodes.length&&!vl(n);)e=ge(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function ID(n,e){for(;n&&!e&&!vl(n);)e=ge(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function cd(n,e,t){if(e.nodeType!=3){let o,s;(s=$D(e,t))?(e=s,t=0):(o=ID(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Ku(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&cn(n)},50)}function Lg(n,e){let t=n.state.doc.resolve(e);if(!(Ne||nD)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Vg(n,e,t){let r=n.state.selection;if(r instanceof $&&!r.empty||t.indexOf("s")>-1||ht&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=ud(n.state,e);if(s&&s instanceof O)return vn(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof Re?z.near(s,e):z.findFrom(s,e);return l?vn(n,l):!1}return!1}function Bg(n,e){if(!(n.state.selection instanceof $))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function Jg(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function zD(n){if(!$e||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Jg(n,r,"true"),setTimeout(()=>Jg(n,r,"false"),20)}return!1}function PD(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function FD(n,e){let t=e.keyCode,r=PD(e);if(t==8||ht&&t==72&&r=="c")return Bg(n,-1)||si(n,-1);if(t==46&&!e.shiftKey||ht&&t==68&&r=="c")return Bg(n,1)||si(n,1);if(t==13||t==27)return!0;if(t==37||ht&&t==66&&r=="c"){let i=t==37?Lg(n,n.state.selection.from)=="ltr"?-1:1:-1;return Fg(n,i,r)||si(n,i)}else if(t==39||ht&&t==70&&r=="c"){let i=t==39?Lg(n,n.state.selection.from)=="ltr"?1:-1:1;return Fg(n,i,r)||si(n,i)}else{if(t==38||ht&&t==80&&r=="c")return Vg(n,-1,r)||si(n,-1);if(t==40||ht&&t==78&&r=="c")return zD(n)||Vg(n,1,r)||si(n,1);if(r==(ht?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Bk(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=n.someProp("clipboardSerializer")||Yt.fromSchema(n.state.schema),l=Uk(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let u=a.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=Hk[u.nodeName.toLowerCase()]);){for(let h=c.length-1;h>=0;h--){let p=l.createElement(c[h]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),f++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:d,slice:e}}function Jk(n,e,t,r,i){let o=i.parent.type.spec.code,s,l;if(!t&&!e)return null;let a=e&&(r||o||!t);if(a){if(n.someProp("transformPastedText",d=>{e=d(e,o||r,n)}),o)return e?new w(x.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):w.empty;let f=n.someProp("clipboardTextParser",d=>d(e,i,r,n));if(f)l=f;else{let d=i.marks(),{schema:h}=n.state,p=Yt.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let S=s.appendChild(document.createElement("p"));m&&S.appendChild(p.serializeNode(h.text(m,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),s=JD(t),El&&WD(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let d=s.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;s=d}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||Vr.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!LD.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)l=KD(Wg(l,+c[1],+c[2]),c[4]);else if(l=w.maxOpen(VD(l.content,i),!0),l.openStart||l.openEnd){let f=0,d=0;for(let h=l.content.firstChild;f<l.openStart&&!h.type.spec.isolating;f++,h=h.firstChild);for(let h=l.content.lastChild;d<l.openEnd&&!h.type.spec.isolating;d++,h=h.lastChild);l=Wg(l,f,d)}return n.someProp("transformPasted",f=>{l=f(l,n)}),l}const LD=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function VD(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),u;if(!a)return s=null;if(u=s.length&&o.length&&Kk(a,o,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=_k(s[s.length-1],o.length));let c=Wk(l,a);s.push(c),i=i.matchType(c.type),o=a}}),s)return x.from(s)}return n}function Wk(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,x.from(n));return n}function Kk(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=Kk(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(x.from(Wk(t,n,i+1))))}}function _k(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,_k(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(x.empty,!0);return n.copy(t.append(r))}function fd(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,l=s.content;return n.childCount>1&&(o=0),i<r-1&&(l=fd(l,e,t,r,i+1,o)),i>=t&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(x.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(l))}function Wg(n,e,t){return e<n.openStart&&(n=new w(fd(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new w(fd(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Hk={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Kg=null;function Uk(){return Kg||(Kg=document.implementation.createHTMLDocument("title"))}let Fc=null;function BD(n){let e=window.trustedTypes;return e?(Fc||(Fc=e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Fc.createHTML(n)):n}function JD(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Uk().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&Hk[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=BD(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function WD(n){let e=n.querySelectorAll(Ne?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function KD(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=x.from(a.create(r[l+1],i)),o++,s++}return new w(i,o,s)}const Ie={},ze={},_D={touchstart:!0,touchmove:!0};class HD{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function UD(n){for(let e in Ie){let t=Ie[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{jD(n,r)&&!Zh(n,r)&&(n.editable||!(r.type in ze))&&t(n,r)},_D[e]?{passive:!0}:void 0)}$e&&n.dom.addEventListener("input",()=>null),dd(n)}function zn(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function qD(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function dd(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Zh(n,r))})}function Zh(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function jD(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function QD(n,e){!Zh(n,e)&&Ie[e.type]&&(n.editable||!(e.type in ze))&&Ie[e.type](n,e)}ze.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!jk(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(ln&&Ne&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Zi&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,kr(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||FD(n,t)?t.preventDefault():zn(n,"key")};ze.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};ze.keypress=(n,e)=>{let t=e;if(jk(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||ht&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof $)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function _u(n){return{left:n.clientX,top:n.clientY}}function GD(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function ep(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,l=>s>o.depth?l(n,t,o.nodeAfter,o.before(s),i,!0):l(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function Pi(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function YD(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&O.isSelectable(r)?(Pi(n,new O(t)),!0):!1}function XD(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof O&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(O.isSelectable(l)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(Pi(n,O.create(n.state.doc,i)),!0):!1}function ZD(n,e,t,r,i){return ep(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?XD(n,t):YD(n,t))}function eT(n,e,t,r){return ep(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function tT(n,e,t,r){return ep(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||nT(n,t,r)}function nT(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Pi(n,$.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)Pi(n,$.create(r,l+1,l+1+s.content.size));else if(O.isSelectable(s))Pi(n,O.create(r,l));else continue;return!0}}function tp(n){return lu(n)}const qk=ht?"metaKey":"ctrlKey";Ie.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=tp(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&GD(t,n.input.lastClick)&&!t[qk]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o};let s=n.posAtCoords(_u(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new rT(n,s,t,!!r)):(o=="doubleClick"?eT:tT)(n,s.pos,s.inside,t)?t.preventDefault():zn(n,"pointer"))};class rT{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[qk],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let c=e.state.doc.resolve(t.pos);o=c.parent,s=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof O&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&At&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),zn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>cn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(_u(e))),this.updateAllowDefault(e),this.allowDefault||!t?zn(this.view,"pointer"):ZD(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||$e&&this.mightDrag&&!this.mightDrag.node.isAtom||Ne&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Pi(this.view,z.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):zn(this.view,"pointer")}move(e){this.updateAllowDefault(e),zn(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ie.touchstart=n=>{n.input.lastTouch=Date.now(),tp(n),zn(n,"pointer")};Ie.touchmove=n=>{n.input.lastTouch=Date.now(),zn(n,"pointer")};Ie.contextmenu=n=>tp(n);function jk(n,e){return n.composing?!0:$e&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const iT=ln?5e3:-1;ze.compositionstart=ze.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof $&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),lu(n,!0),n.markCursor=null;else if(lu(n,!e.selection.empty),At&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let l=n.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}Qk(n,iT)};ze.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Qk(n,20))};function Qk(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>lu(n),e))}function Gk(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=sT());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function oT(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=YO(e.focusNode,e.focusOffset),r=XO(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t||r}function sT(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function lu(n,e=!1){if(!(ln&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Gk(n),e||n.docView&&n.docView.dirty){let t=Yh(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function lT(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ws=Ue&&Ln<15||Zi&&rD<604;Ie.copy=ze.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=Ws?null:t.clipboardData,s=r.content(),{dom:l,text:a}=Bk(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):lT(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function aT(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function uT(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Ks(n,r.value,null,i,e):Ks(n,r.textContent,r.innerHTML,i,e)},50)}function Ks(n,e,t,r,i){let o=Jk(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,i,o||w.empty)))return!0;if(!o)return!1;let s=aT(o),l=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Yk(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}ze.paste=(n,e)=>{let t=e;if(n.composing&&!ln)return;let r=Ws?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Ks(n,Yk(r),r.getData("text/html"),i,t)?t.preventDefault():uT(n,t)};class Xk{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Zk=ht?"altKey":"ctrlKey";Ie.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(_u(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof O?i.to-1:i.to))){if(r&&r.mightDrag)s=O.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(s=O.create(n.state.doc,f.posBefore))}}let l=(s||n.state.selection).content(),{dom:a,text:u,slice:c}=Bk(n,l);(!t.dataTransfer.files.length||!Ne||xk>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Ws?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ws||t.dataTransfer.setData("text/plain",u),n.dragging=new Xk(c,!t[Zk],s)};Ie.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};ze.dragover=ze.dragenter=(n,e)=>e.preventDefault();ze.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(_u(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",p=>{s=p(s,n)}):s=Jk(n,Yk(t.dataTransfer),Ws?null:t.dataTransfer.getData("text/html"),!1,o);let l=!!(r&&!t[Zk]);if(n.someProp("handleDrop",p=>p(n,t,s||w.empty,l))){t.preventDefault();return}if(!s)return;t.preventDefault();let a=s?jO(n.state.doc,o.pos,s):o.pos;a==null&&(a=o.pos);let u=n.state.tr;if(l){let{node:p}=r;p?p.replace(u):u.deleteSelection()}let c=u.mapping.map(a),f=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,d=u.doc;if(f?u.replaceRangeWith(c,c,s.content.firstChild):u.replaceRange(c,c,s),u.doc.eq(d))return;let h=u.doc.resolve(c);if(f&&O.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new O(h));else{let p=u.mapping.map(a);u.mapping.maps[u.mapping.maps.length-1].forEach((m,S,g,y)=>p=y),u.setSelection(Xh(n,h,u.doc.resolve(p)))}n.focus(),n.dispatch(u.setMeta("uiEvent","drop"))};Ie.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&cn(n)},20))};Ie.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Ie.beforeinput=(n,e)=>{if(Ne&&ln&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,kr(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in ze)Ie[n]=ze[n];function _s(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class au{constructor(e,t){this.toDOM=e,this.spec=t||Ir,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new _e(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof au&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&_s(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Vn{constructor(e,t){this.attrs=e,this.spec=t||Ir}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new _e(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Vn&&_s(this.attrs,e.attrs)&&_s(this.spec,e.spec)}static is(e){return e.type instanceof Vn}destroy(){}}class np{constructor(e,t){this.attrs=e,this.spec=t||Ir}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new _e(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof np&&_s(this.attrs,e.attrs)&&_s(this.spec,e.spec)}destroy(){}}class _e{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new _e(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new _e(e,e,new au(t,r))}static inline(e,t,r,i){return new _e(e,t,new Vn(r,i))}static node(e,t,r,i){return new _e(e,t,new np(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Vn}get widget(){return this.type instanceof au}}const ki=[],Ir={};class _{constructor(e,t){this.local=e.length?e:ki,this.children=t.length?t:ki}static create(e,t){return t.length?uu(t,e,0,Ir):xe}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=t&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,t-l,r,i+l,o)}}map(e,t,r){return this==xe||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Ir)}mapInner(e,t,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(t,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?cT(this.children,s||[],e,t,r,i,o):s?new _(s.sort(zr),ki):xe}add(e,t){return t.length?this==xe?_.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((l,a)=>{let u=a+r,c;if(c=nw(t,l,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,c,u+1):i.splice(o,0,a,a+l.nodeSize,uu(c,l,u+1,Ir)),o+=3}});let s=tw(o?rw(t):t,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new _(s.length?this.local.concat(s).sort(zr):this.local,i||this.children)}remove(e){return e.length==0||this==xe?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+t,a=r[o+1]+t;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,l+1);u!=xe?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new _(i,r):xe}forChild(e,t){if(this==xe)return this;if(t.isLeaf)return _.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof Vn){let u=Math.max(o,a.from)-o,c=Math.min(s,a.to)-o;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new _(i.sort(zr),ki);return r?new ew([l,r]):l}return r||xe}eq(e){if(this==e)return!0;if(!(e instanceof _)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return rp(this.localsInner(e))}localsInner(e){if(this==xe)return ki;if(e.inlineContent||!this.local.some(Vn.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Vn||t.push(this.local[r]);return t}forEachSet(e){e(this)}}_.empty=new _([],[]);_.removeOverlap=rp;const xe=_.empty;let ew=class wi{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Ir));return wi.from(r)}forChild(e,t){if(t.isLeaf)return _.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=xe&&(o instanceof wi?r=r.concat(o.members):r.push(o))}return wi.from(r)}eq(e){if(!(e instanceof wi)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?rp(r?t:t.sort(zr)):ki}static from(e){switch(e.length){case 0:return xe;case 1:return e[0];default:return new wi(e.every(t=>t instanceof _)?e:e.reduce((t,r)=>t.concat(r instanceof _?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}};function cT(n,e,t,r,i,o,s){let l=n.slice();for(let u=0,c=o;u<t.maps.length;u++){let f=0;t.maps[u].forEach((d,h,p,m)=>{let S=m-p-(h-d);for(let g=0;g<l.length;g+=3){let y=l[g+1];if(y<0||d>y+c-f)continue;let k=l[g]+c-f;h>=k?l[g+1]=d<=k?-2:-1:d>=c&&S&&(l[g]+=S,l[g+1]+=S)}f+=S}),c=t.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=t.map(n[u]+o),f=c-i;if(f<0||f>=r.content.size){a=!0;continue}let d=t.map(n[u+1]+o,-1),h=d-i,{index:p,offset:m}=r.content.findIndex(f),S=r.maybeChild(p);if(S&&m==f&&m+S.nodeSize==h){let g=l[u+2].mapInner(t,S,c+1,n[u]+o+1,s);g!=xe?(l[u]=f,l[u+1]=h,l[u+2]=g):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=fT(l,n,e,t,i,o,s),c=uu(u,r,0,s);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,d=0;f<c.children.length;f+=3){let h=c.children[f];for(;d<l.length&&l[d]<h;)d+=3;l.splice(d,0,c.children[f],c.children[f+1],c.children[f+2])}}return new _(e.sort(zr),l)}function tw(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new _e(i.from+e,i.to+e,i.type))}return t}function fT(n,e,t,r,i,o,s){function l(a,u){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(r,i,u);f?t.push(f):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+o+1);return t}function nw(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function rw(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function uu(n,e,t,r){let i=[],o=!1;e.forEach((l,a)=>{let u=nw(n,l,a+t);if(u){o=!0;let c=uu(u,l,t+a+1,r);c!=xe&&i.push(a,a+l.nodeSize,c)}});let s=tw(o?rw(n):n,-t).sort(zr);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new _(s,i):xe}function zr(n,e){return n.from-e.from||n.to-e.to}function rp(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),_g(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),_g(e,i,r.copy(o.from,r.to)));break}}}return e}function _g(n,e,t){for(;e<n.length&&zr(t,n[e])>0;)e++;n.splice(e,0,t)}function Lc(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=xe&&e.push(r)}),n.cursorWrapper&&e.push(_.create(n.state.doc,[n.cursorWrapper.deco])),ew.from(e)}const dT={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},hT=Ue&&Ln<=11;let pT=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}};class mT{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new pT,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Ue&&Ln<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),hT&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,dT)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Pg(this.view)){if(this.suppressingSelectionUpdates)return cn(this.view);if(Ue&&Ln<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Jr(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=Js(o))t.add(o);for(let o=e.anchorNode;o;o=Js(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Pg(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,l=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let f=this.registerMutation(t[c],a);f&&(o=o<0?f.from:Math.min(f.from,o),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(l=!0))}if(At&&a.length){let c=a.filter(f=>f.nodeName=="BR");if(c.length==2){let[f,d]=c;f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let d of c){let h=d.parentNode;h&&h.nodeName=="LI"&&(!f||ST(e,f)!=h)&&d.remove()}}}let u=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Ku(r)&&(u=Yh(e))&&u.eq(z.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,cn(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),gT(e)),this.handleDOMChange(o,s,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||cn(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let f=e.addedNodes[c];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(Ue&&Ln<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:d}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d)}let s=i&&i.parentNode==e.target?ge(i)+1:0,l=r.localPosFromDOM(e.target,s,-1),a=o&&o.parentNode==e.target?ge(o):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Hg=new WeakMap,Ug=!1;function gT(n){if(!Hg.has(n)&&(Hg.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=At,Ug)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Ug=!0}}function qg(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=n.domAtPos(n.state.selection.anchor);return Jr(s.node,s.offset,i,o)&&([t,r,i,o]=[i,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:o}}function yT(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return qg(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?qg(n,t):null}function ST(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function kT(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:l}=n.docView.parseRange(e,t),a=n.domSelectionRange(),u,c=a.anchorNode;if(c&&n.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],Ku(a)||u.push({node:a.focusNode,offset:a.focusOffset})),Ne&&n.input.lastKeyCode===8)for(let S=o;S>i;S--){let g=r.childNodes[S-1],y=g.pmViewDesc;if(g.nodeName=="BR"&&!y){o=S;break}if(!y||y.size)break}let f=n.state.doc,d=n.someProp("domParser")||Vr.fromSchema(n.state.schema),h=f.resolve(s),p=null,m=d.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:o,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:wT,context:h});if(u&&u[0].pos!=null){let S=u[0].pos,g=u[1]&&u[1].pos;g==null&&(g=S),p={anchor:S+s,head:g+s}}return{doc:m,sel:p,from:s,to:l}}function wT(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if($e&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||$e&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const xT=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function CT(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let I=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,P=Yh(n,I);if(P&&!n.state.selection.eq(P)){if(Ne&&ln&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",Zt=>Zt(n,kr(13,"Enter"))))return;let le=n.state.tr.setSelection(P);I=="pointer"?le.setMeta("pointer",!0):I=="key"&&le.scrollIntoView(),o&&le.setMeta("composition",o),n.dispatch(le)}return}let s=n.state.doc.resolve(e),l=s.sharedDepth(t);e=s.before(l+1),t=n.state.doc.resolve(t).after(l+1);let a=n.state.selection,u=kT(n,e,t),c=n.state.doc,f=c.slice(u.from,u.to),d,h;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(d=n.state.selection.to,h="end"):(d=n.state.selection.from,h="start"),n.input.lastKeyCode=null;let p=ET(f.content,u.doc.content,u.from,d,h);if(p&&n.input.domChangeCount++,(Zi&&n.input.lastIOSEnter>Date.now()-225||ln)&&i.some(I=>I.nodeType==1&&!xT.test(I.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",I=>I(n,kr(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&a instanceof $&&!a.empty&&a.$head.sameParent(a.$anchor)&&!n.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))p={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let I=jg(n,n.state.doc,u.sel);if(I&&!I.eq(n.state.selection)){let P=n.state.tr.setSelection(I);o&&P.setMeta("composition",o),n.dispatch(P)}}return}n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof $&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=u.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=u.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Ue&&Ln<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>u.from&&u.doc.textBetween(p.start-u.from-1,p.start-u.from+1)=="  "&&(p.start--,p.endA--,p.endB--);let m=u.doc.resolveNoCache(p.start-u.from),S=u.doc.resolveNoCache(p.endB-u.from),g=c.resolve(p.start),y=m.sameParent(S)&&m.parent.inlineContent&&g.end()>=p.endA,k;if((Zi&&n.input.lastIOSEnter>Date.now()-225&&(!y||i.some(I=>I.nodeName=="DIV"||I.nodeName=="P"))||!y&&m.pos<u.doc.content.size&&!m.sameParent(S)&&(k=z.findFrom(u.doc.resolve(m.pos+1),1,!0))&&k.head==S.pos)&&n.someProp("handleKeyDown",I=>I(n,kr(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&vT(c,p.start,p.endA,m,S)&&n.someProp("handleKeyDown",I=>I(n,kr(8,"Backspace")))){ln&&Ne&&n.domObserver.suppressSelectionUpdates();return}Ne&&p.endB==p.start&&(n.input.lastChromeDelete=Date.now()),ln&&!y&&m.start()!=S.start()&&S.parentOffset==0&&m.depth==S.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==p.endA&&(p.endB-=2,S=u.doc.resolveNoCache(p.endB-u.from),setTimeout(()=>{n.someProp("handleKeyDown",function(I){return I(n,kr(13,"Enter"))})},20));let N=p.start,E=p.endA,v,D,T;if(y){if(m.pos==S.pos)Ue&&Ln<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>cn(n),20)),v=n.state.tr.delete(N,E),D=c.resolve(p.start).marksAcross(c.resolve(p.endA));else if(p.endA==p.endB&&(T=NT(m.parent.content.cut(m.parentOffset,S.parentOffset),g.parent.content.cut(g.parentOffset,p.endA-g.start()))))v=n.state.tr,T.type=="add"?v.addMark(N,E,T.mark):v.removeMark(N,E,T.mark);else if(m.parent.child(m.index()).isText&&m.index()==S.index()-(S.textOffset?0:1)){let I=m.parent.textBetween(m.parentOffset,S.parentOffset);if(n.someProp("handleTextInput",P=>P(n,N,E,I)))return;v=n.state.tr.insertText(I,N,E)}}if(v||(v=n.state.tr.replace(N,E,u.doc.slice(p.start-u.from,p.endB-u.from))),u.sel){let I=jg(n,v.doc,u.sel);I&&!(Ne&&n.composing&&I.empty&&(p.start!=p.endB||n.input.lastChromeDelete<Date.now()-100)&&(I.head==N||I.head==v.mapping.map(E)-1)||Ue&&I.empty&&I.head==N)&&v.setSelection(I)}D&&v.ensureMarks(D),o&&v.setMeta("composition",o),n.dispatch(v.scrollIntoView())}function jg(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Xh(n,e.resolve(t.anchor),e.resolve(t.head))}function NT(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<t.length;c++)o=t[c].removeFromSet(o);if(i.length==1&&o.length==0)l=i[0],s="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&o.length==1)l=o[0],s="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(x.from(u).eq(n))return{mark:l,type:s}}function vT(n,e,t,r,i){if(t-e<=i.pos-r.pos||Vc(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let l=o.nodeAfter;return l!=null&&t==e+l.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(Vc(o,!0,!0));return!s.parent.isTextblock||s.pos>t||Vc(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Vc(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function ET(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:l}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let a=Math.max(0,o-Math.min(s,l));r-=s+a-o}if(s<o&&n.size<e.size){let a=r<=o&&r>=s?o-r:0;o-=a,o&&o<e.size&&Qg(e.textBetween(o-1,o+1))&&(o+=a?1:-1),l=o+(l-s),s=o}else if(l<o){let a=r<=o&&r>=l?o-r:0;o-=a,o&&o<n.size&&Qg(n.textBetween(o-1,o+1))&&(o+=a?1:-1),s=o+(s-l),l=o}return{start:o,endA:s,endB:l}}function Qg(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class MT{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new HD,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(ey),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Xg(this),Yg(this),this.nodeViews=Zg(this),this.docView=bg(this.state.doc,Gg(this),Lc(this),this.dom,this),this.domObserver=new mT(this,(r,i,o,s)=>CT(this,r,i,o,s)),this.domObserver.start(),UD(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&dd(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(ey),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(Gk(this),s=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let h=Zg(this);DT(h,this.nodeViews)&&(this.nodeViews=h,o=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&dd(this),this.editable=Xg(this),Yg(this);let a=Lc(this),u=Gg(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,u,a);(f||!e.selection.eq(i.selection))&&(s=!0);let d=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&sD(this);if(s){this.domObserver.stop();let h=f&&(Ue||Ne)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&OT(i.selection,e.selection);if(f){let p=Ne?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=oT(this)),(o||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=bg(e.doc,u,a,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&bD(this))?cn(this,h):(Fk(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&lD(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof O){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&vg(this,t.getBoundingClientRect(),e)}else vg(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new Xk(e.slice,e.move,i<0?void 0:O.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[e];if(l!=null&&(i=t?t(l):l))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let l=o[s].props[e];if(l!=null&&(i=t?t(l):l))return i}}hasFocus(){if(Ue){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&aD(this.dom),cn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return hD(this,e)}coordsAtPos(e,t=1){return Mk(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return SD(this,t||this.state,e)}pasteHTML(e,t){return Ks(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Ks(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(qD(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Lc(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,QO())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return QD(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?$e&&this.root.nodeType===11&&eD(this.dom.ownerDocument)==this.dom&&yT(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Gg(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[_e.node(0,n.state.doc.content.size,e)]}function Yg(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:_e.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Xg(n){return!n.someProp("editable",e=>e(n.state)===!1)}function OT(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function Zg(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function DT(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function ey(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var iw={exports:{}},ut={},ow={exports:{}},sw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(A,F){var L=A.length;A.push(F);e:for(;0<L;){var ee=L-1>>>1,ae=A[ee];if(0<i(ae,F))A[ee]=F,A[L]=ae,L=ee;else break e}}function t(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var F=A[0],L=A.pop();if(L!==F){A[0]=L;e:for(var ee=0,ae=A.length,Al=ae>>>1;ee<Al;){var ur=2*(ee+1)-1,lc=A[ur],cr=ur+1,$l=A[cr];if(0>i(lc,L))cr<ae&&0>i($l,lc)?(A[ee]=$l,A[cr]=L,ee=cr):(A[ee]=lc,A[ur]=L,ee=ur);else if(cr<ae&&0>i($l,L))A[ee]=$l,A[cr]=L,ee=cr;else break e}}return F}function i(A,F){var L=A.sortIndex-F.sortIndex;return L!==0?L:A.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();n.unstable_now=function(){return s.now()-l}}var a=[],u=[],c=1,f=null,d=3,h=!1,p=!1,m=!1,S=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(A){for(var F=t(u);F!==null;){if(F.callback===null)r(u);else if(F.startTime<=A)r(u),F.sortIndex=F.expirationTime,e(a,F);else break;F=t(u)}}function N(A){if(m=!1,k(A),!p)if(t(a)!==null)p=!0,ar(E);else{var F=t(u);F!==null&&mo(N,F.startTime-A)}}function E(A,F){p=!1,m&&(m=!1,g(T),T=-1),h=!0;var L=d;try{for(k(F),f=t(a);f!==null&&(!(f.expirationTime>F)||A&&!le());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,d=f.priorityLevel;var ae=ee(f.expirationTime<=F);F=n.unstable_now(),typeof ae=="function"?f.callback=ae:f===t(a)&&r(a),k(F)}else r(a);f=t(a)}if(f!==null)var Al=!0;else{var ur=t(u);ur!==null&&mo(N,ur.startTime-F),Al=!1}return Al}finally{f=null,d=L,h=!1}}var v=!1,D=null,T=-1,I=5,P=-1;function le(){return!(n.unstable_now()-P<I)}function Zt(){if(D!==null){var A=n.unstable_now();P=A;var F=!0;try{F=D(!0,A)}finally{F?lr():(v=!1,D=null)}}else v=!1}var lr;if(typeof y=="function")lr=function(){y(Zt)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,nt=de.port2;de.port1.onmessage=Zt,lr=function(){nt.postMessage(null)}}else lr=function(){S(Zt,0)};function ar(A){D=A,v||(v=!0,lr())}function mo(A,F){T=S(function(){A(n.unstable_now())},F)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(A){A.callback=null},n.unstable_continueExecution=function(){p||h||(p=!0,ar(E))},n.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<A?Math.floor(1e3/A):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(A){switch(d){case 1:case 2:case 3:var F=3;break;default:F=d}var L=d;d=F;try{return A()}finally{d=L}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(A,F){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var L=d;d=A;try{return F()}finally{d=L}},n.unstable_scheduleCallback=function(A,F,L){var ee=n.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?ee+L:ee):L=ee,A){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=L+ae,A={id:c++,callback:F,priorityLevel:A,startTime:L,expirationTime:ae,sortIndex:-1},L>ee?(A.sortIndex=L,e(u,A),t(a)===null&&A===t(u)&&(m?(g(T),T=-1):m=!0,mo(N,L-ee))):(A.sortIndex=ae,e(a,A),p||h||(p=!0,ar(E))),A},n.unstable_shouldYield=le,n.unstable_wrapCallback=function(A){var F=d;return function(){var L=d;d=F;try{return A.apply(this,arguments)}finally{d=L}}}})(sw);ow.exports=sw;var TT=ow.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lw=C,at=TT;function M(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var aw=new Set,Hs={};function Zr(n,e){eo(n,e),eo(n+"Capture",e)}function eo(n,e){for(Hs[n]=e,n=0;n<e.length;n++)aw.add(e[n])}var dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hd=Object.prototype.hasOwnProperty,bT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ty={},ny={};function RT(n){return hd.call(ny,n)?!0:hd.call(ty,n)?!1:bT.test(n)?ny[n]=!0:(ty[n]=!0,!1)}function AT(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function $T(n,e,t,r){if(e===null||typeof e>"u"||AT(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fe(n,e,t,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Se={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Se[n]=new Fe(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Se[e]=new Fe(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Se[n]=new Fe(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Se[n]=new Fe(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Se[n]=new Fe(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Se[n]=new Fe(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Se[n]=new Fe(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Se[n]=new Fe(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Se[n]=new Fe(n,5,!1,n.toLowerCase(),null,!1,!1)});var ip=/[\-:]([a-z])/g;function op(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ip,op);Se[e]=new Fe(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ip,op);Se[e]=new Fe(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ip,op);Se[e]=new Fe(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Se[n]=new Fe(n,1,!1,n.toLowerCase(),null,!1,!1)});Se.xlinkHref=new Fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Se[n]=new Fe(n,1,!1,n.toLowerCase(),null,!0,!0)});function sp(n,e,t,r){var i=Se.hasOwnProperty(e)?Se[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&($T(e,t,i,r)&&(t=null),r||i===null?RT(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var gn=lw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wl=Symbol.for("react.element"),xi=Symbol.for("react.portal"),Ci=Symbol.for("react.fragment"),lp=Symbol.for("react.strict_mode"),pd=Symbol.for("react.profiler"),uw=Symbol.for("react.provider"),cw=Symbol.for("react.context"),ap=Symbol.for("react.forward_ref"),md=Symbol.for("react.suspense"),gd=Symbol.for("react.suspense_list"),up=Symbol.for("react.memo"),En=Symbol.for("react.lazy"),fw=Symbol.for("react.offscreen"),ry=Symbol.iterator;function yo(n){return n===null||typeof n!="object"?null:(n=ry&&n[ry]||n["@@iterator"],typeof n=="function"?n:null)}var Y=Object.assign,Bc;function is(n){if(Bc===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Bc=e&&e[1]||""}return`
`+Bc+n}var Jc=!1;function Wc(n,e){if(!n||Jc)return"";Jc=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var a=`
`+i[s].replace(" at new "," at ");return n.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",n.displayName)),a}while(1<=s&&0<=l);break}}}finally{Jc=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?is(n):""}function IT(n){switch(n.tag){case 5:return is(n.type);case 16:return is("Lazy");case 13:return is("Suspense");case 19:return is("SuspenseList");case 0:case 2:case 15:return n=Wc(n.type,!1),n;case 11:return n=Wc(n.type.render,!1),n;case 1:return n=Wc(n.type,!0),n;default:return""}}function yd(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ci:return"Fragment";case xi:return"Portal";case pd:return"Profiler";case lp:return"StrictMode";case md:return"Suspense";case gd:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case cw:return(n.displayName||"Context")+".Consumer";case uw:return(n._context.displayName||"Context")+".Provider";case ap:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case up:return e=n.displayName||null,e!==null?e:yd(n.type)||"Memo";case En:e=n._payload,n=n._init;try{return yd(n(e))}catch{}}return null}function zT(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yd(e);case 8:return e===lp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qn(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function dw(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function PT(n){var e=dw(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Kl(n){n._valueTracker||(n._valueTracker=PT(n))}function hw(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=dw(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function cu(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Sd(n,e){var t=e.checked;return Y({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function iy(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Qn(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function pw(n,e){e=e.checked,e!=null&&sp(n,"checked",e,!1)}function kd(n,e){pw(n,e);var t=Qn(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?wd(n,e.type,t):e.hasOwnProperty("defaultValue")&&wd(n,e.type,Qn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function oy(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function wd(n,e,t){(e!=="number"||cu(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ss=Array.isArray;function Fi(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Qn(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function xd(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(M(91));return Y({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function sy(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(M(92));if(ss(t)){if(1<t.length)throw Error(M(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Qn(t)}}function mw(n,e){var t=Qn(e.value),r=Qn(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function ly(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function gw(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cd(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?gw(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var _l,yw=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(_l=_l||document.createElement("div"),_l.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_l.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Us(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ws={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FT=["Webkit","ms","Moz","O"];Object.keys(ws).forEach(function(n){FT.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ws[e]=ws[n]})});function Sw(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ws.hasOwnProperty(n)&&ws[n]?(""+e).trim():e+"px"}function kw(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=Sw(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var LT=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nd(n,e){if(e){if(LT[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(M(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(M(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(M(61))}if(e.style!=null&&typeof e.style!="object")throw Error(M(62))}}function vd(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ed=null;function cp(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Md=null,Li=null,Vi=null;function ay(n){if(n=Tl(n)){if(typeof Md!="function")throw Error(M(280));var e=n.stateNode;e&&(e=Qu(e),Md(n.stateNode,n.type,e))}}function ww(n){Li?Vi?Vi.push(n):Vi=[n]:Li=n}function xw(){if(Li){var n=Li,e=Vi;if(Vi=Li=null,ay(n),e)for(n=0;n<e.length;n++)ay(e[n])}}function Cw(n,e){return n(e)}function Nw(){}var Kc=!1;function vw(n,e,t){if(Kc)return n(e,t);Kc=!0;try{return Cw(n,e,t)}finally{Kc=!1,(Li!==null||Vi!==null)&&(Nw(),xw())}}function qs(n,e){var t=n.stateNode;if(t===null)return null;var r=Qu(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(M(231,e,typeof t));return t}var Od=!1;if(dn)try{var So={};Object.defineProperty(So,"passive",{get:function(){Od=!0}}),window.addEventListener("test",So,So),window.removeEventListener("test",So,So)}catch{Od=!1}function VT(n,e,t,r,i,o,s,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var xs=!1,fu=null,du=!1,Dd=null,BT={onError:function(n){xs=!0,fu=n}};function JT(n,e,t,r,i,o,s,l,a){xs=!1,fu=null,VT.apply(BT,arguments)}function WT(n,e,t,r,i,o,s,l,a){if(JT.apply(this,arguments),xs){if(xs){var u=fu;xs=!1,fu=null}else throw Error(M(198));du||(du=!0,Dd=u)}}function ei(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Ew(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function uy(n){if(ei(n)!==n)throw Error(M(188))}function KT(n){var e=n.alternate;if(!e){if(e=ei(n),e===null)throw Error(M(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===t)return uy(i),n;if(o===r)return uy(i),e;o=o.sibling}throw Error(M(188))}if(t.return!==r.return)t=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===t){s=!0,t=i,r=o;break}if(l===r){s=!0,r=i,t=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===t){s=!0,t=o,r=i;break}if(l===r){s=!0,r=o,t=i;break}l=l.sibling}if(!s)throw Error(M(189))}}if(t.alternate!==r)throw Error(M(190))}if(t.tag!==3)throw Error(M(188));return t.stateNode.current===t?n:e}function Mw(n){return n=KT(n),n!==null?Ow(n):null}function Ow(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Ow(n);if(e!==null)return e;n=n.sibling}return null}var Dw=at.unstable_scheduleCallback,cy=at.unstable_cancelCallback,_T=at.unstable_shouldYield,HT=at.unstable_requestPaint,te=at.unstable_now,UT=at.unstable_getCurrentPriorityLevel,fp=at.unstable_ImmediatePriority,Tw=at.unstable_UserBlockingPriority,hu=at.unstable_NormalPriority,qT=at.unstable_LowPriority,bw=at.unstable_IdlePriority,Hu=null,Jt=null;function jT(n){if(Jt&&typeof Jt.onCommitFiberRoot=="function")try{Jt.onCommitFiberRoot(Hu,n,void 0,(n.current.flags&128)===128)}catch{}}var bt=Math.clz32?Math.clz32:YT,QT=Math.log,GT=Math.LN2;function YT(n){return n>>>=0,n===0?32:31-(QT(n)/GT|0)|0}var Hl=64,Ul=4194304;function ls(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function pu(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,o=n.pingedLanes,s=t&268435455;if(s!==0){var l=s&~i;l!==0?r=ls(l):(o&=s,o!==0&&(r=ls(o)))}else s=t&~i,s!==0?r=ls(s):o!==0&&(r=ls(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-bt(e),i=1<<t,r|=n[t],e&=~i;return r}function XT(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZT(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,o=n.pendingLanes;0<o;){var s=31-bt(o),l=1<<s,a=i[s];a===-1?(!(l&t)||l&r)&&(i[s]=XT(l,e)):a<=e&&(n.expiredLanes|=l),o&=~l}}function Td(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Rw(){var n=Hl;return Hl<<=1,!(Hl&4194240)&&(Hl=64),n}function _c(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ol(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-bt(e),n[e]=t}function eb(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-bt(t),o=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~o}}function dp(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-bt(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var K=0;function Aw(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var $w,hp,Iw,zw,Pw,bd=!1,ql=[],Bn=null,Jn=null,Wn=null,js=new Map,Qs=new Map,Tn=[],tb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fy(n,e){switch(n){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":Jn=null;break;case"mouseover":case"mouseout":Wn=null;break;case"pointerover":case"pointerout":js.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qs.delete(e.pointerId)}}function ko(n,e,t,r,i,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Tl(e),e!==null&&hp(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function nb(n,e,t,r,i){switch(e){case"focusin":return Bn=ko(Bn,n,e,t,r,i),!0;case"dragenter":return Jn=ko(Jn,n,e,t,r,i),!0;case"mouseover":return Wn=ko(Wn,n,e,t,r,i),!0;case"pointerover":var o=i.pointerId;return js.set(o,ko(js.get(o)||null,n,e,t,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Qs.set(o,ko(Qs.get(o)||null,n,e,t,r,i)),!0}return!1}function Fw(n){var e=Er(n.target);if(e!==null){var t=ei(e);if(t!==null){if(e=t.tag,e===13){if(e=Ew(t),e!==null){n.blockedOn=e,Pw(n.priority,function(){Iw(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function $a(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Rd(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Ed=r,t.target.dispatchEvent(r),Ed=null}else return e=Tl(t),e!==null&&hp(e),n.blockedOn=t,!1;e.shift()}return!0}function dy(n,e,t){$a(n)&&t.delete(e)}function rb(){bd=!1,Bn!==null&&$a(Bn)&&(Bn=null),Jn!==null&&$a(Jn)&&(Jn=null),Wn!==null&&$a(Wn)&&(Wn=null),js.forEach(dy),Qs.forEach(dy)}function wo(n,e){n.blockedOn===e&&(n.blockedOn=null,bd||(bd=!0,at.unstable_scheduleCallback(at.unstable_NormalPriority,rb)))}function Gs(n){function e(i){return wo(i,n)}if(0<ql.length){wo(ql[0],n);for(var t=1;t<ql.length;t++){var r=ql[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Bn!==null&&wo(Bn,n),Jn!==null&&wo(Jn,n),Wn!==null&&wo(Wn,n),js.forEach(e),Qs.forEach(e),t=0;t<Tn.length;t++)r=Tn[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Tn.length&&(t=Tn[0],t.blockedOn===null);)Fw(t),t.blockedOn===null&&Tn.shift()}var Bi=gn.ReactCurrentBatchConfig,mu=!0;function ib(n,e,t,r){var i=K,o=Bi.transition;Bi.transition=null;try{K=1,pp(n,e,t,r)}finally{K=i,Bi.transition=o}}function ob(n,e,t,r){var i=K,o=Bi.transition;Bi.transition=null;try{K=4,pp(n,e,t,r)}finally{K=i,Bi.transition=o}}function pp(n,e,t,r){if(mu){var i=Rd(n,e,t,r);if(i===null)ef(n,e,r,gu,t),fy(n,r);else if(nb(i,n,e,t,r))r.stopPropagation();else if(fy(n,r),e&4&&-1<tb.indexOf(n)){for(;i!==null;){var o=Tl(i);if(o!==null&&$w(o),o=Rd(n,e,t,r),o===null&&ef(n,e,r,gu,t),o===i)break;i=o}i!==null&&r.stopPropagation()}else ef(n,e,r,null,t)}}var gu=null;function Rd(n,e,t,r){if(gu=null,n=cp(r),n=Er(n),n!==null)if(e=ei(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Ew(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return gu=n,null}function Lw(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(UT()){case fp:return 1;case Tw:return 4;case hu:case qT:return 16;case bw:return 536870912;default:return 16}default:return 16}}var Pn=null,mp=null,Ia=null;function Vw(){if(Ia)return Ia;var n,e=mp,t=e.length,r,i="value"in Pn?Pn.value:Pn.textContent,o=i.length;for(n=0;n<t&&e[n]===i[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===i[o-r];r++);return Ia=i.slice(n,1<r?1-r:void 0)}function za(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function jl(){return!0}function hy(){return!1}function ct(n){function e(t,r,i,o,s){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?jl:hy,this.isPropagationStopped=hy,this}return Y(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=jl)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=jl)},persist:function(){},isPersistent:jl}),e}var ho={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gp=ct(ho),Dl=Y({},ho,{view:0,detail:0}),sb=ct(Dl),Hc,Uc,xo,Uu=Y({},Dl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yp,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==xo&&(xo&&n.type==="mousemove"?(Hc=n.screenX-xo.screenX,Uc=n.screenY-xo.screenY):Uc=Hc=0,xo=n),Hc)},movementY:function(n){return"movementY"in n?n.movementY:Uc}}),py=ct(Uu),lb=Y({},Uu,{dataTransfer:0}),ab=ct(lb),ub=Y({},Dl,{relatedTarget:0}),qc=ct(ub),cb=Y({},ho,{animationName:0,elapsedTime:0,pseudoElement:0}),fb=ct(cb),db=Y({},ho,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),hb=ct(db),pb=Y({},ho,{data:0}),my=ct(pb),mb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sb(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=yb[n])?!!e[n]:!1}function yp(){return Sb}var kb=Y({},Dl,{key:function(n){if(n.key){var e=mb[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=za(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?gb[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yp,charCode:function(n){return n.type==="keypress"?za(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?za(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),wb=ct(kb),xb=Y({},Uu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gy=ct(xb),Cb=Y({},Dl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yp}),Nb=ct(Cb),vb=Y({},ho,{propertyName:0,elapsedTime:0,pseudoElement:0}),Eb=ct(vb),Mb=Y({},Uu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ob=ct(Mb),Db=[9,13,27,32],Sp=dn&&"CompositionEvent"in window,Cs=null;dn&&"documentMode"in document&&(Cs=document.documentMode);var Tb=dn&&"TextEvent"in window&&!Cs,Bw=dn&&(!Sp||Cs&&8<Cs&&11>=Cs),yy=" ",Sy=!1;function Jw(n,e){switch(n){case"keyup":return Db.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ww(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ni=!1;function bb(n,e){switch(n){case"compositionend":return Ww(e);case"keypress":return e.which!==32?null:(Sy=!0,yy);case"textInput":return n=e.data,n===yy&&Sy?null:n;default:return null}}function Rb(n,e){if(Ni)return n==="compositionend"||!Sp&&Jw(n,e)?(n=Vw(),Ia=mp=Pn=null,Ni=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bw&&e.locale!=="ko"?null:e.data;default:return null}}var Ab={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ky(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Ab[n.type]:e==="textarea"}function Kw(n,e,t,r){ww(r),e=yu(e,"onChange"),0<e.length&&(t=new gp("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Ns=null,Ys=null;function $b(n){ex(n,0)}function qu(n){var e=Mi(n);if(hw(e))return n}function Ib(n,e){if(n==="change")return e}var _w=!1;if(dn){var jc;if(dn){var Qc="oninput"in document;if(!Qc){var wy=document.createElement("div");wy.setAttribute("oninput","return;"),Qc=typeof wy.oninput=="function"}jc=Qc}else jc=!1;_w=jc&&(!document.documentMode||9<document.documentMode)}function xy(){Ns&&(Ns.detachEvent("onpropertychange",Hw),Ys=Ns=null)}function Hw(n){if(n.propertyName==="value"&&qu(Ys)){var e=[];Kw(e,Ys,n,cp(n)),vw($b,e)}}function zb(n,e,t){n==="focusin"?(xy(),Ns=e,Ys=t,Ns.attachEvent("onpropertychange",Hw)):n==="focusout"&&xy()}function Pb(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return qu(Ys)}function Fb(n,e){if(n==="click")return qu(e)}function Lb(n,e){if(n==="input"||n==="change")return qu(e)}function Vb(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var $t=typeof Object.is=="function"?Object.is:Vb;function Xs(n,e){if($t(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!hd.call(e,i)||!$t(n[i],e[i]))return!1}return!0}function Cy(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Ny(n,e){var t=Cy(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Cy(t)}}function Uw(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Uw(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function qw(){for(var n=window,e=cu();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=cu(n.document)}return e}function kp(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Bb(n){var e=qw(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Uw(t.ownerDocument.documentElement,t)){if(r!==null&&kp(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!n.extend&&o>r&&(i=r,r=o,o=i),i=Ny(t,o);var s=Ny(t,r);i&&s&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Jb=dn&&"documentMode"in document&&11>=document.documentMode,vi=null,Ad=null,vs=null,$d=!1;function vy(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;$d||vi==null||vi!==cu(r)||(r=vi,"selectionStart"in r&&kp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vs&&Xs(vs,r)||(vs=r,r=yu(Ad,"onSelect"),0<r.length&&(e=new gp("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=vi)))}function Ql(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ei={animationend:Ql("Animation","AnimationEnd"),animationiteration:Ql("Animation","AnimationIteration"),animationstart:Ql("Animation","AnimationStart"),transitionend:Ql("Transition","TransitionEnd")},Gc={},jw={};dn&&(jw=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);function ju(n){if(Gc[n])return Gc[n];if(!Ei[n])return n;var e=Ei[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in jw)return Gc[n]=e[t];return n}var Qw=ju("animationend"),Gw=ju("animationiteration"),Yw=ju("animationstart"),Xw=ju("transitionend"),Zw=new Map,Ey="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rr(n,e){Zw.set(n,e),Zr(e,[n])}for(var Yc=0;Yc<Ey.length;Yc++){var Xc=Ey[Yc],Wb=Xc.toLowerCase(),Kb=Xc[0].toUpperCase()+Xc.slice(1);rr(Wb,"on"+Kb)}rr(Qw,"onAnimationEnd");rr(Gw,"onAnimationIteration");rr(Yw,"onAnimationStart");rr("dblclick","onDoubleClick");rr("focusin","onFocus");rr("focusout","onBlur");rr(Xw,"onTransitionEnd");eo("onMouseEnter",["mouseout","mouseover"]);eo("onMouseLeave",["mouseout","mouseover"]);eo("onPointerEnter",["pointerout","pointerover"]);eo("onPointerLeave",["pointerout","pointerover"]);Zr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var as="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_b=new Set("cancel close invalid load scroll toggle".split(" ").concat(as));function My(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,WT(r,e,void 0,n),n.currentTarget=null}function ex(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var l=r[s],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&i.isPropagationStopped())break e;My(i,l,u),o=a}else for(s=0;s<r.length;s++){if(l=r[s],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&i.isPropagationStopped())break e;My(i,l,u),o=a}}}if(du)throw n=Dd,du=!1,Dd=null,n}function U(n,e){var t=e[Ld];t===void 0&&(t=e[Ld]=new Set);var r=n+"__bubble";t.has(r)||(tx(e,n,2,!1),t.add(r))}function Zc(n,e,t){var r=0;e&&(r|=4),tx(t,n,r,e)}var Gl="_reactListening"+Math.random().toString(36).slice(2);function Zs(n){if(!n[Gl]){n[Gl]=!0,aw.forEach(function(t){t!=="selectionchange"&&(_b.has(t)||Zc(t,!1,n),Zc(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Gl]||(e[Gl]=!0,Zc("selectionchange",!1,e))}}function tx(n,e,t,r){switch(Lw(e)){case 1:var i=ib;break;case 4:i=ob;break;default:i=pp}t=i.bind(null,e,t,n),i=void 0,!Od||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function ef(n,e,t,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;s=s.return}for(;l!==null;){if(s=Er(l),s===null)return;if(a=s.tag,a===5||a===6){r=o=s;continue e}l=l.parentNode}}r=r.return}vw(function(){var u=o,c=cp(t),f=[];e:{var d=Zw.get(n);if(d!==void 0){var h=gp,p=n;switch(n){case"keypress":if(za(t)===0)break e;case"keydown":case"keyup":h=wb;break;case"focusin":p="focus",h=qc;break;case"focusout":p="blur",h=qc;break;case"beforeblur":case"afterblur":h=qc;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=py;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=ab;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Nb;break;case Qw:case Gw:case Yw:h=fb;break;case Xw:h=Eb;break;case"scroll":h=sb;break;case"wheel":h=Ob;break;case"copy":case"cut":case"paste":h=hb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=gy}var m=(e&4)!==0,S=!m&&n==="scroll",g=m?d!==null?d+"Capture":null:d;m=[];for(var y=u,k;y!==null;){k=y;var N=k.stateNode;if(k.tag===5&&N!==null&&(k=N,g!==null&&(N=qs(y,g),N!=null&&m.push(el(y,N,k)))),S)break;y=y.return}0<m.length&&(d=new h(d,p,null,t,c),f.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",h=n==="mouseout"||n==="pointerout",d&&t!==Ed&&(p=t.relatedTarget||t.fromElement)&&(Er(p)||p[hn]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(p=t.relatedTarget||t.toElement,h=u,p=p?Er(p):null,p!==null&&(S=ei(p),p!==S||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(m=py,N="onMouseLeave",g="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(m=gy,N="onPointerLeave",g="onPointerEnter",y="pointer"),S=h==null?d:Mi(h),k=p==null?d:Mi(p),d=new m(N,y+"leave",h,t,c),d.target=S,d.relatedTarget=k,N=null,Er(c)===u&&(m=new m(g,y+"enter",p,t,c),m.target=k,m.relatedTarget=S,N=m),S=N,h&&p)t:{for(m=h,g=p,y=0,k=m;k;k=li(k))y++;for(k=0,N=g;N;N=li(N))k++;for(;0<y-k;)m=li(m),y--;for(;0<k-y;)g=li(g),k--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=li(m),g=li(g)}m=null}else m=null;h!==null&&Oy(f,d,h,m,!1),p!==null&&S!==null&&Oy(f,S,p,m,!0)}}e:{if(d=u?Mi(u):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var E=Ib;else if(ky(d))if(_w)E=Lb;else{E=Pb;var v=zb}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=Fb);if(E&&(E=E(n,u))){Kw(f,E,t,c);break e}v&&v(n,d,u),n==="focusout"&&(v=d._wrapperState)&&v.controlled&&d.type==="number"&&wd(d,"number",d.value)}switch(v=u?Mi(u):window,n){case"focusin":(ky(v)||v.contentEditable==="true")&&(vi=v,Ad=u,vs=null);break;case"focusout":vs=Ad=vi=null;break;case"mousedown":$d=!0;break;case"contextmenu":case"mouseup":case"dragend":$d=!1,vy(f,t,c);break;case"selectionchange":if(Jb)break;case"keydown":case"keyup":vy(f,t,c)}var D;if(Sp)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Ni?Jw(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(Bw&&t.locale!=="ko"&&(Ni||T!=="onCompositionStart"?T==="onCompositionEnd"&&Ni&&(D=Vw()):(Pn=c,mp="value"in Pn?Pn.value:Pn.textContent,Ni=!0)),v=yu(u,T),0<v.length&&(T=new my(T,n,null,t,c),f.push({event:T,listeners:v}),D?T.data=D:(D=Ww(t),D!==null&&(T.data=D)))),(D=Tb?bb(n,t):Rb(n,t))&&(u=yu(u,"onBeforeInput"),0<u.length&&(c=new my("onBeforeInput","beforeinput",null,t,c),f.push({event:c,listeners:u}),c.data=D))}ex(f,e)})}function el(n,e,t){return{instance:n,listener:e,currentTarget:t}}function yu(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=qs(n,t),o!=null&&r.unshift(el(n,o,i)),o=qs(n,e),o!=null&&r.push(el(n,o,i))),n=n.return}return r}function li(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Oy(n,e,t,r,i){for(var o=e._reactName,s=[];t!==null&&t!==r;){var l=t,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=qs(t,o),a!=null&&s.unshift(el(t,a,l))):i||(a=qs(t,o),a!=null&&s.push(el(t,a,l)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var Hb=/\r\n?/g,Ub=/\u0000|\uFFFD/g;function Dy(n){return(typeof n=="string"?n:""+n).replace(Hb,`
`).replace(Ub,"")}function Yl(n,e,t){if(e=Dy(e),Dy(n)!==e&&t)throw Error(M(425))}function Su(){}var Id=null,zd=null;function Pd(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fd=typeof setTimeout=="function"?setTimeout:void 0,qb=typeof clearTimeout=="function"?clearTimeout:void 0,Ty=typeof Promise=="function"?Promise:void 0,jb=typeof queueMicrotask=="function"?queueMicrotask:typeof Ty<"u"?function(n){return Ty.resolve(null).then(n).catch(Qb)}:Fd;function Qb(n){setTimeout(function(){throw n})}function tf(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Gs(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Gs(e)}function Kn(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function by(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var po=Math.random().toString(36).slice(2),Lt="__reactFiber$"+po,tl="__reactProps$"+po,hn="__reactContainer$"+po,Ld="__reactEvents$"+po,Gb="__reactListeners$"+po,Yb="__reactHandles$"+po;function Er(n){var e=n[Lt];if(e)return e;for(var t=n.parentNode;t;){if(e=t[hn]||t[Lt]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=by(n);n!==null;){if(t=n[Lt])return t;n=by(n)}return e}n=t,t=n.parentNode}return null}function Tl(n){return n=n[Lt]||n[hn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Mi(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(M(33))}function Qu(n){return n[tl]||null}var Vd=[],Oi=-1;function ir(n){return{current:n}}function q(n){0>Oi||(n.current=Vd[Oi],Vd[Oi]=null,Oi--)}function H(n,e){Oi++,Vd[Oi]=n.current,n.current=e}var Gn={},Ee=ir(Gn),qe=ir(!1),Wr=Gn;function to(n,e){var t=n.type.contextTypes;if(!t)return Gn;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in t)i[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function je(n){return n=n.childContextTypes,n!=null}function ku(){q(qe),q(Ee)}function Ry(n,e,t){if(Ee.current!==Gn)throw Error(M(168));H(Ee,e),H(qe,t)}function nx(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(M(108,zT(n)||"Unknown",i));return Y({},t,r)}function wu(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Gn,Wr=Ee.current,H(Ee,n),H(qe,qe.current),!0}function Ay(n,e,t){var r=n.stateNode;if(!r)throw Error(M(169));t?(n=nx(n,e,Wr),r.__reactInternalMemoizedMergedChildContext=n,q(qe),q(Ee),H(Ee,n)):q(qe),H(qe,t)}var sn=null,Gu=!1,nf=!1;function rx(n){sn===null?sn=[n]:sn.push(n)}function Xb(n){Gu=!0,rx(n)}function or(){if(!nf&&sn!==null){nf=!0;var n=0,e=K;try{var t=sn;for(K=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}sn=null,Gu=!1}catch(i){throw sn!==null&&(sn=sn.slice(n+1)),Dw(fp,or),i}finally{K=e,nf=!1}}return null}var Di=[],Ti=0,xu=null,Cu=0,pt=[],mt=0,Kr=null,an=1,un="";function yr(n,e){Di[Ti++]=Cu,Di[Ti++]=xu,xu=n,Cu=e}function ix(n,e,t){pt[mt++]=an,pt[mt++]=un,pt[mt++]=Kr,Kr=n;var r=an;n=un;var i=32-bt(r)-1;r&=~(1<<i),t+=1;var o=32-bt(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,an=1<<32-bt(e)+i|t<<i|r,un=o+n}else an=1<<o|t<<i|r,un=n}function wp(n){n.return!==null&&(yr(n,1),ix(n,1,0))}function xp(n){for(;n===xu;)xu=Di[--Ti],Di[Ti]=null,Cu=Di[--Ti],Di[Ti]=null;for(;n===Kr;)Kr=pt[--mt],pt[mt]=null,un=pt[--mt],pt[mt]=null,an=pt[--mt],pt[mt]=null}var ot=null,it=null,j=!1,Tt=null;function ox(n,e){var t=kt(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function $y(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,ot=n,it=Kn(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,ot=n,it=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Kr!==null?{id:an,overflow:un}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=kt(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,ot=n,it=null,!0):!1;default:return!1}}function Bd(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Jd(n){if(j){var e=it;if(e){var t=e;if(!$y(n,e)){if(Bd(n))throw Error(M(418));e=Kn(t.nextSibling);var r=ot;e&&$y(n,e)?ox(r,t):(n.flags=n.flags&-4097|2,j=!1,ot=n)}}else{if(Bd(n))throw Error(M(418));n.flags=n.flags&-4097|2,j=!1,ot=n}}}function Iy(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ot=n}function Xl(n){if(n!==ot)return!1;if(!j)return Iy(n),j=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Pd(n.type,n.memoizedProps)),e&&(e=it)){if(Bd(n))throw sx(),Error(M(418));for(;e;)ox(n,e),e=Kn(e.nextSibling)}if(Iy(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(M(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){it=Kn(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}it=null}}else it=ot?Kn(n.stateNode.nextSibling):null;return!0}function sx(){for(var n=it;n;)n=Kn(n.nextSibling)}function no(){it=ot=null,j=!1}function Cp(n){Tt===null?Tt=[n]:Tt.push(n)}var Zb=gn.ReactCurrentBatchConfig;function Ot(n,e){if(n&&n.defaultProps){e=Y({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var Nu=ir(null),vu=null,bi=null,Np=null;function vp(){Np=bi=vu=null}function Ep(n){var e=Nu.current;q(Nu),n._currentValue=e}function Wd(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Ji(n,e){vu=n,Np=bi=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(He=!0),n.firstContext=null)}function Nt(n){var e=n._currentValue;if(Np!==n)if(n={context:n,memoizedValue:e,next:null},bi===null){if(vu===null)throw Error(M(308));bi=n,vu.dependencies={lanes:0,firstContext:n}}else bi=bi.next=n;return e}var Mr=null;function Mp(n){Mr===null?Mr=[n]:Mr.push(n)}function lx(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Mp(e)):(t.next=i.next,i.next=t),e.interleaved=t,pn(n,r)}function pn(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Mn=!1;function Op(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ax(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function fn(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function _n(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,B&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,pn(n,t)}return i=r.interleaved,i===null?(e.next=e,Mp(r)):(e.next=i.next,i.next=e),r.interleaved=e,pn(n,t)}function Pa(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,dp(n,t)}}function zy(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?i=o=s:o=o.next=s,t=t.next}while(t!==null);o===null?i=o=e:o=o.next=e}else i=o=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Eu(n,e,t,r){var i=n.updateQueue;Mn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,s===null?o=u:s.next=u,s=a;var c=n.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==s&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(o!==null){var f=i.baseState;s=0,c=u=a=null,l=o;do{var d=l.lane,h=l.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=n,m=l;switch(d=e,h=t,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(h,f,d):p,d==null)break e;f=Y({},f,d);break e;case 2:Mn=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[l]:d.push(l))}else h={eventTime:h,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=h,a=f):c=c.next=h,s|=d;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;d=l,l=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Hr|=s,n.lanes=s,n.memoizedState=f}}function Py(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(M(191,i));i.call(r)}}}var ux=new lw.Component().refs;function Kd(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Y({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Yu={isMounted:function(n){return(n=n._reactInternals)?ei(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Ae(),i=Un(n),o=fn(r,i);o.payload=e,t!=null&&(o.callback=t),e=_n(n,o,i),e!==null&&(Rt(e,n,i,r),Pa(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Ae(),i=Un(n),o=fn(r,i);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=_n(n,o,i),e!==null&&(Rt(e,n,i,r),Pa(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Ae(),r=Un(n),i=fn(t,r);i.tag=2,e!=null&&(i.callback=e),e=_n(n,i,r),e!==null&&(Rt(e,n,r,t),Pa(e,n,r))}};function Fy(n,e,t,r,i,o,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Xs(t,r)||!Xs(i,o):!0}function cx(n,e,t){var r=!1,i=Gn,o=e.contextType;return typeof o=="object"&&o!==null?o=Nt(o):(i=je(e)?Wr:Ee.current,r=e.contextTypes,o=(r=r!=null)?to(n,i):Gn),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yu,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=o),e}function Ly(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Yu.enqueueReplaceState(e,e.state,null)}function _d(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=ux,Op(n);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Nt(o):(o=je(e)?Wr:Ee.current,i.context=to(n,o)),i.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Kd(n,e,o,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Yu.enqueueReplaceState(i,i.state,null),Eu(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Co(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(M(309));var r=t.stateNode}if(!r)throw Error(M(147,n));var i=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;l===ux&&(l=i.refs={}),s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof n!="string")throw Error(M(284));if(!t._owner)throw Error(M(290,n))}return n}function Zl(n,e){throw n=Object.prototype.toString.call(e),Error(M(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Vy(n){var e=n._init;return e(n._payload)}function fx(n){function e(g,y){if(n){var k=g.deletions;k===null?(g.deletions=[y],g.flags|=16):k.push(y)}}function t(g,y){if(!n)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=qn(g,y),g.index=0,g.sibling=null,g}function o(g,y,k){return g.index=k,n?(k=g.alternate,k!==null?(k=k.index,k<y?(g.flags|=2,y):k):(g.flags|=2,y)):(g.flags|=1048576,y)}function s(g){return n&&g.alternate===null&&(g.flags|=2),g}function l(g,y,k,N){return y===null||y.tag!==6?(y=cf(k,g.mode,N),y.return=g,y):(y=i(y,k),y.return=g,y)}function a(g,y,k,N){var E=k.type;return E===Ci?c(g,y,k.props.children,N,k.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===En&&Vy(E)===y.type)?(N=i(y,k.props),N.ref=Co(g,y,k),N.return=g,N):(N=Wa(k.type,k.key,k.props,null,g.mode,N),N.ref=Co(g,y,k),N.return=g,N)}function u(g,y,k,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==k.containerInfo||y.stateNode.implementation!==k.implementation?(y=ff(k,g.mode,N),y.return=g,y):(y=i(y,k.children||[]),y.return=g,y)}function c(g,y,k,N,E){return y===null||y.tag!==7?(y=Fr(k,g.mode,N,E),y.return=g,y):(y=i(y,k),y.return=g,y)}function f(g,y,k){if(typeof y=="string"&&y!==""||typeof y=="number")return y=cf(""+y,g.mode,k),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Wl:return k=Wa(y.type,y.key,y.props,null,g.mode,k),k.ref=Co(g,null,y),k.return=g,k;case xi:return y=ff(y,g.mode,k),y.return=g,y;case En:var N=y._init;return f(g,N(y._payload),k)}if(ss(y)||yo(y))return y=Fr(y,g.mode,k,null),y.return=g,y;Zl(g,y)}return null}function d(g,y,k,N){var E=y!==null?y.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return E!==null?null:l(g,y,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Wl:return k.key===E?a(g,y,k,N):null;case xi:return k.key===E?u(g,y,k,N):null;case En:return E=k._init,d(g,y,E(k._payload),N)}if(ss(k)||yo(k))return E!==null?null:c(g,y,k,N,null);Zl(g,k)}return null}function h(g,y,k,N,E){if(typeof N=="string"&&N!==""||typeof N=="number")return g=g.get(k)||null,l(y,g,""+N,E);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Wl:return g=g.get(N.key===null?k:N.key)||null,a(y,g,N,E);case xi:return g=g.get(N.key===null?k:N.key)||null,u(y,g,N,E);case En:var v=N._init;return h(g,y,k,v(N._payload),E)}if(ss(N)||yo(N))return g=g.get(k)||null,c(y,g,N,E,null);Zl(y,N)}return null}function p(g,y,k,N){for(var E=null,v=null,D=y,T=y=0,I=null;D!==null&&T<k.length;T++){D.index>T?(I=D,D=null):I=D.sibling;var P=d(g,D,k[T],N);if(P===null){D===null&&(D=I);break}n&&D&&P.alternate===null&&e(g,D),y=o(P,y,T),v===null?E=P:v.sibling=P,v=P,D=I}if(T===k.length)return t(g,D),j&&yr(g,T),E;if(D===null){for(;T<k.length;T++)D=f(g,k[T],N),D!==null&&(y=o(D,y,T),v===null?E=D:v.sibling=D,v=D);return j&&yr(g,T),E}for(D=r(g,D);T<k.length;T++)I=h(D,g,T,k[T],N),I!==null&&(n&&I.alternate!==null&&D.delete(I.key===null?T:I.key),y=o(I,y,T),v===null?E=I:v.sibling=I,v=I);return n&&D.forEach(function(le){return e(g,le)}),j&&yr(g,T),E}function m(g,y,k,N){var E=yo(k);if(typeof E!="function")throw Error(M(150));if(k=E.call(k),k==null)throw Error(M(151));for(var v=E=null,D=y,T=y=0,I=null,P=k.next();D!==null&&!P.done;T++,P=k.next()){D.index>T?(I=D,D=null):I=D.sibling;var le=d(g,D,P.value,N);if(le===null){D===null&&(D=I);break}n&&D&&le.alternate===null&&e(g,D),y=o(le,y,T),v===null?E=le:v.sibling=le,v=le,D=I}if(P.done)return t(g,D),j&&yr(g,T),E;if(D===null){for(;!P.done;T++,P=k.next())P=f(g,P.value,N),P!==null&&(y=o(P,y,T),v===null?E=P:v.sibling=P,v=P);return j&&yr(g,T),E}for(D=r(g,D);!P.done;T++,P=k.next())P=h(D,g,T,P.value,N),P!==null&&(n&&P.alternate!==null&&D.delete(P.key===null?T:P.key),y=o(P,y,T),v===null?E=P:v.sibling=P,v=P);return n&&D.forEach(function(Zt){return e(g,Zt)}),j&&yr(g,T),E}function S(g,y,k,N){if(typeof k=="object"&&k!==null&&k.type===Ci&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case Wl:e:{for(var E=k.key,v=y;v!==null;){if(v.key===E){if(E=k.type,E===Ci){if(v.tag===7){t(g,v.sibling),y=i(v,k.props.children),y.return=g,g=y;break e}}else if(v.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===En&&Vy(E)===v.type){t(g,v.sibling),y=i(v,k.props),y.ref=Co(g,v,k),y.return=g,g=y;break e}t(g,v);break}else e(g,v);v=v.sibling}k.type===Ci?(y=Fr(k.props.children,g.mode,N,k.key),y.return=g,g=y):(N=Wa(k.type,k.key,k.props,null,g.mode,N),N.ref=Co(g,y,k),N.return=g,g=N)}return s(g);case xi:e:{for(v=k.key;y!==null;){if(y.key===v)if(y.tag===4&&y.stateNode.containerInfo===k.containerInfo&&y.stateNode.implementation===k.implementation){t(g,y.sibling),y=i(y,k.children||[]),y.return=g,g=y;break e}else{t(g,y);break}else e(g,y);y=y.sibling}y=ff(k,g.mode,N),y.return=g,g=y}return s(g);case En:return v=k._init,S(g,y,v(k._payload),N)}if(ss(k))return p(g,y,k,N);if(yo(k))return m(g,y,k,N);Zl(g,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,y!==null&&y.tag===6?(t(g,y.sibling),y=i(y,k),y.return=g,g=y):(t(g,y),y=cf(k,g.mode,N),y.return=g,g=y),s(g)):t(g,y)}return S}var ro=fx(!0),dx=fx(!1),bl={},Wt=ir(bl),nl=ir(bl),rl=ir(bl);function Or(n){if(n===bl)throw Error(M(174));return n}function Dp(n,e){switch(H(rl,e),H(nl,n),H(Wt,bl),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cd(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Cd(e,n)}q(Wt),H(Wt,e)}function io(){q(Wt),q(nl),q(rl)}function hx(n){Or(rl.current);var e=Or(Wt.current),t=Cd(e,n.type);e!==t&&(H(nl,n),H(Wt,t))}function Tp(n){nl.current===n&&(q(Wt),q(nl))}var Q=ir(0);function Mu(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rf=[];function bp(){for(var n=0;n<rf.length;n++)rf[n]._workInProgressVersionPrimary=null;rf.length=0}var Fa=gn.ReactCurrentDispatcher,of=gn.ReactCurrentBatchConfig,_r=0,G=null,ie=null,ue=null,Ou=!1,Es=!1,il=0,eR=0;function ke(){throw Error(M(321))}function Rp(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!$t(n[t],e[t]))return!1;return!0}function Ap(n,e,t,r,i,o){if(_r=o,G=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fa.current=n===null||n.memoizedState===null?iR:oR,n=t(r,i),Es){o=0;do{if(Es=!1,il=0,25<=o)throw Error(M(301));o+=1,ue=ie=null,e.updateQueue=null,Fa.current=sR,n=t(r,i)}while(Es)}if(Fa.current=Du,e=ie!==null&&ie.next!==null,_r=0,ue=ie=G=null,Ou=!1,e)throw Error(M(300));return n}function $p(){var n=il!==0;return il=0,n}function Ft(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ue===null?G.memoizedState=ue=n:ue=ue.next=n,ue}function vt(){if(ie===null){var n=G.alternate;n=n!==null?n.memoizedState:null}else n=ie.next;var e=ue===null?G.memoizedState:ue.next;if(e!==null)ue=e,ie=n;else{if(n===null)throw Error(M(310));ie=n,n={memoizedState:ie.memoizedState,baseState:ie.baseState,baseQueue:ie.baseQueue,queue:ie.queue,next:null},ue===null?G.memoizedState=ue=n:ue=ue.next=n}return ue}function ol(n,e){return typeof e=="function"?e(n):e}function sf(n){var e=vt(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var r=ie,i=r.baseQueue,o=t.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,t.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=s=null,a=null,u=o;do{var c=u.lane;if((_r&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,s=r):a=a.next=f,G.lanes|=c,Hr|=c}u=u.next}while(u!==null&&u!==o);a===null?s=r:a.next=l,$t(r,e.memoizedState)||(He=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=a,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do o=i.lane,G.lanes|=o,Hr|=o,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function lf(n){var e=vt(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,o=e.memoizedState;if(i!==null){t.pending=null;var s=i=i.next;do o=n(o,s.action),s=s.next;while(s!==i);$t(o,e.memoizedState)||(He=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function px(){}function mx(n,e){var t=G,r=vt(),i=e(),o=!$t(r.memoizedState,i);if(o&&(r.memoizedState=i,He=!0),r=r.queue,Ip(Sx.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||ue!==null&&ue.memoizedState.tag&1){if(t.flags|=2048,sl(9,yx.bind(null,t,r,i,e),void 0,null),fe===null)throw Error(M(349));_r&30||gx(t,e,i)}return i}function gx(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=G.updateQueue,e===null?(e={lastEffect:null,stores:null},G.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function yx(n,e,t,r){e.value=t,e.getSnapshot=r,kx(e)&&wx(n)}function Sx(n,e,t){return t(function(){kx(e)&&wx(n)})}function kx(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!$t(n,t)}catch{return!0}}function wx(n){var e=pn(n,1);e!==null&&Rt(e,n,1,-1)}function By(n){var e=Ft();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ol,lastRenderedState:n},e.queue=n,n=n.dispatch=rR.bind(null,G,n),[e.memoizedState,n]}function sl(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=G.updateQueue,e===null?(e={lastEffect:null,stores:null},G.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function xx(){return vt().memoizedState}function La(n,e,t,r){var i=Ft();G.flags|=n,i.memoizedState=sl(1|e,t,void 0,r===void 0?null:r)}function Xu(n,e,t,r){var i=vt();r=r===void 0?null:r;var o=void 0;if(ie!==null){var s=ie.memoizedState;if(o=s.destroy,r!==null&&Rp(r,s.deps)){i.memoizedState=sl(e,t,o,r);return}}G.flags|=n,i.memoizedState=sl(1|e,t,o,r)}function Jy(n,e){return La(8390656,8,n,e)}function Ip(n,e){return Xu(2048,8,n,e)}function Cx(n,e){return Xu(4,2,n,e)}function Nx(n,e){return Xu(4,4,n,e)}function vx(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Ex(n,e,t){return t=t!=null?t.concat([n]):null,Xu(4,4,vx.bind(null,e,n),t)}function zp(){}function Mx(n,e){var t=vt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Rp(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function Ox(n,e){var t=vt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Rp(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function Dx(n,e,t){return _r&21?($t(t,e)||(t=Rw(),G.lanes|=t,Hr|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,He=!0),n.memoizedState=t)}function tR(n,e){var t=K;K=t!==0&&4>t?t:4,n(!0);var r=of.transition;of.transition={};try{n(!1),e()}finally{K=t,of.transition=r}}function Tx(){return vt().memoizedState}function nR(n,e,t){var r=Un(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},bx(n))Rx(e,t);else if(t=lx(n,e,t,r),t!==null){var i=Ae();Rt(t,n,r,i),Ax(t,e,r)}}function rR(n,e,t){var r=Un(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(bx(n))Rx(e,i);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,t);if(i.hasEagerState=!0,i.eagerState=l,$t(l,s)){var a=e.interleaved;a===null?(i.next=i,Mp(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}t=lx(n,e,i,r),t!==null&&(i=Ae(),Rt(t,n,r,i),Ax(t,e,r))}}function bx(n){var e=n.alternate;return n===G||e!==null&&e===G}function Rx(n,e){Es=Ou=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Ax(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,dp(n,t)}}var Du={readContext:Nt,useCallback:ke,useContext:ke,useEffect:ke,useImperativeHandle:ke,useInsertionEffect:ke,useLayoutEffect:ke,useMemo:ke,useReducer:ke,useRef:ke,useState:ke,useDebugValue:ke,useDeferredValue:ke,useTransition:ke,useMutableSource:ke,useSyncExternalStore:ke,useId:ke,unstable_isNewReconciler:!1},iR={readContext:Nt,useCallback:function(n,e){return Ft().memoizedState=[n,e===void 0?null:e],n},useContext:Nt,useEffect:Jy,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,La(4194308,4,vx.bind(null,e,n),t)},useLayoutEffect:function(n,e){return La(4194308,4,n,e)},useInsertionEffect:function(n,e){return La(4,2,n,e)},useMemo:function(n,e){var t=Ft();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Ft();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=nR.bind(null,G,n),[r.memoizedState,n]},useRef:function(n){var e=Ft();return n={current:n},e.memoizedState=n},useState:By,useDebugValue:zp,useDeferredValue:function(n){return Ft().memoizedState=n},useTransition:function(){var n=By(!1),e=n[0];return n=tR.bind(null,n[1]),Ft().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=G,i=Ft();if(j){if(t===void 0)throw Error(M(407));t=t()}else{if(t=e(),fe===null)throw Error(M(349));_r&30||gx(r,e,t)}i.memoizedState=t;var o={value:t,getSnapshot:e};return i.queue=o,Jy(Sx.bind(null,r,o,n),[n]),r.flags|=2048,sl(9,yx.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=Ft(),e=fe.identifierPrefix;if(j){var t=un,r=an;t=(r&~(1<<32-bt(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=il++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=eR++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},oR={readContext:Nt,useCallback:Mx,useContext:Nt,useEffect:Ip,useImperativeHandle:Ex,useInsertionEffect:Cx,useLayoutEffect:Nx,useMemo:Ox,useReducer:sf,useRef:xx,useState:function(){return sf(ol)},useDebugValue:zp,useDeferredValue:function(n){var e=vt();return Dx(e,ie.memoizedState,n)},useTransition:function(){var n=sf(ol)[0],e=vt().memoizedState;return[n,e]},useMutableSource:px,useSyncExternalStore:mx,useId:Tx,unstable_isNewReconciler:!1},sR={readContext:Nt,useCallback:Mx,useContext:Nt,useEffect:Ip,useImperativeHandle:Ex,useInsertionEffect:Cx,useLayoutEffect:Nx,useMemo:Ox,useReducer:lf,useRef:xx,useState:function(){return lf(ol)},useDebugValue:zp,useDeferredValue:function(n){var e=vt();return ie===null?e.memoizedState=n:Dx(e,ie.memoizedState,n)},useTransition:function(){var n=lf(ol)[0],e=vt().memoizedState;return[n,e]},useMutableSource:px,useSyncExternalStore:mx,useId:Tx,unstable_isNewReconciler:!1};function oo(n,e){try{var t="",r=e;do t+=IT(r),r=r.return;while(r);var i=t}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:i,digest:null}}function af(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Hd(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var lR=typeof WeakMap=="function"?WeakMap:Map;function $x(n,e,t){t=fn(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){bu||(bu=!0,th=r),Hd(n,e)},t}function Ix(n,e,t){t=fn(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){Hd(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){Hd(n,e),typeof r!="function"&&(Hn===null?Hn=new Set([this]):Hn.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function Wy(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new lR;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=xR.bind(null,n,e,t),e.then(n,n))}function Ky(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function _y(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=fn(-1,1),e.tag=2,_n(t,e,1))),t.lanes|=1),n)}var aR=gn.ReactCurrentOwner,He=!1;function Te(n,e,t,r){e.child=n===null?dx(e,null,t,r):ro(e,n.child,t,r)}function Hy(n,e,t,r,i){t=t.render;var o=e.ref;return Ji(e,i),r=Ap(n,e,t,r,o,i),t=$p(),n!==null&&!He?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,mn(n,e,i)):(j&&t&&wp(e),e.flags|=1,Te(n,e,r,i),e.child)}function Uy(n,e,t,r,i){if(n===null){var o=t.type;return typeof o=="function"&&!Kp(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,zx(n,e,o,r,i)):(n=Wa(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&i)){var s=o.memoizedProps;if(t=t.compare,t=t!==null?t:Xs,t(s,r)&&n.ref===e.ref)return mn(n,e,i)}return e.flags|=1,n=qn(o,r),n.ref=e.ref,n.return=e,e.child=n}function zx(n,e,t,r,i){if(n!==null){var o=n.memoizedProps;if(Xs(o,r)&&n.ref===e.ref)if(He=!1,e.pendingProps=r=o,(n.lanes&i)!==0)n.flags&131072&&(He=!0);else return e.lanes=n.lanes,mn(n,e,i)}return Ud(n,e,t,r,i)}function Px(n,e,t){var r=e.pendingProps,i=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},H(Ai,rt),rt|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,H(Ai,rt),rt|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,H(Ai,rt),rt|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,H(Ai,rt),rt|=r;return Te(n,e,i,t),e.child}function Fx(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Ud(n,e,t,r,i){var o=je(t)?Wr:Ee.current;return o=to(e,o),Ji(e,i),t=Ap(n,e,t,r,o,i),r=$p(),n!==null&&!He?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,mn(n,e,i)):(j&&r&&wp(e),e.flags|=1,Te(n,e,t,i),e.child)}function qy(n,e,t,r,i){if(je(t)){var o=!0;wu(e)}else o=!1;if(Ji(e,i),e.stateNode===null)Va(n,e),cx(e,t,r),_d(e,t,r,i),r=!0;else if(n===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,u=t.contextType;typeof u=="object"&&u!==null?u=Nt(u):(u=je(t)?Wr:Ee.current,u=to(e,u));var c=t.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||a!==u)&&Ly(e,s,r,u),Mn=!1;var d=e.memoizedState;s.state=d,Eu(e,r,s,i),a=e.memoizedState,l!==r||d!==a||qe.current||Mn?(typeof c=="function"&&(Kd(e,t,c,r),a=e.memoizedState),(l=Mn||Fy(e,t,l,r,d,a,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),s.props=r,s.state=a,s.context=u,r=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,ax(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ot(e.type,l),s.props=u,f=e.pendingProps,d=s.context,a=t.contextType,typeof a=="object"&&a!==null?a=Nt(a):(a=je(t)?Wr:Ee.current,a=to(e,a));var h=t.getDerivedStateFromProps;(c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||d!==a)&&Ly(e,s,r,a),Mn=!1,d=e.memoizedState,s.state=d,Eu(e,r,s,i);var p=e.memoizedState;l!==f||d!==p||qe.current||Mn?(typeof h=="function"&&(Kd(e,t,h,r),p=e.memoizedState),(u=Mn||Fy(e,t,u,r,d,p,a)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=a,r=u):(typeof s.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return qd(n,e,t,r,o,i)}function qd(n,e,t,r,i,o){Fx(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&Ay(e,t,!1),mn(n,e,o);r=e.stateNode,aR.current=e;var l=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=ro(e,n.child,null,o),e.child=ro(e,null,l,o)):Te(n,e,l,o),e.memoizedState=r.state,i&&Ay(e,t,!0),e.child}function Lx(n){var e=n.stateNode;e.pendingContext?Ry(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Ry(n,e.context,!1),Dp(n,e.containerInfo)}function jy(n,e,t,r,i){return no(),Cp(i),e.flags|=256,Te(n,e,t,r),e.child}var jd={dehydrated:null,treeContext:null,retryLane:0};function Qd(n){return{baseLanes:n,cachePool:null,transitions:null}}function Vx(n,e,t){var r=e.pendingProps,i=Q.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),H(Q,i&1),n===null)return Jd(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=tc(s,r,0,null),n=Fr(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=Qd(t),e.memoizedState=jd,n):Pp(e,s));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return uR(n,e,s,r,l,i,t);if(o){o=r.fallback,s=e.mode,i=n.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=qn(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=qn(l,o):(o=Fr(o,s,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=n.child.memoizedState,s=s===null?Qd(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=n.childLanes&~t,e.memoizedState=jd,r}return o=n.child,n=o.sibling,r=qn(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Pp(n,e){return e=tc({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ea(n,e,t,r){return r!==null&&Cp(r),ro(e,n.child,null,t),n=Pp(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function uR(n,e,t,r,i,o,s){if(t)return e.flags&256?(e.flags&=-257,r=af(Error(M(422))),ea(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=tc({mode:"visible",children:r.children},i,0,null),o=Fr(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ro(e,n.child,null,s),e.child.memoizedState=Qd(s),e.memoizedState=jd,o);if(!(e.mode&1))return ea(n,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(M(419)),r=af(o,r,void 0),ea(n,e,s,r)}if(l=(s&n.childLanes)!==0,He||l){if(r=fe,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,pn(n,i),Rt(r,n,i,-1))}return Wp(),r=af(Error(M(421))),ea(n,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=CR.bind(null,n),i._reactRetry=e,null):(n=o.treeContext,it=Kn(i.nextSibling),ot=e,j=!0,Tt=null,n!==null&&(pt[mt++]=an,pt[mt++]=un,pt[mt++]=Kr,an=n.id,un=n.overflow,Kr=e),e=Pp(e,r.children),e.flags|=4096,e)}function Qy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Wd(n.return,e,t)}function uf(n,e,t,r,i){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=i)}function Bx(n,e,t){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Te(n,e,r.children,t),r=Q.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Qy(n,t,e);else if(n.tag===19)Qy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(H(Q,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Mu(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),uf(e,!1,i,t,o);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Mu(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}uf(e,!0,t,null,o);break;case"together":uf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Va(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function mn(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Hr|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(M(153));if(e.child!==null){for(n=e.child,t=qn(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=qn(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function cR(n,e,t){switch(e.tag){case 3:Lx(e),no();break;case 5:hx(e);break;case 1:je(e.type)&&wu(e);break;case 4:Dp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;H(Nu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(H(Q,Q.current&1),e.flags|=128,null):t&e.child.childLanes?Vx(n,e,t):(H(Q,Q.current&1),n=mn(n,e,t),n!==null?n.sibling:null);H(Q,Q.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Bx(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),H(Q,Q.current),r)break;return null;case 22:case 23:return e.lanes=0,Px(n,e,t)}return mn(n,e,t)}var Jx,Gd,Wx,Kx;Jx=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Gd=function(){};Wx=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Or(Wt.current);var o=null;switch(t){case"input":i=Sd(n,i),r=Sd(n,r),o=[];break;case"select":i=Y({},i,{value:void 0}),r=Y({},r,{value:void 0}),o=[];break;case"textarea":i=xd(n,i),r=xd(n,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Su)}Nd(t,r);var s;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Hs.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(t||(t={}),t[s]=a[s])}else t||(o||(o=[]),o.push(u,t)),t=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Hs.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&U("scroll",n),o||l===a||(o=[])):(o=o||[]).push(u,a))}t&&(o=o||[]).push("style",t);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};Kx=function(n,e,t,r){t!==r&&(e.flags|=4)};function No(n,e){if(!j)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function we(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function fR(n,e,t){var r=e.pendingProps;switch(xp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return we(e),null;case 1:return je(e.type)&&ku(),we(e),null;case 3:return r=e.stateNode,io(),q(qe),q(Ee),bp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Xl(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tt!==null&&(ih(Tt),Tt=null))),Gd(n,e),we(e),null;case 5:Tp(e);var i=Or(rl.current);if(t=e.type,n!==null&&e.stateNode!=null)Wx(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(M(166));return we(e),null}if(n=Or(Wt.current),Xl(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[Lt]=e,r[tl]=o,n=(e.mode&1)!==0,t){case"dialog":U("cancel",r),U("close",r);break;case"iframe":case"object":case"embed":U("load",r);break;case"video":case"audio":for(i=0;i<as.length;i++)U(as[i],r);break;case"source":U("error",r);break;case"img":case"image":case"link":U("error",r),U("load",r);break;case"details":U("toggle",r);break;case"input":iy(r,o),U("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},U("invalid",r);break;case"textarea":sy(r,o),U("invalid",r)}Nd(t,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Yl(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Yl(r.textContent,l,n),i=["children",""+l]):Hs.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&U("scroll",r)}switch(t){case"input":Kl(r),oy(r,o,!0);break;case"textarea":Kl(r),ly(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Su)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=gw(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[Lt]=e,n[tl]=r,Jx(n,e,!1,!1),e.stateNode=n;e:{switch(s=vd(t,r),t){case"dialog":U("cancel",n),U("close",n),i=r;break;case"iframe":case"object":case"embed":U("load",n),i=r;break;case"video":case"audio":for(i=0;i<as.length;i++)U(as[i],n);i=r;break;case"source":U("error",n),i=r;break;case"img":case"image":case"link":U("error",n),U("load",n),i=r;break;case"details":U("toggle",n),i=r;break;case"input":iy(n,r),i=Sd(n,r),U("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Y({},r,{value:void 0}),U("invalid",n);break;case"textarea":sy(n,r),i=xd(n,r),U("invalid",n);break;default:i=r}Nd(t,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?kw(n,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&yw(n,a)):o==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&Us(n,a):typeof a=="number"&&Us(n,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Hs.hasOwnProperty(o)?a!=null&&o==="onScroll"&&U("scroll",n):a!=null&&sp(n,o,a,s))}switch(t){case"input":Kl(n),oy(n,r,!1);break;case"textarea":Kl(n),ly(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Qn(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?Fi(n,!!r.multiple,o,!1):r.defaultValue!=null&&Fi(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Su)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return we(e),null;case 6:if(n&&e.stateNode!=null)Kx(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(M(166));if(t=Or(rl.current),Or(Wt.current),Xl(e)){if(r=e.stateNode,t=e.memoizedProps,r[Lt]=e,(o=r.nodeValue!==t)&&(n=ot,n!==null))switch(n.tag){case 3:Yl(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Yl(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Lt]=e,e.stateNode=r}return we(e),null;case 13:if(q(Q),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(j&&it!==null&&e.mode&1&&!(e.flags&128))sx(),no(),e.flags|=98560,o=!1;else if(o=Xl(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(M(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(M(317));o[Lt]=e}else no(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;we(e),o=!1}else Tt!==null&&(ih(Tt),Tt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Q.current&1?se===0&&(se=3):Wp())),e.updateQueue!==null&&(e.flags|=4),we(e),null);case 4:return io(),Gd(n,e),n===null&&Zs(e.stateNode.containerInfo),we(e),null;case 10:return Ep(e.type._context),we(e),null;case 17:return je(e.type)&&ku(),we(e),null;case 19:if(q(Q),o=e.memoizedState,o===null)return we(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)No(o,!1);else{if(se!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=Mu(n),s!==null){for(e.flags|=128,No(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return H(Q,Q.current&1|2),e.child}n=n.sibling}o.tail!==null&&te()>so&&(e.flags|=128,r=!0,No(o,!1),e.lanes=4194304)}else{if(!r)if(n=Mu(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),No(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!j)return we(e),null}else 2*te()-o.renderingStartTime>so&&t!==1073741824&&(e.flags|=128,r=!0,No(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(t=o.last,t!==null?t.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=te(),e.sibling=null,t=Q.current,H(Q,r?t&1|2:t&1),e):(we(e),null);case 22:case 23:return Jp(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?rt&1073741824&&(we(e),e.subtreeFlags&6&&(e.flags|=8192)):we(e),null;case 24:return null;case 25:return null}throw Error(M(156,e.tag))}function dR(n,e){switch(xp(e),e.tag){case 1:return je(e.type)&&ku(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return io(),q(qe),q(Ee),bp(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Tp(e),null;case 13:if(q(Q),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(M(340));no()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return q(Q),null;case 4:return io(),null;case 10:return Ep(e.type._context),null;case 22:case 23:return Jp(),null;case 24:return null;default:return null}}var ta=!1,Ce=!1,hR=typeof WeakSet=="function"?WeakSet:Set,R=null;function Ri(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){X(n,e,r)}else t.current=null}function Yd(n,e,t){try{t()}catch(r){X(n,e,r)}}var Gy=!1;function pR(n,e){if(Id=mu,n=qw(),kp(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var s=0,l=-1,a=-1,u=0,c=0,f=n,d=null;t:for(;;){for(var h;f!==t||i!==0&&f.nodeType!==3||(l=s+i),f!==o||r!==0&&f.nodeType!==3||(a=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===n)break t;if(d===t&&++u===i&&(l=s),d===o&&++c===r&&(a=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}t=l===-1||a===-1?null:{start:l,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for(zd={focusedElem:n,selectionRange:t},mu=!1,R=e;R!==null;)if(e=R,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,R=n;else for(;R!==null;){e=R;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,S=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Ot(e.type,m),S);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(N){X(e,e.return,N)}if(n=e.sibling,n!==null){n.return=e.return,R=n;break}R=e.return}return p=Gy,Gy=!1,p}function Ms(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var o=i.destroy;i.destroy=void 0,o!==void 0&&Yd(e,t,o)}i=i.next}while(i!==r)}}function Zu(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Xd(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function _x(n){var e=n.alternate;e!==null&&(n.alternate=null,_x(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Lt],delete e[tl],delete e[Ld],delete e[Gb],delete e[Yb])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Hx(n){return n.tag===5||n.tag===3||n.tag===4}function Yy(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Hx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Zd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Su));else if(r!==4&&(n=n.child,n!==null))for(Zd(n,e,t),n=n.sibling;n!==null;)Zd(n,e,t),n=n.sibling}function eh(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(eh(n,e,t),n=n.sibling;n!==null;)eh(n,e,t),n=n.sibling}var pe=null,Dt=!1;function yn(n,e,t){for(t=t.child;t!==null;)Ux(n,e,t),t=t.sibling}function Ux(n,e,t){if(Jt&&typeof Jt.onCommitFiberUnmount=="function")try{Jt.onCommitFiberUnmount(Hu,t)}catch{}switch(t.tag){case 5:Ce||Ri(t,e);case 6:var r=pe,i=Dt;pe=null,yn(n,e,t),pe=r,Dt=i,pe!==null&&(Dt?(n=pe,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):pe.removeChild(t.stateNode));break;case 18:pe!==null&&(Dt?(n=pe,t=t.stateNode,n.nodeType===8?tf(n.parentNode,t):n.nodeType===1&&tf(n,t),Gs(n)):tf(pe,t.stateNode));break;case 4:r=pe,i=Dt,pe=t.stateNode.containerInfo,Dt=!0,yn(n,e,t),pe=r,Dt=i;break;case 0:case 11:case 14:case 15:if(!Ce&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Yd(t,e,s),i=i.next}while(i!==r)}yn(n,e,t);break;case 1:if(!Ce&&(Ri(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){X(t,e,l)}yn(n,e,t);break;case 21:yn(n,e,t);break;case 22:t.mode&1?(Ce=(r=Ce)||t.memoizedState!==null,yn(n,e,t),Ce=r):yn(n,e,t);break;default:yn(n,e,t)}}function Xy(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new hR),e.forEach(function(r){var i=NR.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Mt(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var o=n,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:pe=l.stateNode,Dt=!1;break e;case 3:pe=l.stateNode.containerInfo,Dt=!0;break e;case 4:pe=l.stateNode.containerInfo,Dt=!0;break e}l=l.return}if(pe===null)throw Error(M(160));Ux(o,s,i),pe=null,Dt=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){X(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)qx(e,n),e=e.sibling}function qx(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Mt(e,n),Pt(n),r&4){try{Ms(3,n,n.return),Zu(3,n)}catch(m){X(n,n.return,m)}try{Ms(5,n,n.return)}catch(m){X(n,n.return,m)}}break;case 1:Mt(e,n),Pt(n),r&512&&t!==null&&Ri(t,t.return);break;case 5:if(Mt(e,n),Pt(n),r&512&&t!==null&&Ri(t,t.return),n.flags&32){var i=n.stateNode;try{Us(i,"")}catch(m){X(n,n.return,m)}}if(r&4&&(i=n.stateNode,i!=null)){var o=n.memoizedProps,s=t!==null?t.memoizedProps:o,l=n.type,a=n.updateQueue;if(n.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&pw(i,o),vd(l,s);var u=vd(l,o);for(s=0;s<a.length;s+=2){var c=a[s],f=a[s+1];c==="style"?kw(i,f):c==="dangerouslySetInnerHTML"?yw(i,f):c==="children"?Us(i,f):sp(i,c,f,u)}switch(l){case"input":kd(i,o);break;case"textarea":mw(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Fi(i,!!o.multiple,h,!1):d!==!!o.multiple&&(o.defaultValue!=null?Fi(i,!!o.multiple,o.defaultValue,!0):Fi(i,!!o.multiple,o.multiple?[]:"",!1))}i[tl]=o}catch(m){X(n,n.return,m)}}break;case 6:if(Mt(e,n),Pt(n),r&4){if(n.stateNode===null)throw Error(M(162));i=n.stateNode,o=n.memoizedProps;try{i.nodeValue=o}catch(m){X(n,n.return,m)}}break;case 3:if(Mt(e,n),Pt(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Gs(e.containerInfo)}catch(m){X(n,n.return,m)}break;case 4:Mt(e,n),Pt(n);break;case 13:Mt(e,n),Pt(n),i=n.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Vp=te())),r&4&&Xy(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Ce=(u=Ce)||c,Mt(e,n),Ce=u):Mt(e,n),Pt(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(R=n,c=n.child;c!==null;){for(f=R=c;R!==null;){switch(d=R,h=d.child,d.tag){case 0:case 11:case 14:case 15:Ms(4,d,d.return);break;case 1:Ri(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){X(r,t,m)}}break;case 5:Ri(d,d.return);break;case 22:if(d.memoizedState!==null){e0(f);continue}}h!==null?(h.return=d,R=h):e0(f)}c=c.sibling}e:for(c=null,f=n;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,a=f.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=Sw("display",s))}catch(m){X(n,n.return,m)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){X(n,n.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Mt(e,n),Pt(n),r&4&&Xy(n);break;case 21:break;default:Mt(e,n),Pt(n)}}function Pt(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Hx(t)){var r=t;break e}t=t.return}throw Error(M(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Us(i,""),r.flags&=-33);var o=Yy(n);eh(n,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,l=Yy(n);Zd(n,l,s);break;default:throw Error(M(161))}}catch(a){X(n,n.return,a)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function mR(n,e,t){R=n,jx(n)}function jx(n,e,t){for(var r=(n.mode&1)!==0;R!==null;){var i=R,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||ta;if(!s){var l=i.alternate,a=l!==null&&l.memoizedState!==null||Ce;l=ta;var u=Ce;if(ta=s,(Ce=a)&&!u)for(R=i;R!==null;)s=R,a=s.child,s.tag===22&&s.memoizedState!==null?t0(i):a!==null?(a.return=s,R=a):t0(i);for(;o!==null;)R=o,jx(o),o=o.sibling;R=i,ta=l,Ce=u}Zy(n)}else i.subtreeFlags&8772&&o!==null?(o.return=i,R=o):Zy(n)}}function Zy(n){for(;R!==null;){var e=R;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ce||Zu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ce)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Ot(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Py(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Py(e,s,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Gs(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}Ce||e.flags&512&&Xd(e)}catch(d){X(e,e.return,d)}}if(e===n){R=null;break}if(t=e.sibling,t!==null){t.return=e.return,R=t;break}R=e.return}}function e0(n){for(;R!==null;){var e=R;if(e===n){R=null;break}var t=e.sibling;if(t!==null){t.return=e.return,R=t;break}R=e.return}}function t0(n){for(;R!==null;){var e=R;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Zu(4,e)}catch(a){X(e,t,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){X(e,i,a)}}var o=e.return;try{Xd(e)}catch(a){X(e,o,a)}break;case 5:var s=e.return;try{Xd(e)}catch(a){X(e,s,a)}}}catch(a){X(e,e.return,a)}if(e===n){R=null;break}var l=e.sibling;if(l!==null){l.return=e.return,R=l;break}R=e.return}}var gR=Math.ceil,Tu=gn.ReactCurrentDispatcher,Fp=gn.ReactCurrentOwner,Ct=gn.ReactCurrentBatchConfig,B=0,fe=null,re=null,ye=0,rt=0,Ai=ir(0),se=0,ll=null,Hr=0,ec=0,Lp=0,Os=null,Le=null,Vp=0,so=1/0,rn=null,bu=!1,th=null,Hn=null,na=!1,Fn=null,Ru=0,Ds=0,nh=null,Ba=-1,Ja=0;function Ae(){return B&6?te():Ba!==-1?Ba:Ba=te()}function Un(n){return n.mode&1?B&2&&ye!==0?ye&-ye:Zb.transition!==null?(Ja===0&&(Ja=Rw()),Ja):(n=K,n!==0||(n=window.event,n=n===void 0?16:Lw(n.type)),n):1}function Rt(n,e,t,r){if(50<Ds)throw Ds=0,nh=null,Error(M(185));Ol(n,t,r),(!(B&2)||n!==fe)&&(n===fe&&(!(B&2)&&(ec|=t),se===4&&bn(n,ye)),Qe(n,r),t===1&&B===0&&!(e.mode&1)&&(so=te()+500,Gu&&or()))}function Qe(n,e){var t=n.callbackNode;ZT(n,e);var r=pu(n,n===fe?ye:0);if(r===0)t!==null&&cy(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&cy(t),e===1)n.tag===0?Xb(n0.bind(null,n)):rx(n0.bind(null,n)),jb(function(){!(B&6)&&or()}),t=null;else{switch(Aw(r)){case 1:t=fp;break;case 4:t=Tw;break;case 16:t=hu;break;case 536870912:t=bw;break;default:t=hu}t=nC(t,Qx.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Qx(n,e){if(Ba=-1,Ja=0,B&6)throw Error(M(327));var t=n.callbackNode;if(Wi()&&n.callbackNode!==t)return null;var r=pu(n,n===fe?ye:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Au(n,r);else{e=r;var i=B;B|=2;var o=Yx();(fe!==n||ye!==e)&&(rn=null,so=te()+500,Pr(n,e));do try{kR();break}catch(l){Gx(n,l)}while(!0);vp(),Tu.current=o,B=i,re!==null?e=0:(fe=null,ye=0,e=se)}if(e!==0){if(e===2&&(i=Td(n),i!==0&&(r=i,e=rh(n,i))),e===1)throw t=ll,Pr(n,0),bn(n,r),Qe(n,te()),t;if(e===6)bn(n,r);else{if(i=n.current.alternate,!(r&30)&&!yR(i)&&(e=Au(n,r),e===2&&(o=Td(n),o!==0&&(r=o,e=rh(n,o))),e===1))throw t=ll,Pr(n,0),bn(n,r),Qe(n,te()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(M(345));case 2:Sr(n,Le,rn);break;case 3:if(bn(n,r),(r&130023424)===r&&(e=Vp+500-te(),10<e)){if(pu(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Ae(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Fd(Sr.bind(null,n,Le,rn),e);break}Sr(n,Le,rn);break;case 4:if(bn(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var s=31-bt(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=te()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gR(r/1960))-r,10<r){n.timeoutHandle=Fd(Sr.bind(null,n,Le,rn),r);break}Sr(n,Le,rn);break;case 5:Sr(n,Le,rn);break;default:throw Error(M(329))}}}return Qe(n,te()),n.callbackNode===t?Qx.bind(null,n):null}function rh(n,e){var t=Os;return n.current.memoizedState.isDehydrated&&(Pr(n,e).flags|=256),n=Au(n,e),n!==2&&(e=Le,Le=t,e!==null&&ih(e)),n}function ih(n){Le===null?Le=n:Le.push.apply(Le,n)}function yR(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],o=i.getSnapshot;i=i.value;try{if(!$t(o(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bn(n,e){for(e&=~Lp,e&=~ec,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-bt(e),r=1<<t;n[t]=-1,e&=~r}}function n0(n){if(B&6)throw Error(M(327));Wi();var e=pu(n,0);if(!(e&1))return Qe(n,te()),null;var t=Au(n,e);if(n.tag!==0&&t===2){var r=Td(n);r!==0&&(e=r,t=rh(n,r))}if(t===1)throw t=ll,Pr(n,0),bn(n,e),Qe(n,te()),t;if(t===6)throw Error(M(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Sr(n,Le,rn),Qe(n,te()),null}function Bp(n,e){var t=B;B|=1;try{return n(e)}finally{B=t,B===0&&(so=te()+500,Gu&&or())}}function Ur(n){Fn!==null&&Fn.tag===0&&!(B&6)&&Wi();var e=B;B|=1;var t=Ct.transition,r=K;try{if(Ct.transition=null,K=1,n)return n()}finally{K=r,Ct.transition=t,B=e,!(B&6)&&or()}}function Jp(){rt=Ai.current,q(Ai)}function Pr(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,qb(t)),re!==null)for(t=re.return;t!==null;){var r=t;switch(xp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ku();break;case 3:io(),q(qe),q(Ee),bp();break;case 5:Tp(r);break;case 4:io();break;case 13:q(Q);break;case 19:q(Q);break;case 10:Ep(r.type._context);break;case 22:case 23:Jp()}t=t.return}if(fe=n,re=n=qn(n.current,null),ye=rt=e,se=0,ll=null,Lp=ec=Hr=0,Le=Os=null,Mr!==null){for(e=0;e<Mr.length;e++)if(t=Mr[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,o=t.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}t.pending=r}Mr=null}return n}function Gx(n,e){do{var t=re;try{if(vp(),Fa.current=Du,Ou){for(var r=G.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Ou=!1}if(_r=0,ue=ie=G=null,Es=!1,il=0,Fp.current=null,t===null||t.return===null){se=1,ll=e,re=null;break}e:{var o=n,s=t.return,l=t,a=e;if(e=ye,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=Ky(s);if(h!==null){h.flags&=-257,_y(h,s,l,o,e),h.mode&1&&Wy(o,u,e),e=h,a=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(a),e.updateQueue=m}else p.add(a);break e}else{if(!(e&1)){Wy(o,u,e),Wp();break e}a=Error(M(426))}}else if(j&&l.mode&1){var S=Ky(s);if(S!==null){!(S.flags&65536)&&(S.flags|=256),_y(S,s,l,o,e),Cp(oo(a,l));break e}}o=a=oo(a,l),se!==4&&(se=2),Os===null?Os=[o]:Os.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=$x(o,a,e);zy(o,g);break e;case 1:l=a;var y=o.type,k=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Hn===null||!Hn.has(k)))){o.flags|=65536,e&=-e,o.lanes|=e;var N=Ix(o,l,e);zy(o,N);break e}}o=o.return}while(o!==null)}Zx(t)}catch(E){e=E,re===t&&t!==null&&(re=t=t.return);continue}break}while(!0)}function Yx(){var n=Tu.current;return Tu.current=Du,n===null?Du:n}function Wp(){(se===0||se===3||se===2)&&(se=4),fe===null||!(Hr&268435455)&&!(ec&268435455)||bn(fe,ye)}function Au(n,e){var t=B;B|=2;var r=Yx();(fe!==n||ye!==e)&&(rn=null,Pr(n,e));do try{SR();break}catch(i){Gx(n,i)}while(!0);if(vp(),B=t,Tu.current=r,re!==null)throw Error(M(261));return fe=null,ye=0,se}function SR(){for(;re!==null;)Xx(re)}function kR(){for(;re!==null&&!_T();)Xx(re)}function Xx(n){var e=tC(n.alternate,n,rt);n.memoizedProps=n.pendingProps,e===null?Zx(n):re=e,Fp.current=null}function Zx(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=dR(t,e),t!==null){t.flags&=32767,re=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{se=6,re=null;return}}else if(t=fR(t,e,rt),t!==null){re=t;return}if(e=e.sibling,e!==null){re=e;return}re=e=n}while(e!==null);se===0&&(se=5)}function Sr(n,e,t){var r=K,i=Ct.transition;try{Ct.transition=null,K=1,wR(n,e,t,r)}finally{Ct.transition=i,K=r}return null}function wR(n,e,t,r){do Wi();while(Fn!==null);if(B&6)throw Error(M(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(M(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(eb(n,o),n===fe&&(re=fe=null,ye=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||na||(na=!0,nC(hu,function(){return Wi(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=Ct.transition,Ct.transition=null;var s=K;K=1;var l=B;B|=4,Fp.current=null,pR(n,t),qx(t,n),Bb(zd),mu=!!Id,zd=Id=null,n.current=t,mR(t),HT(),B=l,K=s,Ct.transition=o}else n.current=t;if(na&&(na=!1,Fn=n,Ru=i),o=n.pendingLanes,o===0&&(Hn=null),jT(t.stateNode),Qe(n,te()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(bu)throw bu=!1,n=th,th=null,n;return Ru&1&&n.tag!==0&&Wi(),o=n.pendingLanes,o&1?n===nh?Ds++:(Ds=0,nh=n):Ds=0,or(),null}function Wi(){if(Fn!==null){var n=Aw(Ru),e=Ct.transition,t=K;try{if(Ct.transition=null,K=16>n?16:n,Fn===null)var r=!1;else{if(n=Fn,Fn=null,Ru=0,B&6)throw Error(M(331));var i=B;for(B|=4,R=n.current;R!==null;){var o=R,s=o.child;if(R.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(R=u;R!==null;){var c=R;switch(c.tag){case 0:case 11:case 15:Ms(8,c,o)}var f=c.child;if(f!==null)f.return=c,R=f;else for(;R!==null;){c=R;var d=c.sibling,h=c.return;if(_x(c),c===u){R=null;break}if(d!==null){d.return=h,R=d;break}R=h}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var S=m.sibling;m.sibling=null,m=S}while(m!==null)}}R=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,R=s;else e:for(;R!==null;){if(o=R,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ms(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,R=g;break e}R=o.return}}var y=n.current;for(R=y;R!==null;){s=R;var k=s.child;if(s.subtreeFlags&2064&&k!==null)k.return=s,R=k;else e:for(s=y;R!==null;){if(l=R,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Zu(9,l)}}catch(E){X(l,l.return,E)}if(l===s){R=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,R=N;break e}R=l.return}}if(B=i,or(),Jt&&typeof Jt.onPostCommitFiberRoot=="function")try{Jt.onPostCommitFiberRoot(Hu,n)}catch{}r=!0}return r}finally{K=t,Ct.transition=e}}return!1}function r0(n,e,t){e=oo(t,e),e=$x(n,e,1),n=_n(n,e,1),e=Ae(),n!==null&&(Ol(n,1,e),Qe(n,e))}function X(n,e,t){if(n.tag===3)r0(n,n,t);else for(;e!==null;){if(e.tag===3){r0(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hn===null||!Hn.has(r))){n=oo(t,n),n=Ix(e,n,1),e=_n(e,n,1),n=Ae(),e!==null&&(Ol(e,1,n),Qe(e,n));break}}e=e.return}}function xR(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Ae(),n.pingedLanes|=n.suspendedLanes&t,fe===n&&(ye&t)===t&&(se===4||se===3&&(ye&130023424)===ye&&500>te()-Vp?Pr(n,0):Lp|=t),Qe(n,e)}function eC(n,e){e===0&&(n.mode&1?(e=Ul,Ul<<=1,!(Ul&130023424)&&(Ul=4194304)):e=1);var t=Ae();n=pn(n,e),n!==null&&(Ol(n,e,t),Qe(n,t))}function CR(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),eC(n,t)}function NR(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(M(314))}r!==null&&r.delete(e),eC(n,t)}var tC;tC=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||qe.current)He=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return He=!1,cR(n,e,t);He=!!(n.flags&131072)}else He=!1,j&&e.flags&1048576&&ix(e,Cu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Va(n,e),n=e.pendingProps;var i=to(e,Ee.current);Ji(e,t),i=Ap(null,e,r,n,i,t);var o=$p();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,je(r)?(o=!0,wu(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Op(e),i.updater=Yu,e.stateNode=i,i._reactInternals=e,_d(e,r,n,t),e=qd(null,e,r,!0,o,t)):(e.tag=0,j&&o&&wp(e),Te(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Va(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=ER(r),n=Ot(r,n),i){case 0:e=Ud(null,e,r,n,t);break e;case 1:e=qy(null,e,r,n,t);break e;case 11:e=Hy(null,e,r,n,t);break e;case 14:e=Uy(null,e,r,Ot(r.type,n),t);break e}throw Error(M(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),Ud(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),qy(n,e,r,i,t);case 3:e:{if(Lx(e),n===null)throw Error(M(387));r=e.pendingProps,o=e.memoizedState,i=o.element,ax(n,e),Eu(e,r,null,t);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=oo(Error(M(423)),e),e=jy(n,e,r,t,i);break e}else if(r!==i){i=oo(Error(M(424)),e),e=jy(n,e,r,t,i);break e}else for(it=Kn(e.stateNode.containerInfo.firstChild),ot=e,j=!0,Tt=null,t=dx(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(no(),r===i){e=mn(n,e,t);break e}Te(n,e,r,t)}e=e.child}return e;case 5:return hx(e),n===null&&Jd(e),r=e.type,i=e.pendingProps,o=n!==null?n.memoizedProps:null,s=i.children,Pd(r,i)?s=null:o!==null&&Pd(r,o)&&(e.flags|=32),Fx(n,e),Te(n,e,s,t),e.child;case 6:return n===null&&Jd(e),null;case 13:return Vx(n,e,t);case 4:return Dp(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=ro(e,null,r,t):Te(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),Hy(n,e,r,i,t);case 7:return Te(n,e,e.pendingProps,t),e.child;case 8:return Te(n,e,e.pendingProps.children,t),e.child;case 12:return Te(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,H(Nu,r._currentValue),r._currentValue=s,o!==null)if($t(o.value,s)){if(o.children===i.children&&!qe.current){e=mn(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=fn(-1,t&-t),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Wd(o.return,t,e),l.lanes|=t;break}a=a.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(M(341));s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Wd(s,t,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Te(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ji(e,t),i=Nt(i),r=r(i),e.flags|=1,Te(n,e,r,t),e.child;case 14:return r=e.type,i=Ot(r,e.pendingProps),i=Ot(r.type,i),Uy(n,e,r,i,t);case 15:return zx(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),Va(n,e),e.tag=1,je(r)?(n=!0,wu(e)):n=!1,Ji(e,t),cx(e,r,i),_d(e,r,i,t),qd(null,e,r,!0,n,t);case 19:return Bx(n,e,t);case 22:return Px(n,e,t)}throw Error(M(156,e.tag))};function nC(n,e){return Dw(n,e)}function vR(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kt(n,e,t,r){return new vR(n,e,t,r)}function Kp(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ER(n){if(typeof n=="function")return Kp(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ap)return 11;if(n===up)return 14}return 2}function qn(n,e){var t=n.alternate;return t===null?(t=kt(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Wa(n,e,t,r,i,o){var s=2;if(r=n,typeof n=="function")Kp(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case Ci:return Fr(t.children,i,o,e);case lp:s=8,i|=8;break;case pd:return n=kt(12,t,e,i|2),n.elementType=pd,n.lanes=o,n;case md:return n=kt(13,t,e,i),n.elementType=md,n.lanes=o,n;case gd:return n=kt(19,t,e,i),n.elementType=gd,n.lanes=o,n;case fw:return tc(t,i,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case uw:s=10;break e;case cw:s=9;break e;case ap:s=11;break e;case up:s=14;break e;case En:s=16,r=null;break e}throw Error(M(130,n==null?n:typeof n,""))}return e=kt(s,t,e,i),e.elementType=n,e.type=r,e.lanes=o,e}function Fr(n,e,t,r){return n=kt(7,n,r,e),n.lanes=t,n}function tc(n,e,t,r){return n=kt(22,n,r,e),n.elementType=fw,n.lanes=t,n.stateNode={isHidden:!1},n}function cf(n,e,t){return n=kt(6,n,null,e),n.lanes=t,n}function ff(n,e,t){return e=kt(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function MR(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_c(0),this.expirationTimes=_c(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_c(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function _p(n,e,t,r,i,o,s,l,a){return n=new MR(n,e,t,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=kt(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Op(o),n}function OR(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xi,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function rC(n){if(!n)return Gn;n=n._reactInternals;e:{if(ei(n)!==n||n.tag!==1)throw Error(M(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(je(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(M(171))}if(n.tag===1){var t=n.type;if(je(t))return nx(n,t,e)}return e}function iC(n,e,t,r,i,o,s,l,a){return n=_p(t,r,!0,n,i,o,s,l,a),n.context=rC(null),t=n.current,r=Ae(),i=Un(t),o=fn(r,i),o.callback=e??null,_n(t,o,i),n.current.lanes=i,Ol(n,i,r),Qe(n,r),n}function nc(n,e,t,r){var i=e.current,o=Ae(),s=Un(i);return t=rC(t),e.context===null?e.context=t:e.pendingContext=t,e=fn(o,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=_n(i,e,s),n!==null&&(Rt(n,i,s,o),Pa(n,i,s)),s}function $u(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function i0(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Hp(n,e){i0(n,e),(n=n.alternate)&&i0(n,e)}function DR(){return null}var oC=typeof reportError=="function"?reportError:function(n){console.error(n)};function Up(n){this._internalRoot=n}rc.prototype.render=Up.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(M(409));nc(n,e,null,null)};rc.prototype.unmount=Up.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ur(function(){nc(null,n,null,null)}),e[hn]=null}};function rc(n){this._internalRoot=n}rc.prototype.unstable_scheduleHydration=function(n){if(n){var e=zw();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Tn.length&&e!==0&&e<Tn[t].priority;t++);Tn.splice(t,0,n),t===0&&Fw(n)}};function qp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ic(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function o0(){}function TR(n,e,t,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=$u(s);o.call(u)}}var s=iC(e,r,n,0,null,!1,!1,"",o0);return n._reactRootContainer=s,n[hn]=s.current,Zs(n.nodeType===8?n.parentNode:n),Ur(),s}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=$u(a);l.call(u)}}var a=_p(n,0,!1,null,null,!1,!1,"",o0);return n._reactRootContainer=a,n[hn]=a.current,Zs(n.nodeType===8?n.parentNode:n),Ur(function(){nc(e,a,t,r)}),a}function oc(n,e,t,r,i){var o=t._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var a=$u(s);l.call(a)}}nc(e,s,n,i)}else s=TR(t,e,n,i,r);return $u(s)}$w=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=ls(e.pendingLanes);t!==0&&(dp(e,t|1),Qe(e,te()),!(B&6)&&(so=te()+500,or()))}break;case 13:Ur(function(){var r=pn(n,1);if(r!==null){var i=Ae();Rt(r,n,1,i)}}),Hp(n,1)}};hp=function(n){if(n.tag===13){var e=pn(n,134217728);if(e!==null){var t=Ae();Rt(e,n,134217728,t)}Hp(n,134217728)}};Iw=function(n){if(n.tag===13){var e=Un(n),t=pn(n,e);if(t!==null){var r=Ae();Rt(t,n,e,r)}Hp(n,e)}};zw=function(){return K};Pw=function(n,e){var t=K;try{return K=n,e()}finally{K=t}};Md=function(n,e,t){switch(e){case"input":if(kd(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Qu(r);if(!i)throw Error(M(90));hw(r),kd(r,i)}}}break;case"textarea":mw(n,t);break;case"select":e=t.value,e!=null&&Fi(n,!!t.multiple,e,!1)}};Cw=Bp;Nw=Ur;var bR={usingClientEntryPoint:!1,Events:[Tl,Mi,Qu,ww,xw,Bp]},vo={findFiberByHostInstance:Er,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},RR={bundleType:vo.bundleType,version:vo.version,rendererPackageName:vo.rendererPackageName,rendererConfig:vo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Mw(n),n===null?null:n.stateNode},findFiberByHostInstance:vo.findFiberByHostInstance||DR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ra=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ra.isDisabled&&ra.supportsFiber)try{Hu=ra.inject(RR),Jt=ra}catch{}}ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bR;ut.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qp(e))throw Error(M(200));return OR(n,e,null,t)};ut.createRoot=function(n,e){if(!qp(n))throw Error(M(299));var t=!1,r="",i=oC;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=_p(n,1,!1,null,null,t,!1,r,i),n[hn]=e.current,Zs(n.nodeType===8?n.parentNode:n),new Up(e)};ut.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(M(188)):(n=Object.keys(n).join(","),Error(M(268,n)));return n=Mw(e),n=n===null?null:n.stateNode,n};ut.flushSync=function(n){return Ur(n)};ut.hydrate=function(n,e,t){if(!ic(e))throw Error(M(200));return oc(null,n,e,!0,t)};ut.hydrateRoot=function(n,e,t){if(!qp(n))throw Error(M(405));var r=t!=null&&t.hydratedSources||null,i=!1,o="",s=oC;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=iC(e,null,n,1,t??null,i,!1,o,s),n[hn]=e.current,Zs(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new rc(e)};ut.render=function(n,e,t){if(!ic(e))throw Error(M(200));return oc(null,n,e,!1,t)};ut.unmountComponentAtNode=function(n){if(!ic(n))throw Error(M(40));return n._reactRootContainer?(Ur(function(){oc(null,null,n,!1,function(){n._reactRootContainer=null,n[hn]=null})}),!0):!1};ut.unstable_batchedUpdates=Bp;ut.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!ic(t))throw Error(M(200));if(n==null||n._reactInternals===void 0)throw Error(M(38));return oc(n,e,t,!1,r)};ut.version="18.2.0-next-9e3b772b8-20220608";function sC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sC)}catch(n){console.error(n)}}sC(),iw.exports=ut;var lo=iw.exports,lC,s0=lo;lC=s0.createRoot,s0.hydrateRoot;const ti=C.createContext(null),AR=C.createContext(null),aC=C.createContext(null),ia=new WeakMap;function $R(n){const e=Object.create(null);e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",i=>{if(typeof i=="function"&&(i=i(n.state)),i)for(const o in i)o=="class"?e.class+=" "+i[o]:o=="style"?e.style=(e.style?e.style+";":"")+i[o]:!e[o]&&o!="contenteditable"&&o!="nodeName"&&(e[o]=String(i[o]))}),e.translate||(e.translate="no");const t=[_e.node(0,n.state.doc.content.size,e)],r=ia.get(n);return!r||r[0].to!==n.state.doc.content.size||!r[0].type.eq(t[0].type)?(ia.set(n,t),t):r}const IR=[],zR={},oh=_.empty;class Rn{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,zR));return Rn.from(r)}forChild(e,t){if(t.isLeaf)return _.empty;let r=[];for(let i=0;i<this.members.length;i++){const o=this.members[i].forChild(e,t);o!=oh&&(o instanceof Rn?r=r.concat(o.members):r.push(o))}return Rn.from(r)}eq(e){if(!(e instanceof Rn)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){const o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?PR(r?t:t.sort(uC)):IR}static from(e){switch(e.length){case 0:return oh;case 1:return e[0];default:return new Rn(e.every(t=>t instanceof _)?e:e.reduce((t,r)=>t.concat(r instanceof _?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function uC(n,e){return n.from-e.from||n.to-e.to}function PR(n){let e=n;for(let t=0;t<e.length-1;t++){const r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){const o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),l0(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),l0(e,i,r.copy(o.from,r.to)));break}}}return e}function l0(n,e,t){for(;e<n.length&&uC(t,n[e])>0;)e++;n.splice(e,0,t)}const df=new WeakMap;function FR(n,e){const t=[];n.someProp("decorations",s=>{const l=s(n.state);l&&l!=oh&&t.push(l)}),e&&t.push(_.create(n.state.doc,[e]));const r=df.get(n);if(!r){const s=Rn.from(t);return df.set(n,s),s}let i=0,o=!0;if(r.forEachSet(s=>{t[i++]!==s&&(o=!1)}),i!==t.length&&(o=!1),!o){const s=Rn.from(t);return df.set(n,s),s}return r}const jp=function(n){for(let e=0;;e++)if(n=n.previousSibling,!n)return e},a0=function(n){const e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e},LR=function(n,e,t,r){return t&&(u0(n,e,t,r,-1)||u0(n,e,t,r,1))},VR=/^(img|br|input|textarea|hr)$/i;function u0(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Iu(n))){const o=n.parentNode;if(!o||o.nodeType!=1||JR(n)||VR.test(n.nodeName)||n.contentEditable=="false")return!1;e=jp(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Iu(n):0}else return!1}}function Iu(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function BR(n,e,t){for(let r=e==0,i=e==Iu(n);r||i;){if(n==t)return!0;const o=jp(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==Iu(n)}return!1}function JR(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const cC=function(n){return n.focusNode&&LR(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)},fC=C.createContext(null);function WR(n,e){const t=C.useContext(fC);C.useLayoutEffect(()=>t(n),e)}function dC(n,e){const{view:t}=C.useContext(ti);WR(()=>{if(t)return n(t)},e&&[t,...e])}const KR=C.forwardRef(function({widget:e,getPos:t,...r},i){const[o,s]=C.useState(!0),l=C.useRef(null);return C.useImperativeHandle(i,()=>l.current,[]),dC(a=>{if(!a||!l.current)return;a.domObserver.disconnectSelection();const u=a.domSelection(),c=document.createRange(),f=l.current;f.nodeName=="IMG"&&f.parentNode?c.setEnd(f.parentNode,jp(f)+1):c.setEnd(f,0),c.collapse(!1),u.removeAllRanges(),u.addRange(c),s(!1),a.domObserver.connectSelection()},[]),o?b.jsx("img",{ref:l,className:"ProseMirror-separator","mark-placeholder":"true",alt:"",...r}):null});function _R(n,e){if(n==e)return!0;for(const t in n)if(n[t]!==e[t])return!1;for(const t in e)if(!(t in n))return!1;return!0}const HR={side:0};class al{constructor(e,t){this.Component=e,this.spec=t??HR,this.side=this.spec.side??0}map(e,t,r,i){const{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new _e(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof al&&(this.spec.key&&this.spec.key==e.spec.key||this.Component==e.Component&&_R(this.spec,e.spec))}destroy(){}}function hC(n,e,t){return new _e(n,n,new al(e,t))}function hf(){return Math.floor(Math.random()*0xffffffffffff).toString(16)}const ul=new gl("@nytimes/react-prosemirror/reactKeys");function UR(){let n=!1;return new Xt({key:ul,state:{init(e,t){const r={posToKey:new Map,keyToPos:new Map};return t.doc.descendants((i,o)=>{const s=hf();return r.posToKey.set(o,s),r.keyToPos.set(s,o),!0}),r},apply(e,t,r,i){if(!e.docChanged||n)return t;const o=e.getMeta(ul),s=(o==null?void 0:o.type)==="bustKey"&&o.payload.key,l={posToKey:new Map,keyToPos:new Map},a=Array.from(t.posToKey.entries()).sort(([u],[c])=>u-c);for(const[u,c]of a){const{pos:f,deleted:d}=e.mapping.mapResult(u);if(d)continue;let h=c;s===c&&(h=hf()),l.posToKey.set(f,h),l.keyToPos.set(h,f)}return i.doc.descendants((u,c)=>{if(l.posToKey.has(c))return!0;const f=hf();return l.posToKey.set(c,f),l.keyToPos.set(f,c),!0}),l}},props:{handleDOMEvents:{compositionstart:()=>{n=!0},compositionend:()=>{n=!1}}}})}function pf(n,e,t={}){var s;if(e===null)return!1;const r=t.from??n.state.selection.from,i=t.to??n.state.selection.to;if(n.someProp("handleTextInput",l=>l(n,r,i,e)))return!0;const{tr:o}=n.state;if(t.marks&&o.ensureMarks(t.marks),o.insertText(e,r,i),t.bust){const l=n.state.doc.resolve(r),a=l.sharedDepth(i),u=l.start(a),c=(s=ul.getState(n.state))==null?void 0:s.posToKey.get(u-1);o.setMeta(ul,{type:"bustKey",payload:{key:c}})}return n.dispatch(o),!0}function qR(n){let e=null,t=null;return new Xt({props:{handleDOMEvents:{compositionstart(r){var s;const{state:i}=r;r.dispatch(i.tr.deleteSelection());const o=i.selection.$from;return i.selection.empty&&(i.storedMarks||!o.textOffset&&o.parentOffset&&((s=o.nodeBefore)!=null&&s.marks.some(l=>l.type.spec.inclusive===!1)))&&n(hC(i.selection.from,KR,{key:"cursor-wrapper",marks:i.storedMarks??o.marks()})),t=i.storedMarks??o.marks(),r.input.composing=!0,!0},compositionupdate(){return!0},compositionend(r){if(r.input.composing=!1,e!==null)return pf(r,e,{bust:!0,marks:t}),e=null,t=null,n(null),!0},beforeinput(r,i){var o,s;switch(i.preventDefault(),i.inputType){case"insertCompositionText":{if(i.data===null)break;e=i.data;break}case"insertReplacementText":{const l=i.getTargetRanges();(s=(o=i.dataTransfer)==null?void 0:o.items[0])==null||s.getAsString(a=>{for(const u of l){const c=r.posAtDOM(u.startContainer,u.startOffset,1),f=r.posAtDOM(u.endContainer,u.endOffset,1);pf(r,a,{from:c,to:f})}});break}case"insertText":{pf(r,i.data);break}case"deleteWordBackward":case"deleteContentBackward":case"deleteWordForward":case"deleteContentForward":case"deleteContent":{const l=i.getTargetRanges(),{tr:a}=r.state;for(const u of l){const c=r.posAtDOM(u.startContainer,u.startOffset),f=r.posAtDOM(u.endContainer,u.endOffset),{doc:d}=r.state,h=d.resolve(c).marksAcross(d.resolve(f));a.delete(c,f).setStoredMarks(h)}r.dispatch(a);break}}return!0}}}})}const Gt=typeof navigator<"u"?navigator:null,c0=typeof document<"u"?document:null,sr=Gt&&Gt.userAgent||"",sh=/Edge\/(\d+)/.exec(sr),pC=/MSIE \d/.exec(sr),lh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(sr),sc=!!(pC||lh||sh),jR=pC?document.documentMode:lh?+lh[1]:sh?+sh[1]:0,mC=!sc&&/gecko\/(\d+)/i.test(sr),QR=mC&&+(/Firefox\/(\d+)/.exec(sr)||[0,0])[1],ah=!sc&&/Chrome\/(\d+)/.exec(sr),GR=!!ah,YR=ah?+ah[1]:0,gC=!sc&&!!Gt&&/Apple Computer/.test(Gt.vendor),yC=gC&&(/Mobile\/\w+/.test(sr)||!!Gt&&Gt.maxTouchPoints>2),XR=yC||(Gt?/Mac/.test(Gt.platform):!1),ZR=Gt?/Win/.test(Gt.platform):!1,eA=/Android \d/.test(sr),SC=!!c0&&"webkitFontSmoothing"in c0.documentElement.style,tA=SC?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,ve={ie:sc,ie_version:jR,gecko:mC,gecko_version:QR,chrome:GR,chrome_version:YR,safari:gC,ios:yC,mac:XR,windows:ZR,android:eA,webkit:SC,webkit_version:tA};function f0(n){return n.editable&&!n.hasFocus()?!1:nA(n)}function nA(n){var t,r;const e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(((t=e.focusNode)==null?void 0:t.nodeType)==3?(r=e.focusNode)==null?void 0:r.parentNode:e.focusNode))}catch{return!1}}function rA(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function d0(n,e=null){const t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode);const o=i&&i.size==0;let s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(cC(t)){for(a=s;i&&!i.node;)i=i.parent;const f=i.node;if(i&&f.isAtom&&O.isSelectable(f)&&i.parent&&!(f.isInline&&BR(t.focusNode,t.focusOffset,i.dom))){const d=i.posBefore;u=new O(s==d?l:r.resolve(d))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let f=s,d=s;for(let h=0;h<t.rangeCount;h++){const p=t.getRangeAt(h);f=Math.min(f,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),d=Math.max(d,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(f<0)return null;[a,s]=d==n.state.selection.anchor?[d,f]:[f,d],l=r.resolve(s)}else a=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(a<0)return null}const c=r.resolve(a);if(!u){const f=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=rA(n,c,l,f)}return u}const zu=function(n,e,t,r){return t&&(h0(n,e,t,r,-1)||h0(n,e,t,r,1))};function iA(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const oA=/^(img|br|input|textarea|hr)$/i;function h0(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:p0(n))){const o=n.parentNode;if(!o||o.nodeType!=1||iA(n)||oA.test(n.nodeName)||n.contentEditable=="false")return!1;e=On(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?p0(n):0}else return!1}}const On=function(n){let e=n;for(let t=0;;t++)if(e=e.previousSibling,!e)return t};function p0(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function sA(n,e){const t=n;if(e instanceof O){const r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(m0(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else m0(t)}function m0(n){const e=n;e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function lA(n){const e=n,t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function kC(n){return n.editable?n.hasFocus():lA(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function aA(n){const e=n,t=e.domSelection(),r=document.createRange();if(!t)return;const i=e.cursorWrapper.dom,o=i.nodeName=="IMG";o?r.setStart(i.parentNode,On(i)+1):r.setStart(i,0),r.collapse(!0),t.removeAllRanges(),t.addRange(r),!o&&!e.state.selection.visible&&ve.ie&&ve.ie_version<=11&&(i.disabled=!0,i.disabled=!1)}function g0(n,e){const t=n,{node:r,offset:i}=t.docView.domFromPos(e,0),o=i<r.childNodes.length?r.childNodes[i]:null,s=i?r.childNodes[i-1]:null;if(ve.safari&&o&&o.contentEditable=="false")return mf(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return mf(o);if(s)return mf(s)}}function mf(n){return n.contentEditable="true",ve.safari&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function y0(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function uA(n){const e=n,t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);const r=e.domSelectionRange(),i=r.anchorNode,o=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(r.anchorNode!=i||r.anchorOffset!=o)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!kC(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}const S0=ve.safari||ve.chrome&&ve.chrome_version<63;function oa(n,e=!1){const t=n,r=t.state.selection;if(sA(t,r),!!kC(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&ve.chrome){const i=t.domSelectionRange(),o=t.domObserver.currentSelection;if(i.anchorNode&&o.anchorNode&&zu(i.anchorNode,i.anchorOffset,o.anchorNode,o.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)aA(t);else{const{anchor:i,head:o}=r;let s,l;S0&&!(r instanceof $)&&(r.$from.parent.inlineContent||(s=g0(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(l=g0(t,r.to))),t.docView.setSelection(i,o,t,e),S0&&(s&&y0(s),l&&y0(l)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&uA(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}class cA{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class fA{constructor(e){this.view=e,this.flushingSoon=-1,this.currentSelection=new cA,this.suppressingSelectionUpdates=!1,this.view=e,this.onSelectionChange=this.onSelectionChange.bind(this)}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}stop(){this.disconnectSelection()}start(){this.connectSelection()}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;const t=new Set;let r;for(let o=e.focusNode;o;o=a0(o))t.add(o);for(let o=e.anchorNode;o;o=a0(o))if(t.has(o)){r=o;break}const i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:(r==null?void 0:r.nodeType)==3?r==null?void 0:r.parentNode:r}))return this.setCurSelection(),!0}registerMutation(){}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}updateSelection(){const{view:e}=this,t=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);e.input.compositionPendingChanges=0;const r=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,i=d0(e,r);if(i&&!e.state.selection.eq(i)){const o=e.state.tr.setSelection(i);r=="pointer"?o.setMeta("pointer",!0):r=="key"&&o.scrollIntoView(),t&&o.setMeta("composition",t),e.dispatch(o)}}selectionToDOM(){const{view:e}=this;oa(e);const t=e.domSelectionRange();this.currentSelection.set(t)}flush(){const{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;const t=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&f0(e)&&!this.ignoreSelectionChange(t);let i=null;r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&cC(t)&&(i=d0(e))&&i.eq(z.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,oa(e),this.currentSelection.set(t),e.scrollToSelection()):r&&(this.updateSelection(),this.currentSelection.eq(t)||oa(e),this.currentSelection.set(t))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}onSelectionChange(){if(f0(this.view)&&!this.view.composing){if(this.suppressingSelectionUpdates)return oa(this.view);if(ve.ie&&ve.ie_version<=11&&!this.view.state.selection.empty){const e=this.view.domSelectionRange();if(e.focusNode&&zu(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}}class dA{add(){}remove(){}}class Ki{constructor(){this.nodeName="div",this.style={}}get parent(){return new Ki}get parentNode(){return new Ki}appendChild(){return new Ki}setAttribute(){}hasAttribute(){return!1}insertBefore(){}get classList(){return new dA}get ownerDocument(){return new wC}addEventListener(){}removeEventListener(){}replaceChildren(){}}class wC{createElement(){return new Ki}addEventListener(){}removeEventListener(){}get documentElement(){return new Ki}}function xC(){const n=globalThis.window;globalThis.window??(globalThis.window={visualViewport:null});const e=globalThis.document;return globalThis.document??(globalThis.document=new wC),function(){globalThis.window!==n&&(globalThis.window=n),globalThis.document!==e&&(globalThis.document=e)}}function ni(n,e){return n instanceof fl?1:e instanceof fl?-1:n.getPos()-e.getPos()}const ao=0,k0=1,sa=2,cl=3;class Rl{constructor(e,t,r,i,o){this.parent=e,this.children=t,this.getPos=r,this.dom=i,this.contentDOM=o,this.dirty=ao,i.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){const i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>On(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){const o=this.getDesc(i);let s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){const t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){const o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t];const o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){const s=this.children[r],l=o+s.size;if(l>e||s instanceof fl){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof Qp&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?On(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?On(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){const a=this.children[l],u=s+a.size;if(i==-1&&e<=u){const c=s+a.border;if(e>=c&&t<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=s;for(let f=l;f>0;f--){const d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=On(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(u>t||l==this.children.length-1)){t=u;for(let c=l+1;c<this.children.length;c++){const f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=On(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;const t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){const{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){var h;const o=Math.min(e,t),s=Math.max(e,t);for(let p=0,m=0;p<this.children.length;p++){const S=this.children[p],g=m+S.size;if(o>m&&s<g)return S.setSelection(e-m-S.border,t-m-S.border,r,i);m=g}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1);const u=r.root.getSelection(),c=r.domSelectionRange();let f=!1;if((ve.gecko||ve.safari)&&e==t){const{node:p,offset:m}=l;if(p.nodeType==3){if(f=!!(m&&((h=p.nodeValue)==null?void 0:h[m-1])==`
`),f&&m==p.nodeValue.length)for(let S=p,g;S;S=S.parentNode){if(g=S.nextSibling){g.nodeName=="BR"&&(l=a={node:g.parentNode,offset:On(g)+1});break}const y=S.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{const S=p.childNodes[m-1];f=S&&(S.nodeName=="BR"||S.contentEditable=="false")}}if(ve.gecko&&c.focusNode&&c.focusNode!=a.node&&c.focusNode.nodeType==1){const p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||f&&ve.safari)&&zu(l.node,l.offset,c.anchorNode,c.anchorOffset)&&zu(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((u.extend||e==t)&&!f){u.collapse(l.node,l.offset);try{e!=t&&u.extend(a.node,a.offset),d=!0}catch{}}if(!d){if(e>t){const m=l;l=a,a=m}const p=document.createRange();p.setEnd(a.node,a.offset),p.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){const o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){const l=r+o.border,a=s-o.border;if(e>=l&&t<=a){this.dirty=e==r||t==s?sa:k0,e==l&&t==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=cl:o.markDirty(e-l,t-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?sa:cl}r=s}this.dirty=sa}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){const r=e==1?sa:k0;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Qp extends Rl{constructor(e,t,r,i){super(e,[],t,i,null),this.widget=r,this.widget=r}matchesWidget(e){return this.dirty==ao&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){const t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}get domAtom(){return!0}get side(){return this.widget.type.side}}class Pu extends Rl{constructor(e,t,r,i,o){super(e,[],t,r,null),this.textDOM=i,this.text=o}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class hA extends Rl{constructor(e,t,r,i,o,s,l){super(e,t,r,o,s),this.mark=i,this.spec=l}parseRule(){return this.dirty&cl||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=cl&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=ao){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=ao}}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Gp extends Rl{constructor(e,t,r,i,o,s,l,a,u,c,f,d){super(e,t,r,l,a),this.node=i,this.outerDeco=o,this.innerDeco=s,this.nodeDOM=u,this.stopEvent=c,this.selectNode=f,this.deselectNode=d}updateOuterDeco(){}parseRule(){if(this.node.type.spec.reparseInView)return null;const e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){const r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>x.empty)}return e}matchesNode(e,t,r){return this.dirty==ao&&e.eq(this.node)&&mA(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}update(e,t,r,i){return!0}get domAtom(){return this.node.isAtom}}class pA extends Gp{constructor(e,t,r,i,o,s,l,a){super(e,t,r,i,o,s,l,null,a,()=>!1,()=>{},()=>{})}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return!0}inParent(){const e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=cl)}get domAtom(){return!1}}class fl extends Rl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==ao&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}function mA(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function gA(n){const e={};for(const[r,i]of n.entries()){let o=function(s,l){for(const a of i){let u=!1;if(lo.unstable_batchedUpdates(()=>{u=!!a.call(this,s,l)}),u||l.defaultPrevented)return!0}return!1};e[r]=o}return new Xt({key:new gl("@nytimes/react-prosemirror/componentEventListeners"),props:{handleDOMEvents:e}})}function yA(){const[n,e]=C.useState(new Map),t=C.useCallback((o,s)=>{const l=n.get(o)??[];l.unshift(s),n.has(o)||(n.set(o,l),e(new Map(n)))},[n]),r=C.useCallback((o,s)=>{const l=n.get(o);l==null||l.splice(l.indexOf(s),1)},[n]),i=C.useMemo(()=>gA(n),[n]);return{registerEventListener:t,unregisterEventListener:r,componentEventListenersPlugin:i}}function CC(){const[,n]=C.useReducer(e=>e+1,0);return n}function SA(n){const e=Object.create(null);function t(r){for(const i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function kA(n,e){let t=0,r=0;for(const i in n){if(n[i]!=e[i])return!0;t++}for(const i in e)r++;return t!=r}function wA(n,e){for(const t of Object.keys(n))if(n[t]!==e[t])return!0;return!1}function w0(n){return!n.someProp("editable",e=>e(n.state)===!1)}class x0 extends MT{constructor(e,t){const r=xC();super(e,{state:An.create({schema:t.state.schema,plugins:t.state.plugins}),plugins:t.plugins}),this.shouldUpdatePluginViews=!1,r(),this.shouldUpdatePluginViews=!0,this._props=t,this.oldProps={state:t.state},this.state=t.state,this.domObserver.stop(),this.domObserver=new fA(this),this.domObserver.start(),this.editable=w0(this),this.docView.dom.replaceChildren(),this.docView=t.docView}get needsRedraw(){if(this.oldProps.state.plugins===this._props.state.plugins&&this._props.plugins===this.oldProps.plugins)return!1;const e=SA(this);return kA(this.nodeViews,e)}pureSetProps(e){this._props={...this._props,...e},this.state=this._props.state,this.editable=w0(this)}runPendingEffects(){if(wA(this.props,this.oldProps)){const e=this.props;this._props=this.oldProps,this.state=this._props.state,this.update(e)}}update(e){super.update(e),this.oldProps=e}updatePluginViews(e){this.shouldUpdatePluginViews&&super.updatePluginViews(e)}destroy(){this.dom=document.createElement("div"),super.destroy()}}const xA=new q0({nodes:{doc:{content:"text*"},text:{inline:!0}}}),CA=An.create({schema:xA});function NA(n,e){const[t,r]=C.useState(null),i=CC(),o=e.defaultState??CA,[s,l]=C.useState(o),a=e.state??s,{componentEventListenersPlugin:u,registerEventListener:c,unregisterEventListener:f}=yA(),d=C.useCallback(v=>{lo.flushSync(()=>{r(v)})},[]),h=C.useMemo(()=>[...e.plugins??[],u,qR(d)],[e.plugins,u,d]),p=C.useCallback(function(D){lo.flushSync(()=>{e.state||l(T=>T.apply(D)),e.dispatchTransaction&&e.dispatchTransaction.call(this,D)})},[e.dispatchTransaction,e.state]),m=xC(),S=document.createElement("div");m();const g=C.useRef(new Gp(void 0,[],()=>-1,a.doc,[],_.empty,S,null,S,()=>!1,()=>{},()=>{})),y={...e,state:a,plugins:h,dispatchTransaction:p,docView:g.current},[k,N]=C.useState(()=>new x0(null,y));return C.useLayoutEffect(()=>()=>{k==null||k.destroy()},[k]),C.useLayoutEffect(()=>{if(!n){N(null);return}if(!k||k.dom!==n){const v=new x0({mount:n},y);N(v),v.dom.addEventListener("compositionend",i);return}if(k.needsRedraw){N(null);return}k==null||k.domObserver.selectionToDOM(),k==null||k.runPendingEffects()}),k==null||k.pureSetProps(y),{editor:C.useMemo(()=>({view:k,registerEventListener:c,unregisterEventListener:f,cursorWrapper:t,docViewDescRef:g}),[k,c,f,t]),state:a}}function vA({children:n}){const e=C.useRef(new Set).current,t=C.useRef(new Set).current,r=C.useRef(!1),i=CC(),o=C.useRef(!0),s=C.useCallback(()=>{o.current||(i(),o.current=!0)},[i]),l=C.useCallback(a=>{let u;const c=()=>{u=a()};return e.add(c),s(),()=>{e.delete(c),u&&(r.current?(t.add(u),s()):u())}},[e,t,s]);return C.useLayoutEffect(()=>(o.current=!1,e.forEach(a=>a()),e.clear(),()=>{t.forEach(a=>a()),t.clear()})),C.useLayoutEffect(()=>(r.current=!0,()=>{r.current=!1}),[]),b.jsx(fC.Provider,{value:l,children:n})}const Et=C.createContext({parentRef:{current:void 0},siblingsRef:{current:[]}});function NC(n,e,t,r,i,o,s,l){const{view:a}=C.useContext(ti),[u,c]=C.useState(!0),f=C.useRef(s),d=C.useRef(()=>!1),h=C.useCallback(N=>{d.current=N},[]),p=C.useRef(()=>{!r.current||!n||(r.current.nodeType==1&&r.current.classList.add("ProseMirror-selectednode"),(l!=null&&l.current||!n.type.spec.draggable)&&(((t==null?void 0:t.current)??r.current).draggable=!0))}),m=C.useRef(()=>{!r.current||!n||r.current.nodeType==1&&(r.current.classList.remove("ProseMirror-selectednode"),(l!=null&&l.current||!n.type.spec.draggable)&&((t==null?void 0:t.current)??r.current).removeAttribute("draggable"))}),S=C.useCallback((N,E)=>{p.current=N,m.current=E},[]),{siblingsRef:g,parentRef:y}=C.useContext(Et),k=C.useRef([]);return C.useLayoutEffect(()=>{const N=g.current;return()=>{if(f.current&&N.includes(f.current)){const E=N.indexOf(f.current);N.splice(E,1)}}},[g]),C.useLayoutEffect(()=>{var E;if(!n||!r.current)return;const N=k.current[0];f.current?(f.current.parent=y.current,f.current.children=k.current,f.current.node=n,f.current.getPos=e,f.current.outerDeco=o,f.current.innerDeco=i,f.current.dom=(t==null?void 0:t.current)??r.current,f.current.dom.pmViewDesc=f.current,f.current.contentDOM=(l==null?void 0:l.current)??f.current.contentDOM??(N==null?void 0:N.dom.parentElement)??null,f.current.nodeDOM=r.current):f.current=new Gp(y.current,k.current,e,n,o,i,(t==null?void 0:t.current)??r.current,(N==null?void 0:N.dom.parentElement)??null,r.current,v=>!!d.current(v),()=>p.current(),()=>m.current()),c(f.current.contentDOM!==null),g.current.includes(f.current)||g.current.push(f.current),g.current.sort(ni);for(const v of k.current)if(v.parent=f.current,v instanceof Pu){const D=(E=f.current.contentDOM)==null?void 0:E.firstChild;if(!D)throw new Error("Started a composition but couldn't find the text node it belongs to.");let T=D;for(;T.firstChild;)T=T.firstChild;if(!T||!(T instanceof Text))throw new Error("Started a composition but couldn't find the text node it belongs to.");v.dom=D,v.textDOM=T,v.text=T.data,v.textDOM.pmViewDesc=v,a==null||a.input.compositionNodes.push(v)}return()=>{var v,D,T,I;((v=f.current)==null?void 0:v.children[0])instanceof Pu&&!(a!=null&&a.composing)&&((I=(D=f.current)==null?void 0:D.children[0].dom.parentNode)==null||I.removeChild((T=f.current)==null?void 0:T.children[0].dom))}}),{hasContentDOM:u,childDescriptors:k,nodeViewDescRef:f,setStopEvent:h,setSelectNode:S}}function EA(n,e){return n.type.side-e.type.side}function MA(n,e,t,r){const i=e.locals(n);let o=0;if(i.length==0){for(let u=0;u<n.childCount;u++){const c=n.child(u);r(c,i,e.forChild(o,c),o,u),o+=c.nodeSize}return}let s=0;const l=[];let a=null;for(let u=0;;){if(s<i.length&&i[s].to==o){const p=i[s++];let m;for(;s<i.length&&i[s].to==o;)(m||(m=[p])).push(i[s++]);if(m){m.sort(EA);for(let S=0;S<m.length;S++)t(m[S],!(m[S].type instanceof al),o,u+S,!!a)}else t(p,!(p.type instanceof al),o,u,!!a)}let c,f;if(a)f=-1,c=a,a=null;else if(u<n.childCount)f=u,c=n.child(u++);else break;for(let p=0;p<l.length;p++)l[p].to<=o&&l.splice(p--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let d=o+c.nodeSize;if(c.isText){let p=d;s<i.length&&i[s].from<p&&(p=i[s].from);for(let m=0;m<l.length;m++)l[m].to<p&&(p=l[m].to);p<d&&(a=c.cut(p-o),c=c.cut(0,p-o),d=p,f=-1)}const h=c.isInline&&!c.isLeaf?l.filter(p=>!p.inline):l.slice();r(c,h,e.forChild(o,c),o,f),o=d}}function OA(){const{view:n}=C.useContext(ti);return n&&ul.getState(n.state)}var vC={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var r=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var s=typeof o;if(s==="string"||s==="number")r.push(o);else if(Array.isArray(o)){if(o.length){var l=t.apply(null,o);l&&r.push(l)}}else if(s==="object"){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var a in o)e.call(o,a)&&o[a]&&r.push(a)}}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(vC);var DA=vC.exports;const TA=bC(DA);function bA(n){return n.replaceAll(/-[a-z]/g,e=>{var t;return((t=e[1])==null?void 0:t.toUpperCase())??""})}function RA(n){const e=new CSSStyleSheet;e.insertRule(`* { ${n} }`);const r=e.cssRules[0].style,i={};for(let o=0;o<r.length;o++){const s=r.item(o),l=r.getPropertyValue(s),a=s.startsWith("--")?s:bA(s);i[a]=l}return i}function EC(n,e){return{...n,...e,className:TA(n.className,e.className),style:{...n.style,...e.style}}}function MC(n){const e={};for(const[t,r]of Object.entries(n))switch(t.toLowerCase()){case"class":{e.className=r;break}case"style":{e.style=RA(r);break}case"autocapitalize":{e.autoCapitalize=r;break}case"contenteditable":{if(r===""||r==="true"){e.contentEditable=!0;break}if(r==="false"){e.contentEditable=!1;break}if(r==="plaintext-only"){e.contentEditable="plaintext-only";break}e.contentEditable=null;break}case"draggable":{e.draggable=r!=null;break}case"enterkeyhint":{e.enterKeyHint=r;break}case"for":{e.htmlFor=r;break}case"hidden":{e.hidden=r;break}case"inputmode":{e.inputMode=r;break}case"itemprop":{e.itemProp=r;break}case"spellcheck":{if(r===""||r==="true"){e.spellCheck=!0;break}if(r==="false"){e.spellCheck=!1;break}e.spellCheck=null;break}case"tabindex":{const i=parseInt(r,10);Number.isNaN(i)||(e.tabIndex=i);break}case"autocomplete":{e.autoComplete=r;break}case"autofocus":{e.autoFocus=r!=null;break}case"formaction":{e.formAction=r;break}case"formenctype":{e.formEnctype=r;break}case"formmethod":{e.formMethod=r;break}case"formnovalidate":{e.formNoValidate=r;break}case"formtarget":{e.formTarget=r;break}case"maxlength":{const i=parseInt(r,10);Number.isNaN(i)||(e.maxLength=r);break}case"minlength":{const i=parseInt(r,10);Number.isNaN(i)||(e.minLength=r);break}case"max":{const i=parseInt(r,10);Number.isNaN(i)||(e.max=r);break}case"min":{const i=parseInt(r,10);Number.isNaN(i)||(e.min=r);break}case"multiple":{e.multiple=r!=null;break}case"readonly":{e.readOnly=r!=null;break}case"required":{e.required=r!=null;break}case"size":{const i=parseInt(r,10);Number.isNaN(i)||(e.size=r);break}case"step":{if(r==="any"){e.step=r;break}const i=parseInt(r,10);!Number.isNaN(i)&&i>0&&(e.step=r);break}case"disabled":{e.disabled=r!=null;break}case"rows":{const i=parseInt(r,10);Number.isNaN(i)||(e.rows=r);break}default:{e[t]=r;break}}return e}const Yp=C.memo(C.forwardRef(function({outputSpec:e,children:t,...r},i){if(typeof e=="string")return b.jsx(b.Fragment,{children:e});if(!Array.isArray(e))throw new Error("@nytimes/react-prosemirror only supports strings and arrays in toDOM");const s=e[0].replace(" ",":"),l=e[1];let a={ref:i,...r},u=1;l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)&&(u=2,a=EC(MC(l),a));const c=[];for(let f=u;f<e.length;f++){const d=e[f];if(d===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return C.createElement(s,a,t)}c.push(b.jsx(Yp,{outputSpec:d,children:t}))}return C.createElement(s,a,...c)})),OC=C.memo(C.forwardRef(function({mark:e,getPos:t,children:r},i){const{siblingsRef:o,parentRef:s}=C.useContext(Et),l=C.useRef(void 0),a=C.useRef([]),u=C.useRef(null);C.useImperativeHandle(i,()=>u.current,[]);const c=C.useMemo(()=>{var d,h;return(h=(d=e.type.spec).toDOM)==null?void 0:h.call(d,e,!0)},[e]);if(!c)throw new Error(`Mark spec for ${e.type.name} is missing toDOM`);C.useLayoutEffect(()=>{const d=o.current;return()=>{if(l.current&&d.includes(l.current)){const h=d.indexOf(l.current);d.splice(h,1)}}},[o]),C.useLayoutEffect(()=>{if(!u.current)return;const d=a.current[0];l.current?(l.current.parent=s.current,l.current.spec.dom=l.current.dom=u.current,l.current.children=a.current,l.current.spec.contentDOM=l.current.contentDOM=(d==null?void 0:d.dom.parentElement)??u.current,l.current.mark=e,l.current.getPos=()=>t.current()):l.current=new hA(s.current,a.current,()=>t.current(),e,u.current,(d==null?void 0:d.dom.parentElement)??u.current,{dom:u.current,contentDOM:(d==null?void 0:d.dom.parentElement)??u.current}),o.current.includes(l.current)||o.current.push(l.current),o.current.sort(ni);for(const h of a.current)h.parent=l.current});const f=C.useMemo(()=>({parentRef:l,siblingsRef:a}),[a,l]);return b.jsx(Yp,{ref:u,outputSpec:c,children:b.jsx(Et.Provider,{value:f,children:r})})}));function AA({widget:n,getPos:e}){const{siblingsRef:t,parentRef:r}=C.useContext(Et),i=C.useRef(null),o=C.useRef(null);return C.useLayoutEffect(()=>{const s=t.current;return()=>{if(i.current&&s.includes(i.current)){const l=s.indexOf(i.current);s.splice(l,1)}}},[t]),dC(s=>{if(!o.current)return;const l=n.type.toDOM;let a=typeof l=="function"?l(s,()=>e.current()):l;if(!n.type.spec.raw){if(a.nodeType!=1){const u=document.createElement("span");u.appendChild(a),a=u}a.contentEditable="false",a.classList.add("ProseMirror-widget")}o.current.firstElementChild!==a&&o.current.replaceChildren(a)}),C.useLayoutEffect(()=>{o.current&&(i.current?(i.current.parent=r.current,i.current.widget=n,i.current.getPos=()=>e.current(),i.current.dom=o.current):i.current=new Qp(r.current,()=>e.current(),n,o.current),t.current.includes(i.current)||t.current.push(i.current),t.current.sort(ni))}),b.jsx("span",{ref:o})}const $A=C.createContext(null),IA=C.createContext(null);function zA(){const[n,e]=C.useState(!1);return C.useEffect(()=>{e(!0)},[]),n}function PA({contentDomRef:n,customNodeViewRef:e,customNodeViewRootRef:t,customNodeView:r,initialNode:i,node:o,getPos:s,initialOuterDeco:l,initialInnerDeco:a,innerDeco:u}){const{view:c}=C.useContext(ti);if(!zA())return null;e.current||(e.current=r(i.current,c,()=>s.current(),l.current,a.current));const{contentDOM:d}=e.current;return n.current=d??null,C.createElement(o.isInline?"span":"div",{ref:t,contentEditable:!!d,suppressContentEditableWarning:!0},d&&lo.createPortal(b.jsx(dl,{getPos:s,node:o,innerDecorations:u}),d))}const DC=C.memo(function({outerDeco:e,getPos:t,node:r,innerDeco:i,...o}){const s=C.useRef(null),l=C.useRef(null),a=C.useRef(null),u=C.useRef(()=>t.current()).current,c=C.useRef(r),f=C.useRef(e),d=C.useRef(i),h=C.useRef(null),p=C.useRef(null),{nodeViews:m}=C.useContext(aC),{view:S}=C.useContext(ti);let g=null;const y=m[r.type.name],k=C.useMemo(()=>{var de,nt;return(nt=(de=r.type.spec).toDOM)==null?void 0:nt.call(de,r)},[r]),N=S==null?void 0:S.someProp("nodeViews",de=>de==null?void 0:de[r.type.name]);C.useLayoutEffect(()=>{if(!p.current||!h.current)return;const{dom:de}=p.current;return l.current=h.current,h.current.appendChild(de),()=>{var nt,ar;(ar=(nt=p.current)==null?void 0:nt.destroy)==null||ar.call(nt)}},[]),C.useLayoutEffect(()=>{if(!N||!p.current)return;const{destroy:de,update:nt}=p.current;if(((nt==null?void 0:nt.call(p.current,r,e,i))??!0)||(de==null||de.call(p.current),!h.current))return;c.current=r,f.current=e,d.current=i,p.current=N(c.current,S,()=>t.current(),f.current,d.current);const{dom:mo}=p.current;l.current=h.current,h.current.appendChild(mo)},[N,S,i,r,e,t]);const{hasContentDOM:E,childDescriptors:v,setStopEvent:D,setSelectNode:T,nodeViewDescRef:I}=NC(r,()=>t.current(),s,l,i,e,void 0,a),P={...o,...!E&&{contentEditable:!1}},le=C.useMemo(()=>({node:r,getPos:u,decorations:e,innerDecorations:i}),[u,i,r,e]);if(y?g=b.jsx(y,{...P,ref:l,nodeProps:le,children:b.jsx(dl,{getPos:t,node:r,innerDecorations:i})}):N?g=b.jsx(PA,{contentDomRef:a,customNodeView:N,customNodeViewRef:p,customNodeViewRootRef:h,initialInnerDeco:d,initialNode:c,initialOuterDeco:f,node:r,getPos:t,innerDeco:i}):k&&(g=b.jsx(Yp,{...P,ref:l,outputSpec:k,children:b.jsx(dl,{getPos:t,node:r,innerDecorations:i})})),!g)throw new Error(`Node spec for ${r.type.name} is missing toDOM`);const Zt=C.cloneElement(e.reduce(Xp,g),e.some(de=>de.type.attrs.nodeName)?{ref:s}:void 0),lr=C.useMemo(()=>({parentRef:I,siblingsRef:v}),[v,I]);return b.jsx($A.Provider,{value:T,children:b.jsx(IA.Provider,{value:D,children:b.jsx(Et.Provider,{value:lr,children:Zt})})})});function FA({getPos:n}){const{siblingsRef:e,parentRef:t}=C.useContext(Et),r=C.useRef(null),i=C.useRef(null),[o,s]=C.useState(!1);return C.useLayoutEffect(()=>{const l=e.current;return()=>{if(r.current&&l.includes(r.current)){const a=l.indexOf(r.current);l.splice(a,1)}}},[e]),C.useLayoutEffect(()=>{var a;const l=e.current[e.current.length-1];if((ve.safari||ve.chrome)&&((a=l==null?void 0:l.dom)==null?void 0:a.contentEditable)=="false"){s(!0);return}i.current&&(r.current?(r.current.parent=t.current,r.current.dom=i.current,r.current.getPos=()=>n.current()):r.current=new fl(t.current,[],()=>n.current(),i.current,null),e.current.includes(r.current)||e.current.push(r.current),e.current.sort(ni))}),o?b.jsx("img",{ref:i,className:"ProseMirror-separator"}):null}function LA(n,e){if(n===e)return!0;if(!n||!e)return!1;const t=Object.keys(n),r=Object.keys(e),i=t.length;if(r.length!==i)return!1;for(let o=0;o<i;o++){const s=t[o];if(n[s]!==e[s]||!Object.prototype.hasOwnProperty.call(e,s))return!1}return!0}class VA extends C.Component{constructor(){super(...arguments),this.viewDescRef=null,this.renderRef=null}updateEffect(){const{view:e,decorations:t,siblingsRef:r,parentRef:i,getPos:o,node:s}=this.props,l=lo.findDOMNode(this);if(!l){if(!(e!=null&&e.composing))return;this.viewDescRef=new Pu(i.current,()=>o.current(),document.createElement("div"),document.createTextNode(s.text??""),s.text??"");return}let a=l;for(;a.firstChild;)a=a.firstChild;!this.viewDescRef||this.viewDescRef instanceof Pu?this.viewDescRef=new pA(void 0,[],()=>o.current(),s,t,_.empty,l,a):(this.viewDescRef.parent=i.current,this.viewDescRef.children=[],this.viewDescRef.node=s,this.viewDescRef.getPos=()=>o.current(),this.viewDescRef.outerDeco=t,this.viewDescRef.innerDeco=_.empty,this.viewDescRef.dom=l,this.viewDescRef.dom.pmViewDesc=this.viewDescRef,this.viewDescRef.nodeDOM=a),r.current.includes(this.viewDescRef)||r.current.push(this.viewDescRef),r.current.sort(ni)}shouldComponentUpdate(e){return!LA(this.props,e)}componentDidMount(){this.updateEffect()}componentDidUpdate(){this.updateEffect()}componentWillUnmount(){const{siblingsRef:e}=this.props;if(this.viewDescRef&&e.current.includes(this.viewDescRef)){const t=e.current.indexOf(this.viewDescRef);e.current.splice(t,1)}}render(){const{view:e,getPos:t,node:r,decorations:i}=this.props;return e!=null&&e.composing&&e.state.selection.from>=t.current()&&e.state.selection.from<=t.current()+r.nodeSize?this.renderRef:(this.renderRef=i.reduce(Xp,r.text),this.renderRef)}}function BA({getPos:n}){const{siblingsRef:e,parentRef:t}=C.useContext(Et),r=C.useRef(null),i=C.useRef(null);return C.useLayoutEffect(()=>{const o=e.current;return()=>{if(r.current&&o.includes(r.current)){const s=o.indexOf(r.current);o.splice(s,1)}}},[e]),C.useLayoutEffect(()=>{i.current&&(r.current?(r.current.parent=t.current,r.current.dom=i.current,r.current.getPos=()=>n.current()):r.current=new fl(t.current,[],()=>n.current(),i.current,null),e.current.includes(r.current)||e.current.push(r.current),e.current.sort(ni))}),b.jsx("br",{ref:i,className:"ProseMirror-trailingBreak"})}function JA({widget:n,getPos:e}){const{siblingsRef:t,parentRef:r}=C.useContext(Et),i=C.useRef(null),o=C.useRef(()=>e.current()).current,s=C.useRef(null);C.useLayoutEffect(()=>{const a=t.current;return()=>{if(i.current&&a.includes(i.current)){const u=a.indexOf(i.current);a.splice(u,1)}}},[t]),C.useLayoutEffect(()=>{s.current&&(i.current?(i.current.parent=r.current,i.current.widget=n,i.current.getPos=()=>e.current(),i.current.dom=s.current):i.current=new Qp(r.current,()=>e.current(),n,s.current),t.current.includes(i.current)||t.current.push(i.current),t.current.sort(ni))});const{Component:l}=n.type;return l&&b.jsx(l,{ref:s,widget:n,getPos:o,contentEditable:!1})}function Xp(n,e){const{nodeName:t,...r}=e.type.attrs,i=MC(r);return t||typeof n=="string"?C.createElement(t??"span",i,n):C.cloneElement(n,EC(n.props,i))}function gf(n,e){var t,r,i;return n.type===e.type&&n.marks.every(o=>o.isInSet(e.marks))&&e.marks.every(o=>o.isInSet(n.marks))&&n.key===e.key&&(n.type==="node"?((t=n.outerDeco)==null?void 0:t.length)===((r=e.outerDeco)==null?void 0:r.length)&&((i=n.outerDeco)==null?void 0:i.every(o=>{var s;return(s=e.outerDeco)==null?void 0:s.some(l=>o.from===l.from&&o.to&&l.to&&o.type.eq(l.type))}))&&n.innerDeco.eq(e.innerDeco):!0)&&n.node===e.node&&n.widget===e.widget}const WA=C.memo(function({child:e,getInnerPos:t}){const{view:r}=C.useContext(ti),i=C.useRef(()=>t.current()+e.offset);return i.current=()=>t.current()+e.offset,e.type==="widget"?b.jsx(JA,{widget:e.widget,getPos:i},e.key):e.type==="native-widget"?b.jsx(AA,{widget:e.widget,getPos:i},e.key):e.node.isText?b.jsx(Et.Consumer,{children:({siblingsRef:o,parentRef:s})=>b.jsx(VA,{view:r,node:e.node,getPos:i,siblingsRef:o,parentRef:s,decorations:e.outerDeco})},e.key):b.jsx(DC,{node:e.node,getPos:i,outerDeco:e.outerDeco,innerDeco:e.innerDeco},e.key)}),KA=C.memo(function({childViews:e,getInnerPos:t}){const r=e[0],i=C.useRef(()=>t.current()+r.offset);i.current=()=>t.current()+r.offset;const o=r.marks[0];return o?b.jsx(OC,{getPos:i,mark:o,children:b.jsx(Zp,{getInnerPos:t,childViews:e.map(s=>({...s,marks:s.marks.slice(1)}))},r.key)},r.key):b.jsx(b.Fragment,{children:e.map(s=>b.jsx(WA,{child:s,getInnerPos:t},s.key))})}),Zp=C.memo(function({getInnerPos:e,childViews:t}){const r=t.reduce((i,o)=>{var a;const s=i[i.length-1];if(!s)return[[o]];const l=s[s.length-1];return l?!o.marks.length&&!l.marks.length||o.marks.length&&l.marks.length&&((a=o.marks[0])!=null&&a.eq(l.marks[0]))?[...i.slice(0,i.length-1),[...s.slice(0,s.length),o]]:[...i,[o]]:[...i.slice(0,i.length),[o]]},[]);return b.jsx(b.Fragment,{children:r.map(i=>{const o=i[0];return o?b.jsx(KA,{childViews:i,getInnerPos:e},o.key):null})})});function yf(n,e,t,r,i,o){const s=n+e,l=r==null?void 0:r.get(s);if(t==="widget"||t==="native-widget")return i.type.spec.key?i.type.spec.key:(console.warn(`Widget at position ${s} doesn't have a key specified. This may cause issues.`),`${l}-${o}`);if(l)return l;const a=n-1,u=r==null?void 0:r.get(a);return u?`${u}-${e}`:s}function _A(n,e){if(!e||e.widget.type.side>=0||!n||!n.node.isInline)return;const t=n.marks;e.marks=e.marks.reduce((r,i)=>i.addToSet(r),t)}function HA(n,e){if(!e.node.isInline)return;const t=e.marks;for(let r=n.length-1;r>=0;r--){const i=n[r];i.widget.type.side<0||(i.marks=i.marks.reduce((o,s)=>s.addToSet(o),t))}}const UA=C.memo(function({child:e,getInnerPos:t}){const r=C.useRef(()=>t.current()+e.offset);return r.current=()=>t.current()+e.offset,e.type==="node"?e.marks.reduce((i,o)=>b.jsx(OC,{getPos:r,mark:o,children:i}),b.jsx(DC,{outerDeco:e.outerDeco,node:e.node,innerDeco:e.innerDeco,getPos:r},e.key)):b.jsx(Zp,{childViews:[e],getInnerPos:t},e.key)});function qA(n,e){return n.length?n.every(t=>t.type!=="node"||t.node.isInline)?[b.jsx(Zp,{childViews:n,getInnerPos:e},n[0].key)]:n.map(t=>b.jsx(UA,{child:t,getInnerPos:e},t.key)):[]}const dl=C.memo(function({getPos:e,node:t,innerDecorations:r}){const i=OA(),o=C.useRef(()=>e.current()+1),s=C.useRef(new Map).current;if(!t)return null;const l=new Set;let a=[],u=null;MA(t,r,(h,p,m,S)=>{const g=h.type.spec.marks??[];let y;if(p){y=yf(o.current(),m,"native-widget",i==null?void 0:i.posToKey,h,S);const N={type:"native-widget",widget:h,marks:g,offset:m,index:S,key:y},E=s.get(y);E&&gf(E,N)?E.offset=m:s.set(y,N),l.add(y)}else{y=yf(o.current(),m,"widget",i==null?void 0:i.posToKey,h,S);const N={type:"widget",widget:h,marks:g,offset:m,index:S,key:y},E=s.get(y);E&&gf(E,N)?E.offset=m:s.set(y,N),l.add(y)}const k=s.get(y);a.push(k),_A(u,s.get(y))},(h,p,m,S)=>{const g=yf(o.current(),S,"node",i==null?void 0:i.posToKey),y={type:"node",node:h,marks:h.marks,innerDeco:m,outerDeco:p,offset:S,key:g},k=s.get(g);k&&gf(k,y)?(k.offset=S,u=k):(s.set(g,y),u=y),l.add(g),HA(a,u),a=[]});for(const h of s.keys())l.has(h)||s.delete(h);const c=Array.from(s.values()).sort((h,p)=>h.offset-p.offset),f=qA(c,o),d=c[c.length-1];return(!d||d.type!=="node"||d.node.isInline&&!d.node.isText||/\n$/.test(d.node.text))&&f.push(b.jsx(FA,{getPos:o},"trailing-hack-img"),b.jsx(BA,{getPos:o},"trailing-hack-br")),b.jsx(b.Fragment,{children:f})}),Sf={current(){return-1}},jA=C.memo(C.forwardRef(function({className:e,node:t,innerDeco:r,outerDeco:i,as:o,viewDesc:s,...l},a){const u=C.useRef(null);C.useImperativeHandle(a,()=>u.current,[]);const{childDescriptors:c,nodeViewDescRef:f}=NC(t,()=>Sf.current(),u,u,r,i,s),d=C.useMemo(()=>({parentRef:f,siblingsRef:c}),[c,f]),h={...l,ref:u,className:e,suppressContentEditableWarning:!0},p=o?C.cloneElement(o,h,b.jsx(Et.Provider,{value:d,children:b.jsx(dl,{getPos:Sf,node:t,innerDecorations:r})})):C.createElement("div",h,b.jsx(Et.Provider,{value:d,children:b.jsx(dl,{getPos:Sf,node:t,innerDecorations:r})}));if(!t)return p;const m=i.filter(g=>!g.inline);return m.length?m.reduce(Xp,p):p})),TC=C.createContext(null);function QA({as:n,...e},t){const r=C.useRef([]),i=C.useRef(null),{setMount:o,...s}=C.useContext(TC),l=C.useRef(void 0);C.useImperativeHandle(t,()=>i.current,[]);const a=C.useMemo(()=>({parentRef:l,siblingsRef:r}),[r,l]);return b.jsx(Et.Provider,{value:a,children:b.jsx(jA,{ref:u=>{i.current=u,o(u)},...e,...s,as:n})})}const GA=C.forwardRef(QA),YA=[];function XA({className:n,children:e,nodeViews:t,customNodeViews:r,...i}){var h;const[o,s]=C.useState(null),{editor:l,state:a}=NA(o,{...i,nodeViews:r}),u=l.view?FR(l.view,l.cursorWrapper):_.empty,c=l.view?$R(l.view):YA,f=C.useMemo(()=>({nodeViews:t??{}}),[t]),d=C.useMemo(()=>{var p;return{className:n,setMount:s,node:(p=l.view)==null?void 0:p.state.doc,innerDeco:u,outerDeco:c,viewDesc:l.docViewDescRef.current}},[n,l.docViewDescRef,(h=l.view)==null?void 0:h.state.doc,u,c]);return b.jsx(ti.Provider,{value:l,children:b.jsx(AR.Provider,{value:a,children:b.jsx(aC.Provider,{value:f,children:b.jsx(TC.Provider,{value:d,children:e})})})})}function ZA(n){return b.jsx(vA,{children:b.jsx(XA,{...n})})}const J=new q0({nodes:{doc:{content:"block+"},paragraph:{group:"block",content:"inline*",toDOM(){return["p",0]}},...pO({cellContent:"inline*",cellAttributes:{},tableGroup:"block"}),footnote:{group:"inline",content:"text*",inline:!0,atom:!0,attrs:{number:{default:0}}},list:{group:"block",content:"list_item+",toDOM(){return["ul",0]}},list_item:{content:"paragraph+",toDOM(){return["li",0]}},image:{group:"block",toDOM(){return["div",["img",{src:"https://smoores.gitlab.io/storyteller/img/Storyteller_Logo.png",height:150,width:150}]]}},text:{group:"inline"}},marks:{em:{toDOM(){return["em",0]}},strong:{toDOM(){return["strong",0]}}}}),e2=An.create({schema:J,doc:J.nodes.doc.create({},[J.nodes.paragraph.create({},[J.text("This ",[J.marks.em.create()]),J.text("is",[J.marks.em.create(),J.marks.strong.create()]),J.text(" the first paragraph")]),J.nodes.paragraph.create({},[J.text("This is the second paragraph"),J.nodes.footnote.create({number:1},J.text("Footnote"))]),J.nodes.paragraph.create(),J.nodes.image.create(),J.nodes.image.create(),J.nodes.paragraph.create({},J.text("This is the third paragraph 🫵")),J.nodes.table.create({},[J.nodes.table_row.create({},[J.nodes.table_header.create({},J.text("h1")),J.nodes.table_header.create({},J.text("h2"))]),J.nodes.table_row.create({},[J.nodes.table_cell.create({},J.text("c1")),J.nodes.table_cell.create({},J.text("c2"))])])]),plugins:[UR(),VE({rules:[BE(/^\s*([-+*])\s$/,J.nodes.list)]}),$O(),HO()]}),t2=C.forwardRef(function({children:e,nodeProps:t,...r},i){return b.jsx("p",{ref:i,...r,children:e})}),n2=C.forwardRef(function({children:e,nodeProps:t,...r},i){return b.jsx("ul",{ref:i,...r,children:e})}),r2=C.forwardRef(function({children:e,nodeProps:t,...r},i){return b.jsx("li",{ref:i,...r,children:e})}),i2=C.forwardRef(function({nodeProps:e,...t},r){return b.jsx("span",{ref:r,...t,suppressContentEditableWarning:!0,contentEditable:"false",children:b.jsx("button",{children:e.node.attrs.number})})}),o2=C.forwardRef(function({widget:e,getPos:t,...r},i){return b.jsx("span",{...r,ref:i,style:{display:"block",backgroundColor:"blue",width:"4px",height:"4px",position:"absolute",transform:"translateX(-2px)"},children:"Widget"})}),s2=new Xt({view(n){const e=n.coordsAtPos(n.state.selection.from),t=document.createElement("div");return t.style.width="4px",t.style.height="4px",t.style.position="absolute",t.style.top=`${e.top-2}px`,t.style.left=`${e.left-2}px`,t.style.backgroundColor="blue",document.body.appendChild(t),{update(r){const i=r.coordsAtPos(r.state.selection.from);t.style.top=`${i.top-2}px`,t.style.left=`${i.left-2}px`},destroy(){document.body.removeChild(t)}}}});new Xt({props:{decorations(n){return _.create(n.doc,[hC(n.selection.from,o2,{side:0,key:"widget-plugin-widget"})])}},view(n){const e=n.coordsAtPos(n.state.selection.from),t=document.createElement("div");return t.style.width="4px",t.style.height="4px",t.style.position="absolute",t.style.top=`${e.top-2}px`,t.style.left=`${e.left-2}px`,t.style.backgroundColor="blue",document.body.appendChild(t),{update(r){const i=r.coordsAtPos(r.state.selection.from);t.style.top=`${i.top-2}px`,t.style.left=`${i.left-2}px`},destroy(){document.body.removeChild(t)}}}});const l2=[_E({...kv,"Mod-i":Nm(J.marks.em),"Mod-b":Nm(J.marks.strong)}),s2,CE()],a2={paragraph:()=>{const n=document.createElement("p");return{dom:n,contentDOM:n}}};function u2(){const[n,e]=C.useState(e2),[t,r]=C.useState(!0),i=C.useMemo(()=>t?{paragraph:t2,list:n2,list_item:r2,footnote:i2}:void 0,[t]),o=C.useCallback(function(s){e(l=>l.apply(s))},[]);return b.jsxs("main",{children:[b.jsx("h1",{children:"React ProseMirror Demo"}),b.jsxs("button",{onClick:()=>{t?r(s=>!s):window.location.reload()},children:["Switch to"," ",t?"ProseMirror node views":"React node views (requires reload)"]}),b.jsx(ZA,{className:"ProseMirror",state:n,dispatchTransaction:o,plugins:l2,nodeViews:i,customNodeViews:t?void 0:a2,children:b.jsx(GA,{})},`${t}`)]})}const c2=lC(document.getElementById("root"));c2.render(b.jsx(C.StrictMode,{children:b.jsx(u2,{})}));
